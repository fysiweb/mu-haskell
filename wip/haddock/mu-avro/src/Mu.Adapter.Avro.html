<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd"><html xmlns="http://www.w3.org/1999/xhtml"><head><link rel="stylesheet" type="text/css" href="style.css" /><script type="text/javascript" src="highlight.js"></script></head><body><pre><span class="hs-pragma">{-# language ConstraintKinds       #-}</span><span>
</span><span id="line-2"></span><span class="hs-pragma">{-# language DataKinds             #-}</span><span>
</span><span id="line-3"></span><span class="hs-pragma">{-# language FlexibleContexts      #-}</span><span>
</span><span id="line-4"></span><span class="hs-pragma">{-# language FlexibleInstances     #-}</span><span>
</span><span id="line-5"></span><span class="hs-pragma">{-# language GADTs                 #-}</span><span>
</span><span id="line-6"></span><span class="hs-pragma">{-# language MultiParamTypeClasses #-}</span><span>
</span><span id="line-7"></span><span class="hs-pragma">{-# language PolyKinds             #-}</span><span>
</span><span id="line-8"></span><span class="hs-pragma">{-# language RankNTypes            #-}</span><span>
</span><span id="line-9"></span><span class="hs-pragma">{-# language ScopedTypeVariables   #-}</span><span>
</span><span id="line-10"></span><span class="hs-pragma">{-# language TypeApplications      #-}</span><span>
</span><span id="line-11"></span><span class="hs-pragma">{-# language TypeFamilies          #-}</span><span>
</span><span id="line-12"></span><span class="hs-pragma">{-# language TypeOperators         #-}</span><span>
</span><span id="line-13"></span><span class="hs-pragma">{-# language UndecidableInstances  #-}</span><span>
</span><span id="line-14"></span><span class="hs-pragma">{-#&#160;OPTIONS_GHC -fno-warn-orphans #-}</span><span>
</span><span id="line-15"></span><span class="hs-comment">{-|
Description : Adapter for Avro serialization

Just import the module and you can turn any
value with a 'ToSchema' and 'FromSchema' from
and to Avro values.
-}</span><span>
</span><span id="line-22"></span><span class="hs-keyword">module</span><span> </span><span class="hs-identifier">Mu.Adapter.Avro</span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-23"></span><span>
</span><span id="line-24"></span><span class="hs-keyword">import</span><span>           </span><span class="annot"><span class="hs-identifier">Control.Arrow</span></span><span>                       </span><span class="hs-special">(</span><span class="annot"><span class="hs-operator">(***)</span></span><span class="hs-special">)</span><span>
</span><span id="line-25"></span><span class="hs-keyword">import</span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="annot"><span class="hs-identifier">Data.Avro</span></span><span>                           </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">A</span></span><span>
</span><span id="line-26"></span><span class="hs-keyword">import</span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="annot"><span class="hs-identifier">Data.Avro.Encoding.FromAvro</span></span><span>         </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">AVal</span></span><span>
</span><span id="line-27"></span><span class="hs-keyword">import</span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="annot"><span class="hs-identifier">Data.Avro.Encoding.ToAvro</span></span><span>           </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">A</span></span><span>
</span><span id="line-28"></span><span class="hs-keyword">import</span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="annot"><span class="hs-identifier">Data.Avro.Schema.ReadSchema</span></span><span>         </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">RSch</span></span><span>
</span><span id="line-29"></span><span class="hs-keyword">import</span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="annot"><span class="hs-identifier">Data.Avro.Schema.Schema</span></span><span>             </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">ASch</span></span><span>
</span><span id="line-30"></span><span class="hs-comment">-- 'Tagged . unTagged' can be replaced by 'coerce'</span><span>
</span><span id="line-31"></span><span class="hs-comment">-- eliminating some run-time overhead</span><span>
</span><span id="line-32"></span><span class="hs-keyword">import</span><span>           </span><span class="annot"><span class="hs-identifier">Control.Monad.Trans.State</span></span><span>
</span><span id="line-33"></span><span class="hs-keyword">import</span><span>           </span><span class="annot"><span class="hs-identifier">Data.Avro.EitherN</span></span><span>                   </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">putIndexedValue</span></span><span class="hs-special">)</span><span>
</span><span id="line-34"></span><span class="hs-keyword">import</span><span>           </span><span class="annot"><span class="hs-identifier">Data.ByteString.Builder</span></span><span>             </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">Builder</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier">word8</span></span><span class="hs-special">)</span><span>
</span><span id="line-35"></span><span class="hs-keyword">import</span><span>           </span><span class="annot"><span class="hs-identifier">Data.Coerce</span></span><span>                         </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">coerce</span></span><span class="hs-special">)</span><span>
</span><span id="line-36"></span><span class="hs-keyword">import</span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="annot"><span class="hs-identifier">Data.HashMap.Strict</span></span><span>                 </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">HM</span></span><span>
</span><span id="line-37"></span><span class="hs-keyword">import</span><span>           </span><span class="annot"><span class="hs-identifier">Data.List.NonEmpty</span></span><span>                  </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">NonEmpty</span></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-38"></span><span class="hs-keyword">import</span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="annot"><span class="hs-identifier">Data.List.NonEmpty</span></span><span>                  </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">NonEmptyList</span></span><span>
</span><span id="line-39"></span><span class="hs-keyword">import</span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="annot"><span class="hs-identifier">Data.Map</span></span><span>                            </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">M</span></span><span>
</span><span id="line-40"></span><span class="hs-keyword">import</span><span>           </span><span class="annot"><span class="hs-identifier">Data.Maybe</span></span><span>                          </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">fromJust</span></span><span class="hs-special">)</span><span>
</span><span id="line-41"></span><span class="hs-keyword">import</span><span>           </span><span class="annot"><span class="hs-identifier">Data.Tagged</span></span><span>
</span><span id="line-42"></span><span class="hs-keyword">import</span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="annot"><span class="hs-identifier">Data.Text</span></span><span>                           </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">T</span></span><span>
</span><span id="line-43"></span><span class="hs-keyword">import</span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="annot"><span class="hs-identifier">Data.Vector</span></span><span>                         </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">V</span></span><span>
</span><span id="line-44"></span><span class="hs-keyword">import</span><span>           </span><span class="annot"><span class="hs-identifier">GHC.TypeLits</span></span><span>
</span><span id="line-45"></span><span>
</span><span id="line-46"></span><span class="hs-keyword">import</span><span>           </span><span class="annot"><span class="hs-identifier">Mu.Schema</span></span><span>
</span><span id="line-47"></span><span class="hs-keyword">import</span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="annot"><span class="hs-identifier">Mu.Schema.Interpretation.Schemaless</span></span><span> </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">SLess</span></span><span>
</span><span id="line-48"></span><span>
</span><span id="line-49"></span><span class="hs-keyword">instance</span><span> </span><span class="annot"><span class="hs-identifier hs-type">SLess.ToSchemalessTerm</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">AVal.Value</span></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-50"></span><span>  </span><span id="local-6989586621679163257"><span class="annot"><span class="annottext">toSchemalessTerm :: Value -&gt; Term
</span><span class="hs-identifier hs-var hs-var hs-var hs-var">toSchemalessTerm</span></span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">AVal.Record</span></span><span> </span><span id="local-6989586621679163254"><span class="annot"><span class="annottext">s :: ReadSchema
</span><a href="#local-6989586621679163254"><span class="hs-identifier hs-var">s</span></a></span></span><span> </span><span id="local-6989586621679163253"><span class="annot"><span class="annottext">r :: Vector Value
</span><a href="#local-6989586621679163253"><span class="hs-identifier hs-var">r</span></a></span></span><span class="hs-special">)</span><span>
</span><span id="line-51"></span><span>    </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">ReadSchema
</span><a href="#local-6989586621679163254"><span class="hs-identifier hs-var">s</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-52"></span><span>        </span><span class="annot"><span class="hs-identifier hs-type">RSch.Record</span></span><span> </span><span class="hs-special">{</span><span>&#160;</span><span class="annot"><span class="annottext">fields :: ReadSchema -&gt; [ReadField]
</span><span class="hs-identifier hs-var">RSch.fields</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span id="local-6989586621679163250"><span class="annot"><span class="annottext">[ReadField]
</span><a href="#local-6989586621679163250"><span class="hs-identifier hs-var">fs</span></a></span></span><span> </span><span class="hs-special">}</span><span>
</span><span id="line-53"></span><span>          </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">[Field] -&gt; Term
</span><span class="hs-identifier hs-var">SLess.TRecord</span></span><span> </span><span class="annot"><span class="annottext">([Field] -&gt; Term) -&gt; [Field] -&gt; Term
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span>
</span><span id="line-54"></span><span>               </span><span class="annot"><span class="annottext">(Text -&gt; Value -&gt; Field) -&gt; [Text] -&gt; [Value] -&gt; [Field]
forall a b c. (a -&gt; b -&gt; c) -&gt; [a] -&gt; [b] -&gt; [c]
</span><span class="hs-identifier hs-var">zipWith</span></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span id="local-6989586621679163247"><span class="annot"><span class="annottext">k :: Text
</span><a href="#local-6989586621679163247"><span class="hs-identifier hs-var">k</span></a></span></span><span> </span><span id="local-6989586621679163246"><span class="annot"><span class="annottext">v :: Value
</span><a href="#local-6989586621679163246"><span class="hs-identifier hs-var">v</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Text -&gt; FieldValue -&gt; Field
</span><span class="hs-identifier hs-var">SLess.Field</span></span><span> </span><span class="annot"><span class="annottext">Text
</span><a href="#local-6989586621679163247"><span class="hs-identifier hs-var">k</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Value -&gt; FieldValue
forall t. ToSchemalessValue t =&gt; t -&gt; FieldValue
</span><span class="hs-identifier hs-var">SLess.toSchemalessValue</span></span><span> </span><span class="annot"><span class="annottext">Value
</span><a href="#local-6989586621679163246"><span class="hs-identifier hs-var">v</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-55"></span><span>                       </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(ReadField -&gt; Text) -&gt; [ReadField] -&gt; [Text]
forall a b. (a -&gt; b) -&gt; [a] -&gt; [b]
</span><span class="hs-identifier hs-var">map</span></span><span> </span><span class="annot"><span class="annottext">ReadField -&gt; Text
</span><span class="hs-identifier hs-var hs-var">RSch.fldName</span></span><span> </span><span class="annot"><span class="annottext">[ReadField]
</span><a href="#local-6989586621679163250"><span class="hs-identifier hs-var">fs</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Vector Value -&gt; [Value]
forall a. Vector a -&gt; [a]
</span><span class="hs-identifier hs-var">V.toList</span></span><span> </span><span class="annot"><span class="annottext">Vector Value
</span><a href="#local-6989586621679163253"><span class="hs-identifier hs-var">r</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-56"></span><span>        </span><span class="hs-identifier">_</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">[Char] -&gt; Term
forall a. HasCallStack =&gt; [Char] -&gt; a
</span><span class="hs-identifier hs-var">error</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-string">&quot;this should never happen:\n&quot;</span></span><span> </span><span class="annot"><span class="annottext">[Char] -&gt; [Char] -&gt; [Char]
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="annot"><span class="annottext">ReadSchema -&gt; [Char]
forall a. Show a =&gt; a -&gt; [Char]
</span><span class="hs-identifier hs-var">show</span></span><span> </span><span class="annot"><span class="annottext">ReadSchema
</span><a href="#local-6989586621679163254"><span class="hs-identifier hs-var">s</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-57"></span><span>  </span><span class="annot"><span class="hs-identifier hs-var">toSchemalessTerm</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">AVal.Enum</span></span><span> </span><span class="hs-identifier">_</span><span> </span><span id="local-6989586621679163238"><span class="annot"><span class="annottext">i :: Int
</span><a href="#local-6989586621679163238"><span class="hs-identifier hs-var">i</span></a></span></span><span> </span><span class="hs-identifier">_</span><span class="hs-special">)</span><span>
</span><span id="line-58"></span><span>    </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Int -&gt; Term
</span><span class="hs-identifier hs-var">SLess.TEnum</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679163238"><span class="hs-identifier hs-var">i</span></a></span><span>
</span><span id="line-59"></span><span>  </span><span class="annot"><span class="hs-identifier hs-var">toSchemalessTerm</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">AVal.Union</span></span><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-identifier">_</span><span> </span><span id="local-6989586621679163235"><span class="annot"><span class="annottext">v :: Value
</span><a href="#local-6989586621679163235"><span class="hs-identifier hs-var">v</span></a></span></span><span class="hs-special">)</span><span>
</span><span id="line-60"></span><span>    </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Value -&gt; Term
forall t. ToSchemalessTerm t =&gt; t -&gt; Term
</span><span class="hs-identifier hs-var">SLess.toSchemalessTerm</span></span><span> </span><span class="annot"><span class="annottext">Value
</span><a href="#local-6989586621679163235"><span class="hs-identifier hs-var">v</span></a></span><span>
</span><span id="line-61"></span><span>  </span><span class="annot"><span class="hs-identifier hs-var">toSchemalessTerm</span></span><span> </span><span id="local-6989586621679163234"><span class="annot"><span class="annottext">v :: Value
</span><a href="#local-6989586621679163234"><span class="hs-identifier hs-var">v</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">FieldValue -&gt; Term
</span><span class="hs-identifier hs-var">SLess.TSimple</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Value -&gt; FieldValue
forall t. ToSchemalessValue t =&gt; t -&gt; FieldValue
</span><span class="hs-identifier hs-var">SLess.toSchemalessValue</span></span><span> </span><span class="annot"><span class="annottext">Value
</span><a href="#local-6989586621679163234"><span class="hs-identifier hs-var">v</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-62"></span><span>
</span><span id="line-63"></span><span class="hs-keyword">instance</span><span> </span><span class="annot"><span class="hs-identifier hs-type">SLess.ToSchemalessValue</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">AVal.Value</span></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-64"></span><span>  </span><span id="local-6989586621679163230"><span class="annot"><span class="annottext">toSchemalessValue :: Value -&gt; FieldValue
</span><a href="#local-6989586621679163230"><span class="hs-identifier hs-var hs-var hs-var hs-var">toSchemalessValue</span></a></span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">AVal.Null</span></span><span>         </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">FieldValue
</span><span class="hs-identifier hs-var">SLess.FNull</span></span><span>
</span><span id="line-65"></span><span>  </span><span class="annot"><span class="hs-identifier hs-var">toSchemalessValue</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">AVal.Boolean</span></span><span>  </span><span id="local-6989586621679163226"><span class="annot"><span class="annottext">b :: Bool
</span><a href="#local-6989586621679163226"><span class="hs-identifier hs-var">b</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Bool -&gt; FieldValue
forall t. (Typeable t, Eq t, Ord t, Show t) =&gt; t -&gt; FieldValue
</span><span class="hs-identifier hs-var">SLess.FPrimitive</span></span><span> </span><span class="annot"><span class="annottext">Bool
</span><a href="#local-6989586621679163226"><span class="hs-identifier hs-var">b</span></a></span><span>
</span><span id="line-66"></span><span>  </span><span class="annot"><span class="hs-identifier hs-var">toSchemalessValue</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">AVal.Int</span></span><span>    </span><span class="hs-identifier">_</span><span> </span><span id="local-6989586621679163223"><span class="annot"><span class="annottext">b :: Int32
</span><a href="#local-6989586621679163223"><span class="hs-identifier hs-var">b</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Int32 -&gt; FieldValue
forall t. (Typeable t, Eq t, Ord t, Show t) =&gt; t -&gt; FieldValue
</span><span class="hs-identifier hs-var">SLess.FPrimitive</span></span><span> </span><span class="annot"><span class="annottext">Int32
</span><a href="#local-6989586621679163223"><span class="hs-identifier hs-var">b</span></a></span><span>
</span><span id="line-67"></span><span>  </span><span class="annot"><span class="hs-identifier hs-var">toSchemalessValue</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">AVal.Long</span></span><span>   </span><span class="hs-identifier">_</span><span> </span><span id="local-6989586621679163221"><span class="annot"><span class="annottext">b :: Int64
</span><a href="#local-6989586621679163221"><span class="hs-identifier hs-var">b</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Int64 -&gt; FieldValue
forall t. (Typeable t, Eq t, Ord t, Show t) =&gt; t -&gt; FieldValue
</span><span class="hs-identifier hs-var">SLess.FPrimitive</span></span><span> </span><span class="annot"><span class="annottext">Int64
</span><a href="#local-6989586621679163221"><span class="hs-identifier hs-var">b</span></a></span><span>
</span><span id="line-68"></span><span>  </span><span class="annot"><span class="hs-identifier hs-var">toSchemalessValue</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">AVal.Float</span></span><span>  </span><span class="hs-identifier">_</span><span> </span><span id="local-6989586621679163219"><span class="annot"><span class="annottext">b :: Float
</span><a href="#local-6989586621679163219"><span class="hs-identifier hs-var">b</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Float -&gt; FieldValue
forall t. (Typeable t, Eq t, Ord t, Show t) =&gt; t -&gt; FieldValue
</span><span class="hs-identifier hs-var">SLess.FPrimitive</span></span><span> </span><span class="annot"><span class="annottext">Float
</span><a href="#local-6989586621679163219"><span class="hs-identifier hs-var">b</span></a></span><span>
</span><span id="line-69"></span><span>  </span><span class="annot"><span class="hs-identifier hs-var">toSchemalessValue</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">AVal.Double</span></span><span> </span><span class="hs-identifier">_</span><span> </span><span id="local-6989586621679163217"><span class="annot"><span class="annottext">b :: Double
</span><a href="#local-6989586621679163217"><span class="hs-identifier hs-var">b</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Double -&gt; FieldValue
forall t. (Typeable t, Eq t, Ord t, Show t) =&gt; t -&gt; FieldValue
</span><span class="hs-identifier hs-var">SLess.FPrimitive</span></span><span> </span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679163217"><span class="hs-identifier hs-var">b</span></a></span><span>
</span><span id="line-70"></span><span>  </span><span class="annot"><span class="hs-identifier hs-var">toSchemalessValue</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">AVal.String</span></span><span> </span><span class="hs-identifier">_</span><span> </span><span id="local-6989586621679163215"><span class="annot"><span class="annottext">b :: Text
</span><a href="#local-6989586621679163215"><span class="hs-identifier hs-var">b</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Text -&gt; FieldValue
forall t. (Typeable t, Eq t, Ord t, Show t) =&gt; t -&gt; FieldValue
</span><span class="hs-identifier hs-var">SLess.FPrimitive</span></span><span> </span><span class="annot"><span class="annottext">Text
</span><a href="#local-6989586621679163215"><span class="hs-identifier hs-var">b</span></a></span><span>
</span><span id="line-71"></span><span>  </span><span class="annot"><span class="hs-identifier hs-var">toSchemalessValue</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">AVal.Fixed</span></span><span>  </span><span class="hs-identifier">_</span><span> </span><span id="local-6989586621679163213"><span class="annot"><span class="annottext">b :: ByteString
</span><a href="#local-6989586621679163213"><span class="hs-identifier hs-var">b</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">ByteString -&gt; FieldValue
forall t. (Typeable t, Eq t, Ord t, Show t) =&gt; t -&gt; FieldValue
</span><span class="hs-identifier hs-var">SLess.FPrimitive</span></span><span> </span><span class="annot"><span class="annottext">ByteString
</span><a href="#local-6989586621679163213"><span class="hs-identifier hs-var">b</span></a></span><span>
</span><span id="line-72"></span><span>  </span><span class="annot"><span class="hs-identifier hs-var">toSchemalessValue</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">AVal.Bytes</span></span><span>  </span><span class="hs-identifier">_</span><span> </span><span id="local-6989586621679163211"><span class="annot"><span class="annottext">b :: ByteString
</span><a href="#local-6989586621679163211"><span class="hs-identifier hs-var">b</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">ByteString -&gt; FieldValue
forall t. (Typeable t, Eq t, Ord t, Show t) =&gt; t -&gt; FieldValue
</span><span class="hs-identifier hs-var">SLess.FPrimitive</span></span><span> </span><span class="annot"><span class="annottext">ByteString
</span><a href="#local-6989586621679163211"><span class="hs-identifier hs-var">b</span></a></span><span>
</span><span id="line-73"></span><span>  </span><span class="annot"><span class="hs-identifier hs-var">toSchemalessValue</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">AVal.Array</span></span><span> </span><span id="local-6989586621679163209"><span class="annot"><span class="annottext">v :: Vector Value
</span><a href="#local-6989586621679163209"><span class="hs-identifier hs-var">v</span></a></span></span><span class="hs-special">)</span><span>
</span><span id="line-74"></span><span>    </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[FieldValue] -&gt; FieldValue
</span><span class="hs-identifier hs-var">SLess.FList</span></span><span> </span><span class="annot"><span class="annottext">([FieldValue] -&gt; FieldValue) -&gt; [FieldValue] -&gt; FieldValue
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">(Value -&gt; FieldValue) -&gt; [Value] -&gt; [FieldValue]
forall a b. (a -&gt; b) -&gt; [a] -&gt; [b]
</span><span class="hs-identifier hs-var">map</span></span><span> </span><span class="annot"><span class="annottext">Value -&gt; FieldValue
forall t. ToSchemalessValue t =&gt; t -&gt; FieldValue
</span><span class="hs-identifier hs-var">SLess.toSchemalessValue</span></span><span> </span><span class="annot"><span class="annottext">([Value] -&gt; [FieldValue]) -&gt; [Value] -&gt; [FieldValue]
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Vector Value -&gt; [Value]
forall a. Vector a -&gt; [a]
</span><span class="hs-identifier hs-var">V.toList</span></span><span> </span><span class="annot"><span class="annottext">Vector Value
</span><a href="#local-6989586621679163209"><span class="hs-identifier hs-var">v</span></a></span><span>
</span><span id="line-75"></span><span>  </span><span class="annot"><span class="hs-identifier hs-var">toSchemalessValue</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">AVal.Map</span></span><span> </span><span id="local-6989586621679163206"><span class="annot"><span class="annottext">hm :: HashMap Text Value
</span><a href="#local-6989586621679163206"><span class="hs-identifier hs-var">hm</span></a></span></span><span class="hs-special">)</span><span>
</span><span id="line-76"></span><span>    </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Map FieldValue FieldValue -&gt; FieldValue
</span><span class="hs-identifier hs-var">SLess.FMap</span></span><span> </span><span class="annot"><span class="annottext">(Map FieldValue FieldValue -&gt; FieldValue)
-&gt; Map FieldValue FieldValue -&gt; FieldValue
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">[(FieldValue, FieldValue)] -&gt; Map FieldValue FieldValue
forall k a. Ord k =&gt; [(k, a)] -&gt; Map k a
</span><span class="hs-identifier hs-var">M.fromList</span></span><span>
</span><span id="line-77"></span><span>                 </span><span class="annot"><span class="annottext">([(FieldValue, FieldValue)] -&gt; Map FieldValue FieldValue)
-&gt; [(FieldValue, FieldValue)] -&gt; Map FieldValue FieldValue
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">((Text, Value) -&gt; (FieldValue, FieldValue))
-&gt; [(Text, Value)] -&gt; [(FieldValue, FieldValue)]
forall a b. (a -&gt; b) -&gt; [a] -&gt; [b]
</span><span class="hs-identifier hs-var">map</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Text -&gt; FieldValue
forall t. (Typeable t, Eq t, Ord t, Show t) =&gt; t -&gt; FieldValue
</span><span class="hs-identifier hs-var">SLess.FPrimitive</span></span><span> </span><span class="annot"><span class="annottext">(Text -&gt; FieldValue)
-&gt; (Value -&gt; FieldValue)
-&gt; (Text, Value)
-&gt; (FieldValue, FieldValue)
forall (a :: * -&gt; * -&gt; *) b c b' c'.
Arrow a =&gt;
a b c -&gt; a b' c' -&gt; a (b, b') (c, c')
</span><span class="hs-operator hs-var">***</span></span><span> </span><span class="annot"><span class="annottext">Value -&gt; FieldValue
forall t. ToSchemalessValue t =&gt; t -&gt; FieldValue
</span><span class="hs-identifier hs-var">SLess.toSchemalessValue</span></span><span class="hs-special">)</span><span>
</span><span id="line-78"></span><span>                 </span><span class="annot"><span class="annottext">([(Text, Value)] -&gt; [(FieldValue, FieldValue)])
-&gt; [(Text, Value)] -&gt; [(FieldValue, FieldValue)]
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">HashMap Text Value -&gt; [(Text, Value)]
forall k v. HashMap k v -&gt; [(k, v)]
</span><span class="hs-identifier hs-var">HM.toList</span></span><span> </span><span class="annot"><span class="annottext">HashMap Text Value
</span><a href="#local-6989586621679163206"><span class="hs-identifier hs-var">hm</span></a></span><span>
</span><span id="line-79"></span><span>  </span><span class="annot"><span class="hs-identifier hs-var">toSchemalessValue</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">AVal.Union</span></span><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-identifier">_</span><span> </span><span id="local-6989586621679163202"><span class="annot"><span class="annottext">v :: Value
</span><a href="#local-6989586621679163202"><span class="hs-identifier hs-var">v</span></a></span></span><span class="hs-special">)</span><span>
</span><span id="line-80"></span><span>    </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Value -&gt; FieldValue
forall t. ToSchemalessValue t =&gt; t -&gt; FieldValue
</span><span class="hs-identifier hs-var">SLess.toSchemalessValue</span></span><span> </span><span class="annot"><span class="annottext">Value
</span><a href="#local-6989586621679163202"><span class="hs-identifier hs-var">v</span></a></span><span>
</span><span id="line-81"></span><span>  </span><span class="annot"><span class="hs-identifier hs-var">toSchemalessValue</span></span><span> </span><span id="local-6989586621679163201"><span class="annot"><span class="annottext">r :: Value
</span><a href="#local-6989586621679163201"><span class="hs-identifier hs-var">r</span></a></span></span><span class="hs-glyph">@</span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">AVal.Record</span></span><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-identifier">_</span><span class="hs-special">)</span><span>
</span><span id="line-82"></span><span>    </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Term -&gt; FieldValue
</span><span class="hs-identifier hs-var">SLess.FSchematic</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Value -&gt; Term
forall t. ToSchemalessTerm t =&gt; t -&gt; Term
</span><span class="hs-identifier hs-var">SLess.toSchemalessTerm</span></span><span> </span><span class="annot"><span class="annottext">Value
</span><a href="#local-6989586621679163201"><span class="hs-identifier hs-var">r</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-83"></span><span>  </span><span class="annot"><span class="hs-identifier hs-var">toSchemalessValue</span></span><span> </span><span id="local-6989586621679163199"><span class="annot"><span class="annottext">e :: Value
</span><a href="#local-6989586621679163199"><span class="hs-identifier hs-var">e</span></a></span></span><span class="hs-glyph">@</span><span class="annot"><span class="hs-identifier hs-type">AVal.Enum</span></span><span> </span><span class="hs-special">{</span><span class="hs-special">}</span><span>
</span><span id="line-84"></span><span>    </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Term -&gt; FieldValue
</span><span class="hs-identifier hs-var">SLess.FSchematic</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Value -&gt; Term
forall t. ToSchemalessTerm t =&gt; t -&gt; Term
</span><span class="hs-identifier hs-var">SLess.toSchemalessTerm</span></span><span> </span><span class="annot"><span class="annottext">Value
</span><a href="#local-6989586621679163199"><span class="hs-identifier hs-var">e</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-85"></span><span>
</span><span id="line-86"></span><span id="local-6989586621679163196"><span id="local-6989586621679163197"><span id="local-6989586621679163198"><span class="hs-keyword">instance</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Mu.Adapter.Avro.html#HasAvroSchema%27"><span class="hs-identifier hs-type">HasAvroSchema'</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Term</span></span><span> </span><span class="annot"><a href="#local-6989586621679163198"><span class="hs-identifier hs-type">sch</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679163198"><span class="hs-identifier hs-type">sch</span></a></span><span> </span><span class="annot"><span class="hs-operator hs-type">:/:</span></span><span> </span><span class="annot"><a href="#local-6989586621679163197"><span class="hs-identifier hs-type">sty</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-87"></span><span>         </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">A.HasAvroSchema</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">WithSchema</span></span><span> </span><span class="annot"><a href="#local-6989586621679163198"><span class="hs-identifier hs-type">sch</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679163197"><span class="hs-identifier hs-type">sty</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679163196"><span class="hs-identifier hs-type">t</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-88"></span><span>  </span><span id="local-6989586621679163193"><span class="annot"><span class="annottext">schema :: Tagged (WithSchema sch sty t) Schema
</span><span class="hs-identifier hs-var hs-var hs-var hs-var">schema</span></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Tagged (Term sch (sch :/: sty)) Schema
-&gt; Tagged (WithSchema sch sty t) Schema
forall a b. Coercible a b =&gt; a -&gt; b
</span><span class="hs-identifier hs-var">coerce</span></span><span> </span><span class="annot"><span class="annottext">(Tagged (Term sch (sch :/: sty)) Schema
 -&gt; Tagged (WithSchema sch sty t) Schema)
-&gt; Tagged (Term sch (sch :/: sty)) Schema
-&gt; Tagged (WithSchema sch sty t) Schema
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">State [TypeName] (Tagged (Term sch (sch :/: sty)) Schema)
-&gt; [TypeName] -&gt; Tagged (Term sch (sch :/: sty)) Schema
forall s a. State s a -&gt; s -&gt; a
</span><span class="hs-identifier hs-var">evalState</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">HasAvroSchema' (Term sch (sch :/: sty)) =&gt;
State [TypeName] (Tagged (Term sch (sch :/: sty)) Schema)
forall k (x :: k).
HasAvroSchema' x =&gt;
State [TypeName] (Tagged x Schema)
</span><a href="Mu.Adapter.Avro.html#schema%27"><span class="hs-identifier hs-var">schema'</span></a></span><span> </span><span class="hs-glyph">@</span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Term</span></span><span> </span><span class="annot"><a href="#local-6989586621679163198"><span class="hs-identifier hs-type">sch</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679163198"><span class="hs-identifier hs-type">sch</span></a></span><span> </span><span class="annot"><span class="hs-operator hs-type">:/:</span></span><span> </span><span class="annot"><a href="#local-6989586621679163197"><span class="hs-identifier hs-type">sty</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span></span></span></span><span>
</span><span id="line-89"></span><span id="local-6989586621679163187"><span id="local-6989586621679163188"><span id="local-6989586621679163189"><span class="hs-keyword">instance</span><span> </span><span class="hs-special">(</span><span> </span><span class="annot"><span class="hs-identifier hs-type">FromSchema</span></span><span> </span><span class="annot"><a href="#local-6989586621679163189"><span class="hs-identifier hs-type">sch</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679163188"><span class="hs-identifier hs-type">sty</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679163187"><span class="hs-identifier hs-type">t</span></a></span><span>
</span><span id="line-90"></span><span>         </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">A.FromAvro</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Term</span></span><span> </span><span class="annot"><a href="#local-6989586621679163189"><span class="hs-identifier hs-type">sch</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679163189"><span class="hs-identifier hs-type">sch</span></a></span><span> </span><span class="annot"><span class="hs-operator hs-type">:/:</span></span><span> </span><span class="annot"><a href="#local-6989586621679163188"><span class="hs-identifier hs-type">sty</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-special">)</span><span>
</span><span id="line-91"></span><span>         </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">A.FromAvro</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">WithSchema</span></span><span> </span><span class="annot"><a href="#local-6989586621679163189"><span class="hs-identifier hs-type">sch</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679163188"><span class="hs-identifier hs-type">sty</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679163187"><span class="hs-identifier hs-type">t</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-92"></span><span>  </span><span id="local-6989586621679163184"><span class="annot"><span class="annottext">fromAvro :: Value -&gt; Either [Char] (WithSchema sch sty t)
</span><span class="hs-identifier hs-var hs-var hs-var hs-var">fromAvro</span></span></span><span> </span><span id="local-6989586621679163182"><span class="annot"><span class="annottext">entire :: Value
</span><a href="#local-6989586621679163182"><span class="hs-identifier hs-var">entire</span></a></span></span><span>
</span><span id="line-93"></span><span>    </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">t -&gt; WithSchema sch sty t
forall tn fn (sch :: Schema tn fn) (sty :: tn) a.
a -&gt; WithSchema sch sty a
</span><span class="hs-identifier hs-var">WithSchema</span></span><span> </span><span class="annot"><span class="annottext">(t -&gt; WithSchema sch sty t)
-&gt; (Term sch (sch :/: sty) -&gt; t)
-&gt; Term sch (sch :/: sty)
-&gt; WithSchema sch sty t
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">forall t (sty :: tn).
FromSchema sch sty t =&gt;
Term sch (sch :/: sty) -&gt; t
forall fn tn (sch :: Schema tn fn) t (sty :: tn).
FromSchema sch sty t =&gt;
Term sch (sch :/: sty) -&gt; t
</span><span class="hs-identifier hs-var">fromSchema'</span></span><span> </span><span class="hs-glyph">@</span><span class="annot"><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">@</span><span class="annot"><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">@</span><span class="annot"><a href="#local-6989586621679163189"><span class="hs-identifier hs-type">sch</span></a></span><span> </span><span class="annot"><span class="annottext">(Term sch (sch :/: sty) -&gt; WithSchema sch sty t)
-&gt; Either [Char] (Term sch (sch :/: sty))
-&gt; Either [Char] (WithSchema sch sty t)
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;$&gt;</span></span><span> </span><span class="annot"><span class="annottext">Value -&gt; Either [Char] (Term sch (sch :/: sty))
forall a. FromAvro a =&gt; Value -&gt; Either [Char] a
</span><span class="hs-identifier hs-var">AVal.fromAvro</span></span><span> </span><span class="annot"><span class="annottext">Value
</span><a href="#local-6989586621679163182"><span class="hs-identifier hs-var">entire</span></a></span></span></span></span><span>
</span><span id="line-94"></span><span id="local-6989586621679163175"><span id="local-6989586621679163176"><span id="local-6989586621679163177"><span class="hs-keyword">instance</span><span> </span><span class="hs-special">(</span><span> </span><span class="annot"><span class="hs-identifier hs-type">ToSchema</span></span><span> </span><span class="annot"><a href="#local-6989586621679163177"><span class="hs-identifier hs-type">sch</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679163176"><span class="hs-identifier hs-type">sty</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679163175"><span class="hs-identifier hs-type">t</span></a></span><span>
</span><span id="line-95"></span><span>         </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">A.ToAvro</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Term</span></span><span> </span><span class="annot"><a href="#local-6989586621679163177"><span class="hs-identifier hs-type">sch</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679163177"><span class="hs-identifier hs-type">sch</span></a></span><span> </span><span class="annot"><span class="hs-operator hs-type">:/:</span></span><span> </span><span class="annot"><a href="#local-6989586621679163176"><span class="hs-identifier hs-type">sty</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-special">)</span><span>
</span><span id="line-96"></span><span>         </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">A.ToAvro</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">WithSchema</span></span><span> </span><span class="annot"><a href="#local-6989586621679163177"><span class="hs-identifier hs-type">sch</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679163176"><span class="hs-identifier hs-type">sty</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679163175"><span class="hs-identifier hs-type">t</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-97"></span><span>  </span><span id="local-6989586621679163172"><span class="annot"><span class="annottext">toAvro :: Schema -&gt; WithSchema sch sty t -&gt; Builder
</span><span class="hs-identifier hs-var hs-var hs-var hs-var">toAvro</span></span></span><span> </span><span id="local-6989586621679163170"><span class="annot"><span class="annottext">sch :: Schema
</span><a href="#local-6989586621679163170"><span class="hs-identifier hs-var">sch</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">WithSchema</span></span><span> </span><span id="local-6989586621679163169"><span class="annot"><span class="annottext">v :: t
</span><a href="#local-6989586621679163169"><span class="hs-identifier hs-var">v</span></a></span></span><span class="hs-special">)</span><span>
</span><span id="line-98"></span><span>    </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Schema -&gt; Term sch (sch :/: sty) -&gt; Builder
forall a. ToAvro a =&gt; Schema -&gt; a -&gt; Builder
</span><span class="hs-identifier hs-var">A.toAvro</span></span><span> </span><span class="annot"><span class="annottext">Schema
</span><a href="#local-6989586621679163170"><span class="hs-identifier hs-var">sch</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">t -&gt; Term sch (sch :/: sty)
forall fn tn (sch :: Schema tn fn) t (sty :: tn).
ToSchema sch sty t =&gt;
t -&gt; Term sch (sch :/: sty)
</span><span class="hs-identifier hs-var">toSchema'</span></span><span> </span><span class="hs-glyph">@</span><span class="annot"><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">@</span><span class="annot"><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">@</span><span class="annot"><a href="#local-6989586621679163177"><span class="hs-identifier hs-type">sch</span></a></span><span> </span><span class="annot"><span class="annottext">t
</span><a href="#local-6989586621679163169"><span class="hs-identifier hs-var">v</span></a></span><span class="hs-special">)</span></span></span></span><span>
</span><span id="line-99"></span><span>
</span><span id="line-100"></span><span class="hs-comment">-- HasAvroSchema instances</span><span>
</span><span id="line-101"></span><span>
</span><span id="line-102"></span><span class="hs-keyword">class</span><span> </span><span id="HasAvroSchema%27"><span class="annot"><a href="Mu.Adapter.Avro.html#HasAvroSchema%27"><span class="hs-identifier hs-var">HasAvroSchema'</span></a></span></span><span> </span><span id="local-6989586621679163672"><span class="annot"><a href="#local-6989586621679163672"><span class="hs-identifier hs-type">x</span></a></span></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-103"></span><span>  </span><span id="schema%27"><span class="annot"><a href="Mu.Adapter.Avro.html#schema%27"><span class="hs-identifier hs-type">schema'</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">State</span></span><span> </span><span class="hs-special">[</span><span class="annot"><span class="hs-identifier hs-type">ASch.TypeName</span></span><span class="hs-special">]</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Tagged</span></span><span> </span><span class="annot"><a href="#local-6989586621679163672"><span class="hs-identifier hs-type">x</span></a></span><span> </span><span class="annot"><span class="hs-identifier hs-type">ASch.Schema</span></span><span class="hs-special">)</span><span>
</span><span id="line-104"></span><span>
</span><span id="line-105"></span><span id="local-6989586621679163166"><span id="local-6989586621679163167"><span class="hs-keyword">instance</span><span> </span><span class="annot"><span class="hs-identifier hs-type">TypeError</span></span><span> </span><span class="hs-special">(</span><span class="hs-special">'</span><span class="annot"><span class="hs-identifier hs-type">Text</span></span><span> </span><span class="annot"><span class="hs-string">&quot;you should never use HasAvroSchema directly on Term, use WithSchema&quot;</span></span><span class="hs-special">)</span><span>
</span><span id="line-106"></span><span>         </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">A.HasAvroSchema</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Term</span></span><span> </span><span class="annot"><a href="#local-6989586621679163167"><span class="hs-identifier hs-type">sch</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679163166"><span class="hs-identifier hs-type">t</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-107"></span><span>  </span><span id="local-6989586621679163164"><span class="annot"><span class="annottext">schema :: Tagged (Term sch t) Schema
</span><a href="#local-6989586621679163164"><span class="hs-identifier hs-var hs-var hs-var hs-var">schema</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[Char] -&gt; Tagged (Term sch t) Schema
forall a. HasCallStack =&gt; [Char] -&gt; a
</span><span class="hs-identifier hs-var">error</span></span><span> </span><span class="annot"><span class="hs-string">&quot;this should never happen&quot;</span></span></span></span><span>
</span><span id="line-108"></span><span id="local-6989586621679163162"><span id="local-6989586621679163163"><span class="hs-keyword">instance</span><span> </span><span class="annot"><a href="Mu.Adapter.Avro.html#HasAvroSchema%27"><span class="hs-identifier hs-type">HasAvroSchema'</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">FieldValue</span></span><span> </span><span class="annot"><a href="#local-6989586621679163163"><span class="hs-identifier hs-type">sch</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679163162"><span class="hs-identifier hs-type">t</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-109"></span><span>         </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">A.HasAvroSchema</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">FieldValue</span></span><span> </span><span class="annot"><a href="#local-6989586621679163163"><span class="hs-identifier hs-type">sch</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679163162"><span class="hs-identifier hs-type">t</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-110"></span><span>  </span><span id="local-6989586621679163160"><span class="annot"><span class="annottext">schema :: Tagged (FieldValue sch t) Schema
</span><a href="#local-6989586621679163160"><span class="hs-identifier hs-var hs-var hs-var hs-var">schema</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">State [TypeName] (Tagged (FieldValue sch t) Schema)
-&gt; [TypeName] -&gt; Tagged (FieldValue sch t) Schema
forall s a. State s a -&gt; s -&gt; a
</span><span class="hs-identifier hs-var">evalState</span></span><span> </span><span class="annot"><span class="annottext">State [TypeName] (Tagged (FieldValue sch t) Schema)
forall k (x :: k).
HasAvroSchema' x =&gt;
State [TypeName] (Tagged x Schema)
</span><a href="Mu.Adapter.Avro.html#schema%27"><span class="hs-identifier hs-var">schema'</span></a></span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span></span></span><span>
</span><span id="line-111"></span><span>
</span><span id="line-112"></span><span id="local-6989586621679163157"><span id="local-6989586621679163158"><span id="local-6989586621679163159"><span class="hs-keyword">instance</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">KnownName</span></span><span> </span><span class="annot"><a href="#local-6989586621679163159"><span class="hs-identifier hs-type">name</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Mu.Adapter.Avro.html#HasAvroSchemaFields"><span class="hs-identifier hs-type">HasAvroSchemaFields</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679163158"><span class="hs-identifier hs-type">sch</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679163157"><span class="hs-identifier hs-type">args</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-113"></span><span>         </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="Mu.Adapter.Avro.html#HasAvroSchema%27"><span class="hs-identifier hs-type">HasAvroSchema'</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Term</span></span><span> </span><span class="annot"><a href="#local-6989586621679163158"><span class="hs-identifier hs-type">sch</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">'</span><span class="annot"><span class="hs-identifier hs-type">DRecord</span></span><span> </span><span class="annot"><a href="#local-6989586621679163159"><span class="hs-identifier hs-type">name</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679163157"><span class="hs-identifier hs-type">args</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-114"></span><span>  </span><span id="local-6989586621679163154"><span class="annot"><span class="annottext">schema' :: State [TypeName] (Tagged (Term sch ('DRecord name args)) Schema)
</span><a href="#local-6989586621679163154"><span class="hs-identifier hs-var hs-var hs-var hs-var">schema'</span></a></span></span><span>
</span><span id="line-115"></span><span>    </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span> </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621679163153"><span class="annot"><span class="annottext">recordName :: TypeName
</span><a href="#local-6989586621679163153"><span class="hs-identifier hs-var hs-var">recordName</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Proxy name -&gt; TypeName
forall k (s :: k) (proxy :: k -&gt; *).
KnownName s =&gt;
proxy s -&gt; TypeName
</span><a href="Mu.Adapter.Avro.html#nameTypeName"><span class="hs-identifier hs-var">nameTypeName</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Proxy name
forall k (t :: k). Proxy t
</span><span class="hs-identifier hs-var">Proxy</span></span><span> </span><span class="hs-glyph">@</span><span class="annot"><a href="#local-6989586621679163159"><span class="hs-identifier hs-type">name</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-116"></span><span>         </span><span id="local-6989586621679163150"><span class="annot"><span class="annottext">Bool
</span><a href="#local-6989586621679163150"><span class="hs-identifier hs-var">visited</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">([TypeName] -&gt; Bool) -&gt; StateT [TypeName] Identity Bool
forall (m :: * -&gt; *) s a. Monad m =&gt; (s -&gt; a) -&gt; StateT s m a
</span><span class="hs-identifier hs-var">gets</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">TypeName
</span><a href="#local-6989586621679163153"><span class="hs-identifier hs-var">recordName</span></a></span><span> </span><span class="annot"><span class="annottext">TypeName -&gt; [TypeName] -&gt; Bool
forall (t :: * -&gt; *) a. (Foldable t, Eq a) =&gt; a -&gt; t a -&gt; Bool
</span><span class="hs-operator hs-var">`elem`</span></span><span class="hs-special">)</span><span>
</span><span id="line-117"></span><span>         </span><span class="hs-keyword">if</span><span> </span><span class="annot"><span class="annottext">Bool
</span><a href="#local-6989586621679163150"><span class="hs-identifier hs-var">visited</span></a></span><span>
</span><span id="line-118"></span><span>            </span><span class="hs-keyword">then</span><span> </span><span class="annot"><span class="annottext">Tagged (Term sch ('DRecord name args)) Schema
-&gt; State [TypeName] (Tagged (Term sch ('DRecord name args)) Schema)
forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><span class="hs-identifier hs-var">pure</span></span><span> </span><span class="annot"><span class="annottext">(Tagged (Term sch ('DRecord name args)) Schema
 -&gt; State
      [TypeName] (Tagged (Term sch ('DRecord name args)) Schema))
-&gt; Tagged (Term sch ('DRecord name args)) Schema
-&gt; State [TypeName] (Tagged (Term sch ('DRecord name args)) Schema)
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Schema -&gt; Tagged (Term sch ('DRecord name args)) Schema
forall k (s :: k) b. b -&gt; Tagged s b
</span><span class="hs-identifier hs-var">Tagged</span></span><span> </span><span class="annot"><span class="annottext">(Schema -&gt; Tagged (Term sch ('DRecord name args)) Schema)
-&gt; Schema -&gt; Tagged (Term sch ('DRecord name args)) Schema
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">TypeName -&gt; Schema
</span><span class="hs-identifier hs-var">ASch.NamedType</span></span><span> </span><span class="annot"><span class="annottext">TypeName
</span><a href="#local-6989586621679163153"><span class="hs-identifier hs-var">recordName</span></a></span><span>
</span><span id="line-119"></span><span>            </span><span class="hs-keyword">else</span><span> </span><span class="hs-keyword">do</span><span> </span><span class="annot"><span class="annottext">([TypeName] -&gt; [TypeName]) -&gt; StateT [TypeName] Identity ()
forall (m :: * -&gt; *) s. Monad m =&gt; (s -&gt; s) -&gt; StateT s m ()
</span><span class="hs-identifier hs-var">modify</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">TypeName
</span><a href="#local-6989586621679163153"><span class="hs-identifier hs-var">recordName</span></a></span><span> </span><span class="annot"><span class="annottext">TypeName -&gt; [TypeName] -&gt; [TypeName]
forall a. a -&gt; [a] -&gt; [a]
</span><span class="hs-glyph hs-var">:</span></span><span class="hs-special">)</span><span>
</span><span id="line-120"></span><span>                    </span><span id="local-6989586621679163144"><span class="annot"><span class="annottext">[Field]
</span><a href="#local-6989586621679163144"><span class="hs-identifier hs-var">fields</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Proxy sch -&gt; Proxy args -&gt; State [TypeName] [Field]
forall k tn fn (sch :: k) (fs :: [FieldDef tn fn]).
HasAvroSchemaFields sch fs =&gt;
Proxy sch -&gt; Proxy fs -&gt; State [TypeName] [Field]
</span><a href="Mu.Adapter.Avro.html#schemaF"><span class="hs-identifier hs-var">schemaF</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Proxy sch
forall k (t :: k). Proxy t
</span><span class="hs-identifier hs-var">Proxy</span></span><span> </span><span class="hs-glyph">@</span><span class="annot"><a href="#local-6989586621679163158"><span class="hs-identifier hs-type">sch</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Proxy args
forall k (t :: k). Proxy t
</span><span class="hs-identifier hs-var">Proxy</span></span><span> </span><span class="hs-glyph">@</span><span class="annot"><a href="#local-6989586621679163157"><span class="hs-identifier hs-type">args</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-121"></span><span>                    </span><span class="annot"><span class="annottext">Tagged (Term sch ('DRecord name args)) Schema
-&gt; State [TypeName] (Tagged (Term sch ('DRecord name args)) Schema)
forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><span class="hs-identifier hs-var">pure</span></span><span> </span><span class="annot"><span class="annottext">(Tagged (Term sch ('DRecord name args)) Schema
 -&gt; State
      [TypeName] (Tagged (Term sch ('DRecord name args)) Schema))
-&gt; Tagged (Term sch ('DRecord name args)) Schema
-&gt; State [TypeName] (Tagged (Term sch ('DRecord name args)) Schema)
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Schema -&gt; Tagged (Term sch ('DRecord name args)) Schema
forall k (s :: k) b. b -&gt; Tagged s b
</span><span class="hs-identifier hs-var">Tagged</span></span><span> </span><span class="annot"><span class="annottext">(Schema -&gt; Tagged (Term sch ('DRecord name args)) Schema)
-&gt; Schema -&gt; Tagged (Term sch ('DRecord name args)) Schema
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">TypeName -&gt; [TypeName] -&gt; Maybe Text -&gt; [Field] -&gt; Schema
</span><span class="hs-identifier hs-var">ASch.Record</span></span><span> </span><span class="annot"><span class="annottext">TypeName
</span><a href="#local-6989586621679163153"><span class="hs-identifier hs-var">recordName</span></a></span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span> </span><span class="annot"><span class="annottext">Maybe Text
forall a. Maybe a
</span><span class="hs-identifier hs-var">Nothing</span></span><span> </span><span class="annot"><span class="annottext">[Field]
</span><a href="#local-6989586621679163144"><span class="hs-identifier hs-var">fields</span></a></span></span></span></span><span>
</span><span id="line-122"></span><span id="local-6989586621679163139"><span id="local-6989586621679163140"><span id="local-6989586621679163141"><span class="hs-keyword">instance</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">KnownName</span></span><span> </span><span class="annot"><a href="#local-6989586621679163141"><span class="hs-identifier hs-type">name</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Mu.Adapter.Avro.html#HasAvroSchemaEnum"><span class="hs-identifier hs-type">HasAvroSchemaEnum</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679163140"><span class="hs-identifier hs-type">choices</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-123"></span><span>          </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="Mu.Adapter.Avro.html#HasAvroSchema%27"><span class="hs-identifier hs-type">HasAvroSchema'</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Term</span></span><span> </span><span class="annot"><a href="#local-6989586621679163139"><span class="hs-identifier hs-type">sch</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">'</span><span class="annot"><span class="hs-identifier hs-type">DEnum</span></span><span> </span><span class="annot"><a href="#local-6989586621679163141"><span class="hs-identifier hs-type">name</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679163140"><span class="hs-identifier hs-type">choices</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-124"></span><span>  </span><span id="local-6989586621679163137"><span class="annot"><span class="annottext">schema' :: State [TypeName] (Tagged (Term sch ('DEnum name choices)) Schema)
</span><a href="#local-6989586621679163137"><span class="hs-identifier hs-var hs-var hs-var hs-var">schema'</span></a></span></span><span>
</span><span id="line-125"></span><span>    </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span> </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621679163136"><span class="annot"><span class="annottext">enumName :: TypeName
</span><a href="#local-6989586621679163136"><span class="hs-identifier hs-var hs-var">enumName</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Proxy name -&gt; TypeName
forall k (s :: k) (proxy :: k -&gt; *).
KnownName s =&gt;
proxy s -&gt; TypeName
</span><a href="Mu.Adapter.Avro.html#nameTypeName"><span class="hs-identifier hs-var">nameTypeName</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Proxy name
forall k (t :: k). Proxy t
</span><span class="hs-identifier hs-var">Proxy</span></span><span> </span><span class="hs-glyph">@</span><span class="annot"><a href="#local-6989586621679163141"><span class="hs-identifier hs-type">name</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-126"></span><span>             </span><span id="local-6989586621679163135"><span class="annot"><span class="annottext">choicesNames :: [Text]
</span><a href="#local-6989586621679163135"><span class="hs-identifier hs-var hs-var">choicesNames</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Proxy choices -&gt; [Text]
forall fn (fs :: [ChoiceDef fn]).
HasAvroSchemaEnum fs =&gt;
Proxy fs -&gt; [Text]
</span><a href="Mu.Adapter.Avro.html#schemaE"><span class="hs-identifier hs-var">schemaE</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Proxy choices
forall k (t :: k). Proxy t
</span><span class="hs-identifier hs-var">Proxy</span></span><span> </span><span class="hs-glyph">@</span><span class="annot"><a href="#local-6989586621679163140"><span class="hs-identifier hs-type">choices</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-127"></span><span>         </span><span id="local-6989586621679163133"><span class="annot"><span class="annottext">Bool
</span><a href="#local-6989586621679163133"><span class="hs-identifier hs-var">visited</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">([TypeName] -&gt; Bool) -&gt; StateT [TypeName] Identity Bool
forall (m :: * -&gt; *) s a. Monad m =&gt; (s -&gt; a) -&gt; StateT s m a
</span><span class="hs-identifier hs-var">gets</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">TypeName
</span><a href="#local-6989586621679163136"><span class="hs-identifier hs-var">enumName</span></a></span><span> </span><span class="annot"><span class="annottext">TypeName -&gt; [TypeName] -&gt; Bool
forall (t :: * -&gt; *) a. (Foldable t, Eq a) =&gt; a -&gt; t a -&gt; Bool
</span><span class="hs-operator hs-var">`elem`</span></span><span class="hs-special">)</span><span>
</span><span id="line-128"></span><span>         </span><span class="hs-keyword">if</span><span> </span><span class="annot"><span class="annottext">Bool
</span><a href="#local-6989586621679163133"><span class="hs-identifier hs-var">visited</span></a></span><span>
</span><span id="line-129"></span><span>            </span><span class="hs-keyword">then</span><span> </span><span class="annot"><span class="annottext">Tagged (Term sch ('DEnum name choices)) Schema
-&gt; State
     [TypeName] (Tagged (Term sch ('DEnum name choices)) Schema)
forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><span class="hs-identifier hs-var">pure</span></span><span> </span><span class="annot"><span class="annottext">(Tagged (Term sch ('DEnum name choices)) Schema
 -&gt; State
      [TypeName] (Tagged (Term sch ('DEnum name choices)) Schema))
-&gt; Tagged (Term sch ('DEnum name choices)) Schema
-&gt; State
     [TypeName] (Tagged (Term sch ('DEnum name choices)) Schema)
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Schema -&gt; Tagged (Term sch ('DEnum name choices)) Schema
forall k (s :: k) b. b -&gt; Tagged s b
</span><span class="hs-identifier hs-var">Tagged</span></span><span> </span><span class="annot"><span class="annottext">(Schema -&gt; Tagged (Term sch ('DEnum name choices)) Schema)
-&gt; Schema -&gt; Tagged (Term sch ('DEnum name choices)) Schema
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">TypeName -&gt; Schema
</span><span class="hs-identifier hs-var">ASch.NamedType</span></span><span> </span><span class="annot"><span class="annottext">TypeName
</span><a href="#local-6989586621679163136"><span class="hs-identifier hs-var">enumName</span></a></span><span>
</span><span id="line-130"></span><span>            </span><span class="hs-keyword">else</span><span> </span><span class="hs-keyword">do</span><span> </span><span class="annot"><span class="annottext">([TypeName] -&gt; [TypeName]) -&gt; StateT [TypeName] Identity ()
forall (m :: * -&gt; *) s. Monad m =&gt; (s -&gt; s) -&gt; StateT s m ()
</span><span class="hs-identifier hs-var">modify</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">TypeName
</span><a href="#local-6989586621679163136"><span class="hs-identifier hs-var">enumName</span></a></span><span> </span><span class="annot"><span class="annottext">TypeName -&gt; [TypeName] -&gt; [TypeName]
forall a. a -&gt; [a] -&gt; [a]
</span><span class="hs-glyph hs-var">:</span></span><span class="hs-special">)</span><span>
</span><span id="line-131"></span><span>                    </span><span class="annot"><span class="annottext">Tagged (Term sch ('DEnum name choices)) Schema
-&gt; State
     [TypeName] (Tagged (Term sch ('DEnum name choices)) Schema)
forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><span class="hs-identifier hs-var">pure</span></span><span> </span><span class="annot"><span class="annottext">(Tagged (Term sch ('DEnum name choices)) Schema
 -&gt; State
      [TypeName] (Tagged (Term sch ('DEnum name choices)) Schema))
-&gt; Tagged (Term sch ('DEnum name choices)) Schema
-&gt; State
     [TypeName] (Tagged (Term sch ('DEnum name choices)) Schema)
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Schema -&gt; Tagged (Term sch ('DEnum name choices)) Schema
forall k (s :: k) b. b -&gt; Tagged s b
</span><span class="hs-identifier hs-var">Tagged</span></span><span> </span><span class="annot"><span class="annottext">(Schema -&gt; Tagged (Term sch ('DEnum name choices)) Schema)
-&gt; Schema -&gt; Tagged (Term sch ('DEnum name choices)) Schema
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">TypeName -&gt; [TypeName] -&gt; Maybe Text -&gt; [Text] -&gt; Schema
</span><span class="hs-identifier hs-var">ASch.mkEnum</span></span><span> </span><span class="annot"><span class="annottext">TypeName
</span><a href="#local-6989586621679163136"><span class="hs-identifier hs-var">enumName</span></a></span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span> </span><span class="annot"><span class="annottext">Maybe Text
forall a. Maybe a
</span><span class="hs-identifier hs-var">Nothing</span></span><span> </span><span class="annot"><span class="annottext">[Text]
</span><a href="#local-6989586621679163135"><span class="hs-identifier hs-var">choicesNames</span></a></span></span></span></span><span>
</span><span id="line-132"></span><span>
</span><span id="line-133"></span><span id="local-6989586621679163130"><span id="local-6989586621679163131"><span class="hs-keyword">instance</span><span> </span><span class="annot"><a href="Mu.Adapter.Avro.html#HasAvroSchema%27"><span class="hs-identifier hs-type">HasAvroSchema'</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">FieldValue</span></span><span> </span><span class="annot"><a href="#local-6989586621679163131"><span class="hs-identifier hs-type">sch</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679163130"><span class="hs-identifier hs-type">t</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-134"></span><span>         </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="Mu.Adapter.Avro.html#HasAvroSchema%27"><span class="hs-identifier hs-type">HasAvroSchema'</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Term</span></span><span> </span><span class="annot"><a href="#local-6989586621679163131"><span class="hs-identifier hs-type">sch</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">'</span><span class="annot"><span class="hs-identifier hs-type">DSimple</span></span><span> </span><span class="annot"><a href="#local-6989586621679163130"><span class="hs-identifier hs-type">t</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-135"></span><span>  </span><span id="local-6989586621679163128"><span class="annot"><span class="annottext">schema' :: State [TypeName] (Tagged (Term sch ('DSimple t)) Schema)
</span><a href="#local-6989586621679163128"><span class="hs-identifier hs-var hs-var hs-var hs-var">schema'</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Tagged (FieldValue sch t) Schema
-&gt; Tagged (Term sch ('DSimple t)) Schema
forall a b. Coercible a b =&gt; a -&gt; b
</span><span class="hs-identifier hs-var">coerce</span></span><span> </span><span class="annot"><span class="annottext">(Tagged (FieldValue sch t) Schema
 -&gt; Tagged (Term sch ('DSimple t)) Schema)
-&gt; StateT [TypeName] Identity (Tagged (FieldValue sch t) Schema)
-&gt; State [TypeName] (Tagged (Term sch ('DSimple t)) Schema)
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;$&gt;</span></span><span> </span><span class="annot"><span class="annottext">HasAvroSchema' (FieldValue sch t) =&gt;
StateT [TypeName] Identity (Tagged (FieldValue sch t) Schema)
forall k (x :: k).
HasAvroSchema' x =&gt;
State [TypeName] (Tagged x Schema)
</span><a href="Mu.Adapter.Avro.html#schema%27"><span class="hs-identifier hs-var">schema'</span></a></span><span> </span><span class="hs-glyph">@</span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">FieldValue</span></span><span> </span><span class="annot"><a href="#local-6989586621679163131"><span class="hs-identifier hs-type">sch</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679163130"><span class="hs-identifier hs-type">t</span></a></span><span class="hs-special">)</span></span></span><span>
</span><span id="line-136"></span><span>
</span><span id="line-137"></span><span id="local-6989586621679163127"><span class="hs-keyword">instance</span><span> </span><span class="annot"><a href="Mu.Adapter.Avro.html#HasAvroSchema%27"><span class="hs-identifier hs-type">HasAvroSchema'</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">FieldValue</span></span><span> </span><span class="annot"><a href="#local-6989586621679163127"><span class="hs-identifier hs-type">sch</span></a></span><span> </span><span class="hs-special">'</span><span class="annot"><span class="hs-identifier hs-type">TNull</span></span><span class="hs-special">)</span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-138"></span><span>  </span><span id="local-6989586621679163125"><span class="annot"><span class="annottext">schema' :: State [TypeName] (Tagged (FieldValue sch 'TNull) Schema)
</span><a href="#local-6989586621679163125"><span class="hs-identifier hs-var hs-var hs-var hs-var">schema'</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Tagged (FieldValue sch 'TNull) Schema
-&gt; State [TypeName] (Tagged (FieldValue sch 'TNull) Schema)
forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><span class="hs-identifier hs-var">pure</span></span><span> </span><span class="annot"><span class="annottext">(Tagged (FieldValue sch 'TNull) Schema
 -&gt; State [TypeName] (Tagged (FieldValue sch 'TNull) Schema))
-&gt; Tagged (FieldValue sch 'TNull) Schema
-&gt; State [TypeName] (Tagged (FieldValue sch 'TNull) Schema)
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Schema -&gt; Tagged (FieldValue sch 'TNull) Schema
forall k (s :: k) b. b -&gt; Tagged s b
</span><span class="hs-identifier hs-var">Tagged</span></span><span> </span><span class="annot"><span class="annottext">Schema
</span><span class="hs-identifier hs-var">ASch.Null</span></span></span><span>
</span><span id="line-139"></span><span id="local-6989586621679163122"><span id="local-6989586621679163123"><span class="hs-keyword">instance</span><span> </span><span class="annot"><span class="hs-identifier hs-type">A.HasAvroSchema</span></span><span> </span><span class="annot"><a href="#local-6989586621679163123"><span class="hs-identifier hs-type">t</span></a></span><span>
</span><span id="line-140"></span><span>         </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="Mu.Adapter.Avro.html#HasAvroSchema%27"><span class="hs-identifier hs-type">HasAvroSchema'</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">FieldValue</span></span><span> </span><span class="annot"><a href="#local-6989586621679163122"><span class="hs-identifier hs-type">sch</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">'</span><span class="annot"><span class="hs-identifier hs-type">TPrimitive</span></span><span> </span><span class="annot"><a href="#local-6989586621679163123"><span class="hs-identifier hs-type">t</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-141"></span><span>  </span><span id="local-6989586621679163120"><span class="annot"><span class="annottext">schema' :: State [TypeName] (Tagged (FieldValue sch ('TPrimitive t)) Schema)
</span><a href="#local-6989586621679163120"><span class="hs-identifier hs-var hs-var hs-var hs-var">schema'</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Tagged (FieldValue sch ('TPrimitive t)) Schema
-&gt; State
     [TypeName] (Tagged (FieldValue sch ('TPrimitive t)) Schema)
forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><span class="hs-identifier hs-var">pure</span></span><span> </span><span class="annot"><span class="annottext">(Tagged (FieldValue sch ('TPrimitive t)) Schema
 -&gt; State
      [TypeName] (Tagged (FieldValue sch ('TPrimitive t)) Schema))
-&gt; Tagged (FieldValue sch ('TPrimitive t)) Schema
-&gt; State
     [TypeName] (Tagged (FieldValue sch ('TPrimitive t)) Schema)
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Tagged t Schema -&gt; Tagged (FieldValue sch ('TPrimitive t)) Schema
forall a b. Coercible a b =&gt; a -&gt; b
</span><span class="hs-identifier hs-var">coerce</span></span><span> </span><span class="annot"><span class="annottext">(Tagged t Schema -&gt; Tagged (FieldValue sch ('TPrimitive t)) Schema)
-&gt; Tagged t Schema
-&gt; Tagged (FieldValue sch ('TPrimitive t)) Schema
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">HasAvroSchema t =&gt; Tagged t Schema
forall a. HasAvroSchema a =&gt; Tagged a Schema
</span><span class="hs-identifier hs-var">A.schema</span></span><span> </span><span class="hs-glyph">@</span><span class="annot"><a href="#local-6989586621679163123"><span class="hs-identifier hs-type">t</span></a></span></span></span><span>
</span><span id="line-142"></span><span id="local-6989586621679163118"><span id="local-6989586621679163119"><span class="hs-keyword">instance</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Mu.Adapter.Avro.html#HasAvroSchema%27"><span class="hs-identifier hs-type">HasAvroSchema'</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Term</span></span><span> </span><span class="annot"><a href="#local-6989586621679163119"><span class="hs-identifier hs-type">sch</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679163119"><span class="hs-identifier hs-type">sch</span></a></span><span> </span><span class="annot"><span class="hs-operator hs-type">:/:</span></span><span> </span><span class="annot"><a href="#local-6989586621679163118"><span class="hs-identifier hs-type">t</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-143"></span><span>         </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="Mu.Adapter.Avro.html#HasAvroSchema%27"><span class="hs-identifier hs-type">HasAvroSchema'</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">FieldValue</span></span><span> </span><span class="annot"><a href="#local-6989586621679163119"><span class="hs-identifier hs-type">sch</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">'</span><span class="annot"><span class="hs-identifier hs-type">TSchematic</span></span><span> </span><span class="annot"><a href="#local-6989586621679163118"><span class="hs-identifier hs-type">t</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-144"></span><span>  </span><span id="local-6989586621679163116"><span class="annot"><span class="annottext">schema' :: State [TypeName] (Tagged (FieldValue sch ('TSchematic t)) Schema)
</span><a href="#local-6989586621679163116"><span class="hs-identifier hs-var hs-var hs-var hs-var">schema'</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Tagged (Term sch (sch :/: t)) Schema
-&gt; Tagged (FieldValue sch ('TSchematic t)) Schema
forall a b. Coercible a b =&gt; a -&gt; b
</span><span class="hs-identifier hs-var">coerce</span></span><span> </span><span class="annot"><span class="annottext">(Tagged (Term sch (sch :/: t)) Schema
 -&gt; Tagged (FieldValue sch ('TSchematic t)) Schema)
-&gt; StateT
     [TypeName] Identity (Tagged (Term sch (sch :/: t)) Schema)
-&gt; State
     [TypeName] (Tagged (FieldValue sch ('TSchematic t)) Schema)
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;$&gt;</span></span><span> </span><span class="annot"><span class="annottext">HasAvroSchema' (Term sch (sch :/: t)) =&gt;
StateT [TypeName] Identity (Tagged (Term sch (sch :/: t)) Schema)
forall k (x :: k).
HasAvroSchema' x =&gt;
State [TypeName] (Tagged x Schema)
</span><a href="Mu.Adapter.Avro.html#schema%27"><span class="hs-identifier hs-var">schema'</span></a></span><span> </span><span class="hs-glyph">@</span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Term</span></span><span> </span><span class="annot"><a href="#local-6989586621679163119"><span class="hs-identifier hs-type">sch</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679163119"><span class="hs-identifier hs-type">sch</span></a></span><span> </span><span class="annot"><span class="hs-operator hs-type">:/:</span></span><span> </span><span class="annot"><a href="#local-6989586621679163118"><span class="hs-identifier hs-type">t</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span></span></span><span>
</span><span id="line-145"></span><span class="hs-keyword">instance</span><span> </span><span class="hs-keyword">forall</span><span> </span><span id="local-6989586621679163114"><span class="annot"><a href="#local-6989586621679163114"><span class="hs-identifier hs-type">sch</span></a></span></span><span> </span><span id="local-6989586621679163113"><span class="annot"><a href="#local-6989586621679163113"><span class="hs-identifier hs-type">choices</span></a></span></span><span class="hs-operator">.</span><span>
</span><span id="line-146"></span><span>         </span><span class="annot"><a href="Mu.Adapter.Avro.html#HasAvroSchemaUnion"><span class="hs-identifier hs-type">HasAvroSchemaUnion</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">FieldValue</span></span><span> </span><span class="annot"><a href="#local-6989586621679163114"><span class="hs-identifier hs-type">sch</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><a href="#local-6989586621679163113"><span class="hs-identifier hs-type">choices</span></a></span><span>
</span><span id="line-147"></span><span>         </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="Mu.Adapter.Avro.html#HasAvroSchema%27"><span class="hs-identifier hs-type">HasAvroSchema'</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">FieldValue</span></span><span> </span><span class="annot"><a href="#local-6989586621679163114"><span class="hs-identifier hs-type">sch</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">'</span><span class="annot"><span class="hs-identifier hs-type">TUnion</span></span><span> </span><span class="annot"><a href="#local-6989586621679163113"><span class="hs-identifier hs-type">choices</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-148"></span><span>  </span><span id="local-6989586621679163112"><span class="annot"><span class="annottext">schema' :: State [TypeName] (Tagged (FieldValue sch ('TUnion choices)) Schema)
</span><a href="#local-6989586621679163112"><span class="hs-identifier hs-var hs-var hs-var hs-var">schema'</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-149"></span><span>    </span><span id="local-6989586621679163111"><span class="annot"><span class="annottext">NonEmpty Schema
</span><a href="#local-6989586621679163111"><span class="hs-identifier hs-var">schs</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Proxy (FieldValue sch)
-&gt; Proxy choices -&gt; State [TypeName] (NonEmpty Schema)
forall k (f :: k -&gt; *) (xs :: [k]).
HasAvroSchemaUnion f xs =&gt;
Proxy f -&gt; Proxy xs -&gt; State [TypeName] (NonEmpty Schema)
</span><a href="Mu.Adapter.Avro.html#schemaU"><span class="hs-identifier hs-var">schemaU</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Proxy (FieldValue sch)
forall k (t :: k). Proxy t
</span><span class="hs-identifier hs-var">Proxy</span></span><span> </span><span class="hs-glyph">@</span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">FieldValue</span></span><span> </span><span class="annot"><a href="#local-6989586621679163114"><span class="hs-identifier hs-type">sch</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Proxy choices
forall k (t :: k). Proxy t
</span><span class="hs-identifier hs-var">Proxy</span></span><span> </span><span class="hs-glyph">@</span><span class="annot"><a href="#local-6989586621679163113"><span class="hs-identifier hs-type">choices</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-150"></span><span>    </span><span class="annot"><span class="annottext">Tagged (FieldValue sch ('TUnion choices)) Schema
-&gt; State
     [TypeName] (Tagged (FieldValue sch ('TUnion choices)) Schema)
forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><span class="hs-identifier hs-var">pure</span></span><span> </span><span class="annot"><span class="annottext">(Tagged (FieldValue sch ('TUnion choices)) Schema
 -&gt; State
      [TypeName] (Tagged (FieldValue sch ('TUnion choices)) Schema))
-&gt; Tagged (FieldValue sch ('TUnion choices)) Schema
-&gt; State
     [TypeName] (Tagged (FieldValue sch ('TUnion choices)) Schema)
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Schema -&gt; Tagged (FieldValue sch ('TUnion choices)) Schema
forall k (s :: k) b. b -&gt; Tagged s b
</span><span class="hs-identifier hs-var">Tagged</span></span><span> </span><span class="annot"><span class="annottext">(Schema -&gt; Tagged (FieldValue sch ('TUnion choices)) Schema)
-&gt; Schema -&gt; Tagged (FieldValue sch ('TUnion choices)) Schema
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">NonEmpty Schema -&gt; Schema
</span><span class="hs-identifier hs-var">ASch.mkUnion</span></span><span> </span><span class="annot"><span class="annottext">NonEmpty Schema
</span><a href="#local-6989586621679163111"><span class="hs-identifier hs-var">schs</span></a></span><span>
</span><span id="line-151"></span><span id="local-6989586621679163107"><span id="local-6989586621679163108"><span class="hs-keyword">instance</span><span> </span><span class="annot"><a href="Mu.Adapter.Avro.html#HasAvroSchema%27"><span class="hs-identifier hs-type">HasAvroSchema'</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">FieldValue</span></span><span> </span><span class="annot"><a href="#local-6989586621679163108"><span class="hs-identifier hs-type">sch</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679163107"><span class="hs-identifier hs-type">t</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-152"></span><span>         </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="Mu.Adapter.Avro.html#HasAvroSchema%27"><span class="hs-identifier hs-type">HasAvroSchema'</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">FieldValue</span></span><span> </span><span class="annot"><a href="#local-6989586621679163108"><span class="hs-identifier hs-type">sch</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">'</span><span class="annot"><span class="hs-identifier hs-type">TOption</span></span><span> </span><span class="annot"><a href="#local-6989586621679163107"><span class="hs-identifier hs-type">t</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-153"></span><span>  </span><span id="local-6989586621679163105"><span class="annot"><span class="annottext">schema' :: State [TypeName] (Tagged (FieldValue sch ('TOption t)) Schema)
</span><a href="#local-6989586621679163105"><span class="hs-identifier hs-var hs-var hs-var hs-var">schema'</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-154"></span><span>    </span><span id="local-6989586621679163104"><span class="annot"><span class="annottext">Schema
</span><a href="#local-6989586621679163104"><span class="hs-identifier hs-var">iSchema</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Tagged (FieldValue sch t) Schema -&gt; Schema
forall k (s :: k) b. Tagged s b -&gt; b
</span><span class="hs-identifier hs-var hs-var">unTagged</span></span><span> </span><span class="annot"><span class="annottext">(Tagged (FieldValue sch t) Schema -&gt; Schema)
-&gt; StateT [TypeName] Identity (Tagged (FieldValue sch t) Schema)
-&gt; StateT [TypeName] Identity Schema
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;$&gt;</span></span><span> </span><span class="annot"><span class="annottext">HasAvroSchema' (FieldValue sch t) =&gt;
StateT [TypeName] Identity (Tagged (FieldValue sch t) Schema)
forall k (x :: k).
HasAvroSchema' x =&gt;
State [TypeName] (Tagged x Schema)
</span><a href="Mu.Adapter.Avro.html#schema%27"><span class="hs-identifier hs-var">schema'</span></a></span><span> </span><span class="hs-glyph">@</span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">FieldValue</span></span><span> </span><span class="annot"><a href="#local-6989586621679163108"><span class="hs-identifier hs-type">sch</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679163107"><span class="hs-identifier hs-type">t</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-155"></span><span>    </span><span class="annot"><span class="annottext">Tagged (FieldValue sch ('TOption t)) Schema
-&gt; State [TypeName] (Tagged (FieldValue sch ('TOption t)) Schema)
forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><span class="hs-identifier hs-var">pure</span></span><span> </span><span class="annot"><span class="annottext">(Tagged (FieldValue sch ('TOption t)) Schema
 -&gt; State [TypeName] (Tagged (FieldValue sch ('TOption t)) Schema))
-&gt; Tagged (FieldValue sch ('TOption t)) Schema
-&gt; State [TypeName] (Tagged (FieldValue sch ('TOption t)) Schema)
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Schema -&gt; Tagged (FieldValue sch ('TOption t)) Schema
forall k (s :: k) b. b -&gt; Tagged s b
</span><span class="hs-identifier hs-var">Tagged</span></span><span> </span><span class="annot"><span class="annottext">(Schema -&gt; Tagged (FieldValue sch ('TOption t)) Schema)
-&gt; Schema -&gt; Tagged (FieldValue sch ('TOption t)) Schema
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">NonEmpty Schema -&gt; Schema
</span><span class="hs-identifier hs-var">ASch.mkUnion</span></span><span> </span><span class="annot"><span class="annottext">(NonEmpty Schema -&gt; Schema) -&gt; NonEmpty Schema -&gt; Schema
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Schema
</span><span class="hs-identifier hs-var">ASch.Null</span></span><span> </span><span class="annot"><span class="annottext">Schema -&gt; [Schema] -&gt; NonEmpty Schema
forall a. a -&gt; [a] -&gt; NonEmpty a
</span><span class="hs-operator hs-var">:|</span></span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">Schema
</span><a href="#local-6989586621679163104"><span class="hs-identifier hs-var">iSchema</span></a></span><span class="hs-special">]</span></span></span><span>
</span><span id="line-156"></span><span id="local-6989586621679163100"><span id="local-6989586621679163101"><span class="hs-keyword">instance</span><span> </span><span class="annot"><a href="Mu.Adapter.Avro.html#HasAvroSchema%27"><span class="hs-identifier hs-type">HasAvroSchema'</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">FieldValue</span></span><span> </span><span class="annot"><a href="#local-6989586621679163101"><span class="hs-identifier hs-type">sch</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679163100"><span class="hs-identifier hs-type">t</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-157"></span><span>         </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="Mu.Adapter.Avro.html#HasAvroSchema%27"><span class="hs-identifier hs-type">HasAvroSchema'</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">FieldValue</span></span><span> </span><span class="annot"><a href="#local-6989586621679163101"><span class="hs-identifier hs-type">sch</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">'</span><span class="annot"><span class="hs-identifier hs-type">TList</span></span><span> </span><span class="annot"><a href="#local-6989586621679163100"><span class="hs-identifier hs-type">t</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-158"></span><span>  </span><span id="local-6989586621679163098"><span class="annot"><span class="annottext">schema' :: State [TypeName] (Tagged (FieldValue sch ('TList t)) Schema)
</span><a href="#local-6989586621679163098"><span class="hs-identifier hs-var hs-var hs-var hs-var">schema'</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-159"></span><span>    </span><span id="local-6989586621679163097"><span class="annot"><span class="annottext">Schema
</span><a href="#local-6989586621679163097"><span class="hs-identifier hs-var">iSchema</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Tagged (FieldValue sch t) Schema -&gt; Schema
forall k (s :: k) b. Tagged s b -&gt; b
</span><span class="hs-identifier hs-var hs-var">unTagged</span></span><span> </span><span class="annot"><span class="annottext">(Tagged (FieldValue sch t) Schema -&gt; Schema)
-&gt; StateT [TypeName] Identity (Tagged (FieldValue sch t) Schema)
-&gt; StateT [TypeName] Identity Schema
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;$&gt;</span></span><span> </span><span class="annot"><span class="annottext">HasAvroSchema' (FieldValue sch t) =&gt;
StateT [TypeName] Identity (Tagged (FieldValue sch t) Schema)
forall k (x :: k).
HasAvroSchema' x =&gt;
State [TypeName] (Tagged x Schema)
</span><a href="Mu.Adapter.Avro.html#schema%27"><span class="hs-identifier hs-var">schema'</span></a></span><span> </span><span class="hs-glyph">@</span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">FieldValue</span></span><span> </span><span class="annot"><a href="#local-6989586621679163101"><span class="hs-identifier hs-type">sch</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679163100"><span class="hs-identifier hs-type">t</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-160"></span><span>    </span><span class="annot"><span class="annottext">Tagged (FieldValue sch ('TList t)) Schema
-&gt; State [TypeName] (Tagged (FieldValue sch ('TList t)) Schema)
forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><span class="hs-identifier hs-var">pure</span></span><span> </span><span class="annot"><span class="annottext">(Tagged (FieldValue sch ('TList t)) Schema
 -&gt; State [TypeName] (Tagged (FieldValue sch ('TList t)) Schema))
-&gt; Tagged (FieldValue sch ('TList t)) Schema
-&gt; State [TypeName] (Tagged (FieldValue sch ('TList t)) Schema)
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Schema -&gt; Tagged (FieldValue sch ('TList t)) Schema
forall k (s :: k) b. b -&gt; Tagged s b
</span><span class="hs-identifier hs-var">Tagged</span></span><span> </span><span class="annot"><span class="annottext">(Schema -&gt; Tagged (FieldValue sch ('TList t)) Schema)
-&gt; Schema -&gt; Tagged (FieldValue sch ('TList t)) Schema
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Schema -&gt; Schema
</span><span class="hs-identifier hs-var">ASch.Array</span></span><span> </span><span class="annot"><span class="annottext">Schema
</span><a href="#local-6989586621679163097"><span class="hs-identifier hs-var">iSchema</span></a></span></span></span><span>
</span><span id="line-161"></span><span class="hs-comment">-- These are the only two versions of Map supported by the library</span><span>
</span><span id="line-162"></span><span id="local-6989586621679163094"><span id="local-6989586621679163095"><span class="hs-keyword">instance</span><span> </span><span class="annot"><a href="Mu.Adapter.Avro.html#HasAvroSchema%27"><span class="hs-identifier hs-type">HasAvroSchema'</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">FieldValue</span></span><span> </span><span class="annot"><a href="#local-6989586621679163095"><span class="hs-identifier hs-type">sch</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679163094"><span class="hs-identifier hs-type">v</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-163"></span><span>         </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="Mu.Adapter.Avro.html#HasAvroSchema%27"><span class="hs-identifier hs-type">HasAvroSchema'</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">FieldValue</span></span><span> </span><span class="annot"><a href="#local-6989586621679163095"><span class="hs-identifier hs-type">sch</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">'</span><span class="annot"><span class="hs-identifier hs-type">TMap</span></span><span> </span><span class="hs-special">(</span><span class="hs-special">'</span><span class="annot"><span class="hs-identifier hs-type">TPrimitive</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">T.Text</span></span><span class="hs-special">)</span><span> </span><span class="annot"><a href="#local-6989586621679163094"><span class="hs-identifier hs-type">v</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-164"></span><span>  </span><span id="local-6989586621679163092"><span class="annot"><span class="annottext">schema' :: State
  [TypeName]
  (Tagged (FieldValue sch ('TMap ('TPrimitive Text) v)) Schema)
</span><a href="#local-6989586621679163092"><span class="hs-identifier hs-var hs-var hs-var hs-var">schema'</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-165"></span><span>    </span><span id="local-6989586621679163091"><span class="annot"><span class="annottext">Schema
</span><a href="#local-6989586621679163091"><span class="hs-identifier hs-var">iSchema</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Tagged (FieldValue sch v) Schema -&gt; Schema
forall k (s :: k) b. Tagged s b -&gt; b
</span><span class="hs-identifier hs-var hs-var">unTagged</span></span><span> </span><span class="annot"><span class="annottext">(Tagged (FieldValue sch v) Schema -&gt; Schema)
-&gt; StateT [TypeName] Identity (Tagged (FieldValue sch v) Schema)
-&gt; StateT [TypeName] Identity Schema
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;$&gt;</span></span><span> </span><span class="annot"><span class="annottext">HasAvroSchema' (FieldValue sch v) =&gt;
StateT [TypeName] Identity (Tagged (FieldValue sch v) Schema)
forall k (x :: k).
HasAvroSchema' x =&gt;
State [TypeName] (Tagged x Schema)
</span><a href="Mu.Adapter.Avro.html#schema%27"><span class="hs-identifier hs-var">schema'</span></a></span><span> </span><span class="hs-glyph">@</span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">FieldValue</span></span><span> </span><span class="annot"><a href="#local-6989586621679163095"><span class="hs-identifier hs-type">sch</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679163094"><span class="hs-identifier hs-type">v</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-166"></span><span>    </span><span class="annot"><span class="annottext">Tagged (FieldValue sch ('TMap ('TPrimitive Text) v)) Schema
-&gt; State
     [TypeName]
     (Tagged (FieldValue sch ('TMap ('TPrimitive Text) v)) Schema)
forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><span class="hs-identifier hs-var">pure</span></span><span> </span><span class="annot"><span class="annottext">(Tagged (FieldValue sch ('TMap ('TPrimitive Text) v)) Schema
 -&gt; State
      [TypeName]
      (Tagged (FieldValue sch ('TMap ('TPrimitive Text) v)) Schema))
-&gt; Tagged (FieldValue sch ('TMap ('TPrimitive Text) v)) Schema
-&gt; State
     [TypeName]
     (Tagged (FieldValue sch ('TMap ('TPrimitive Text) v)) Schema)
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Schema
-&gt; Tagged (FieldValue sch ('TMap ('TPrimitive Text) v)) Schema
forall k (s :: k) b. b -&gt; Tagged s b
</span><span class="hs-identifier hs-var">Tagged</span></span><span> </span><span class="annot"><span class="annottext">(Schema
 -&gt; Tagged (FieldValue sch ('TMap ('TPrimitive Text) v)) Schema)
-&gt; Schema
-&gt; Tagged (FieldValue sch ('TMap ('TPrimitive Text) v)) Schema
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Schema -&gt; Schema
</span><span class="hs-identifier hs-var">ASch.Map</span></span><span> </span><span class="annot"><span class="annottext">Schema
</span><a href="#local-6989586621679163091"><span class="hs-identifier hs-var">iSchema</span></a></span></span></span><span>
</span><span id="line-167"></span><span id="local-6989586621679163088"><span id="local-6989586621679163089"><span class="hs-keyword">instance</span><span> </span><span class="annot"><a href="Mu.Adapter.Avro.html#HasAvroSchema%27"><span class="hs-identifier hs-type">HasAvroSchema'</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">FieldValue</span></span><span> </span><span class="annot"><a href="#local-6989586621679163089"><span class="hs-identifier hs-type">sch</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679163088"><span class="hs-identifier hs-type">v</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-168"></span><span>         </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="Mu.Adapter.Avro.html#HasAvroSchema%27"><span class="hs-identifier hs-type">HasAvroSchema'</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">FieldValue</span></span><span> </span><span class="annot"><a href="#local-6989586621679163089"><span class="hs-identifier hs-type">sch</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">'</span><span class="annot"><span class="hs-identifier hs-type">TMap</span></span><span> </span><span class="hs-special">(</span><span class="hs-special">'</span><span class="annot"><span class="hs-identifier hs-type">TPrimitive</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">String</span></span><span class="hs-special">)</span><span> </span><span class="annot"><a href="#local-6989586621679163088"><span class="hs-identifier hs-type">v</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-169"></span><span>  </span><span id="local-6989586621679163085"><span class="annot"><span class="annottext">schema' :: State
  [TypeName]
  (Tagged (FieldValue sch ('TMap ('TPrimitive [Char]) v)) Schema)
</span><a href="#local-6989586621679163085"><span class="hs-identifier hs-var hs-var hs-var hs-var">schema'</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-170"></span><span>    </span><span id="local-6989586621679163084"><span class="annot"><span class="annottext">Schema
</span><a href="#local-6989586621679163084"><span class="hs-identifier hs-var">iSchema</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Tagged (FieldValue sch v) Schema -&gt; Schema
forall k (s :: k) b. Tagged s b -&gt; b
</span><span class="hs-identifier hs-var hs-var">unTagged</span></span><span> </span><span class="annot"><span class="annottext">(Tagged (FieldValue sch v) Schema -&gt; Schema)
-&gt; StateT [TypeName] Identity (Tagged (FieldValue sch v) Schema)
-&gt; StateT [TypeName] Identity Schema
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;$&gt;</span></span><span> </span><span class="annot"><span class="annottext">HasAvroSchema' (FieldValue sch v) =&gt;
StateT [TypeName] Identity (Tagged (FieldValue sch v) Schema)
forall k (x :: k).
HasAvroSchema' x =&gt;
State [TypeName] (Tagged x Schema)
</span><a href="Mu.Adapter.Avro.html#schema%27"><span class="hs-identifier hs-var">schema'</span></a></span><span> </span><span class="hs-glyph">@</span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">FieldValue</span></span><span> </span><span class="annot"><a href="#local-6989586621679163089"><span class="hs-identifier hs-type">sch</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679163088"><span class="hs-identifier hs-type">v</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-171"></span><span>    </span><span class="annot"><span class="annottext">Tagged (FieldValue sch ('TMap ('TPrimitive [Char]) v)) Schema
-&gt; State
     [TypeName]
     (Tagged (FieldValue sch ('TMap ('TPrimitive [Char]) v)) Schema)
forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><span class="hs-identifier hs-var">pure</span></span><span> </span><span class="annot"><span class="annottext">(Tagged (FieldValue sch ('TMap ('TPrimitive [Char]) v)) Schema
 -&gt; State
      [TypeName]
      (Tagged (FieldValue sch ('TMap ('TPrimitive [Char]) v)) Schema))
-&gt; Tagged (FieldValue sch ('TMap ('TPrimitive [Char]) v)) Schema
-&gt; State
     [TypeName]
     (Tagged (FieldValue sch ('TMap ('TPrimitive [Char]) v)) Schema)
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Schema
-&gt; Tagged (FieldValue sch ('TMap ('TPrimitive [Char]) v)) Schema
forall k (s :: k) b. b -&gt; Tagged s b
</span><span class="hs-identifier hs-var">Tagged</span></span><span> </span><span class="annot"><span class="annottext">(Schema
 -&gt; Tagged (FieldValue sch ('TMap ('TPrimitive [Char]) v)) Schema)
-&gt; Schema
-&gt; Tagged (FieldValue sch ('TMap ('TPrimitive [Char]) v)) Schema
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Schema -&gt; Schema
</span><span class="hs-identifier hs-var">ASch.Map</span></span><span> </span><span class="annot"><span class="annottext">Schema
</span><a href="#local-6989586621679163084"><span class="hs-identifier hs-var">iSchema</span></a></span></span></span><span>
</span><span id="line-172"></span><span>
</span><span id="line-173"></span><span class="hs-keyword">class</span><span> </span><span id="HasAvroSchemaUnion"><span class="annot"><a href="Mu.Adapter.Avro.html#HasAvroSchemaUnion"><span class="hs-identifier hs-var">HasAvroSchemaUnion</span></a></span></span><span> </span><span class="hs-special">(</span><span id="local-6989586621679163550"><span class="annot"><a href="#local-6989586621679163550"><span class="hs-identifier hs-type">f</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span id="local-6989586621679163551"><span class="annot"><a href="#local-6989586621679163551"><span class="hs-identifier hs-type hs-type">k</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-operator">*</span></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span id="local-6989586621679163549"><span class="annot"><a href="#local-6989586621679163549"><span class="hs-identifier hs-type">xs</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="#local-6989586621679163551"><span class="hs-identifier hs-type">k</span></a></span><span class="hs-special">]</span><span class="hs-special">)</span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-174"></span><span>  </span><span id="schemaU"><span class="annot"><a href="Mu.Adapter.Avro.html#schemaU"><span class="hs-identifier hs-type">schemaU</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Proxy</span></span><span> </span><span class="annot"><a href="#local-6989586621679163550"><span class="hs-identifier hs-type">f</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Proxy</span></span><span> </span><span class="annot"><a href="#local-6989586621679163549"><span class="hs-identifier hs-type">xs</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">State</span></span><span> </span><span class="hs-special">[</span><span class="annot"><span class="hs-identifier hs-type">ASch.TypeName</span></span><span class="hs-special">]</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">NonEmpty</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">ASch.Schema</span></span><span class="hs-special">)</span><span>
</span><span id="line-175"></span><span id="local-6989586621679163082"><span id="local-6989586621679163083"><span class="hs-keyword">instance</span><span> </span><span class="annot"><a href="Mu.Adapter.Avro.html#HasAvroSchema%27"><span class="hs-identifier hs-type">HasAvroSchema'</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679163083"><span class="hs-identifier hs-type">f</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679163082"><span class="hs-identifier hs-type">v</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="Mu.Adapter.Avro.html#HasAvroSchemaUnion"><span class="hs-identifier hs-type">HasAvroSchemaUnion</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679163083"><span class="hs-identifier hs-type">f</span></a></span><span> </span><span class="hs-special">'</span><span class="hs-special">[</span><span class="annot"><a href="#local-6989586621679163082"><span class="hs-identifier hs-type">v</span></a></span><span class="hs-special">]</span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-176"></span><span>  </span><span id="local-6989586621679163079"><span class="annot"><span class="annottext">schemaU :: Proxy f -&gt; Proxy '[v] -&gt; State [TypeName] (NonEmpty Schema)
</span><a href="#local-6989586621679163079"><span class="hs-identifier hs-var hs-var hs-var hs-var">schemaU</span></a></span></span><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-177"></span><span>    </span><span id="local-6989586621679163078"><span class="annot"><span class="annottext">Schema
</span><a href="#local-6989586621679163078"><span class="hs-identifier hs-var">vSchema</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Tagged (f v) Schema -&gt; Schema
forall k (s :: k) b. Tagged s b -&gt; b
</span><span class="hs-identifier hs-var hs-var">unTagged</span></span><span> </span><span class="annot"><span class="annottext">(Tagged (f v) Schema -&gt; Schema)
-&gt; StateT [TypeName] Identity (Tagged (f v) Schema)
-&gt; StateT [TypeName] Identity Schema
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;$&gt;</span></span><span> </span><span class="annot"><span class="annottext">HasAvroSchema' (f v) =&gt;
StateT [TypeName] Identity (Tagged (f v) Schema)
forall k (x :: k).
HasAvroSchema' x =&gt;
State [TypeName] (Tagged x Schema)
</span><a href="Mu.Adapter.Avro.html#schema%27"><span class="hs-identifier hs-var">schema'</span></a></span><span> </span><span class="hs-glyph">@</span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679163083"><span class="hs-identifier hs-type">f</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679163082"><span class="hs-identifier hs-type">v</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-178"></span><span>    </span><span class="annot"><span class="annottext">NonEmpty Schema -&gt; State [TypeName] (NonEmpty Schema)
forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><span class="hs-identifier hs-var">pure</span></span><span> </span><span class="annot"><span class="annottext">(NonEmpty Schema -&gt; State [TypeName] (NonEmpty Schema))
-&gt; NonEmpty Schema -&gt; State [TypeName] (NonEmpty Schema)
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Schema
</span><a href="#local-6989586621679163078"><span class="hs-identifier hs-var">vSchema</span></a></span><span> </span><span class="annot"><span class="annottext">Schema -&gt; [Schema] -&gt; NonEmpty Schema
forall a. a -&gt; [a] -&gt; NonEmpty a
</span><span class="hs-operator hs-var">:|</span></span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span></span></span><span>
</span><span id="line-179"></span><span id="local-6989586621679163074"><span id="local-6989586621679163075"><span id="local-6989586621679163076"><span id="local-6989586621679163077"><span class="hs-keyword">instance</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Mu.Adapter.Avro.html#HasAvroSchema%27"><span class="hs-identifier hs-type">HasAvroSchema'</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679163077"><span class="hs-identifier hs-type">f</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679163076"><span class="hs-identifier hs-type">x</span></a></span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Mu.Adapter.Avro.html#HasAvroSchemaUnion"><span class="hs-identifier hs-type">HasAvroSchemaUnion</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679163077"><span class="hs-identifier hs-type">f</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679163075"><span class="hs-identifier hs-type">y</span></a></span><span> </span><span class="hs-special">'</span><span class="hs-glyph">:</span><span> </span><span class="annot"><a href="#local-6989586621679163074"><span class="hs-identifier hs-type">zs</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-180"></span><span>         </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="Mu.Adapter.Avro.html#HasAvroSchemaUnion"><span class="hs-identifier hs-type">HasAvroSchemaUnion</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679163077"><span class="hs-identifier hs-type">f</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679163076"><span class="hs-identifier hs-type">x</span></a></span><span> </span><span class="hs-special">'</span><span class="hs-glyph">:</span><span> </span><span class="annot"><a href="#local-6989586621679163075"><span class="hs-identifier hs-type">y</span></a></span><span> </span><span class="hs-special">'</span><span class="hs-glyph">:</span><span> </span><span class="annot"><a href="#local-6989586621679163074"><span class="hs-identifier hs-type">zs</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-181"></span><span>  </span><span id="local-6989586621679163072"><span class="annot"><span class="annottext">schemaU :: Proxy f -&gt; Proxy (x : y : zs) -&gt; State [TypeName] (NonEmpty Schema)
</span><a href="#local-6989586621679163072"><span class="hs-identifier hs-var hs-var hs-var hs-var">schemaU</span></a></span></span><span> </span><span id="local-6989586621679163071"><span class="annot"><span class="annottext">p :: Proxy f
</span><a href="#local-6989586621679163071"><span class="hs-identifier hs-var">p</span></a></span></span><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-182"></span><span>    </span><span id="local-6989586621679163070"><span class="annot"><span class="annottext">Schema
</span><a href="#local-6989586621679163070"><span class="hs-identifier hs-var">xSchema</span></a></span></span><span>   </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Tagged (f x) Schema -&gt; Schema
forall k (s :: k) b. Tagged s b -&gt; b
</span><span class="hs-identifier hs-var hs-var">unTagged</span></span><span> </span><span class="annot"><span class="annottext">(Tagged (f x) Schema -&gt; Schema)
-&gt; StateT [TypeName] Identity (Tagged (f x) Schema)
-&gt; StateT [TypeName] Identity Schema
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;$&gt;</span></span><span> </span><span class="annot"><span class="annottext">HasAvroSchema' (f x) =&gt;
StateT [TypeName] Identity (Tagged (f x) Schema)
forall k (x :: k).
HasAvroSchema' x =&gt;
State [TypeName] (Tagged x Schema)
</span><a href="Mu.Adapter.Avro.html#schema%27"><span class="hs-identifier hs-var">schema'</span></a></span><span> </span><span class="hs-glyph">@</span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679163077"><span class="hs-identifier hs-type">f</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679163076"><span class="hs-identifier hs-type">x</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-183"></span><span>    </span><span id="local-6989586621679163069"><span class="annot"><span class="annottext">NonEmpty Schema
</span><a href="#local-6989586621679163069"><span class="hs-identifier hs-var">yzsSchema</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Proxy f -&gt; Proxy (y : zs) -&gt; State [TypeName] (NonEmpty Schema)
forall k (f :: k -&gt; *) (xs :: [k]).
HasAvroSchemaUnion f xs =&gt;
Proxy f -&gt; Proxy xs -&gt; State [TypeName] (NonEmpty Schema)
</span><a href="Mu.Adapter.Avro.html#schemaU"><span class="hs-identifier hs-var">schemaU</span></a></span><span> </span><span class="annot"><span class="annottext">Proxy f
</span><a href="#local-6989586621679163071"><span class="hs-identifier hs-var">p</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Proxy (y : zs)
forall k (t :: k). Proxy t
</span><span class="hs-identifier hs-var">Proxy</span></span><span> </span><span class="hs-glyph">@</span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679163075"><span class="hs-identifier hs-type">y</span></a></span><span> </span><span class="hs-special">'</span><span class="hs-glyph">:</span><span> </span><span class="annot"><a href="#local-6989586621679163074"><span class="hs-identifier hs-type">zs</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-184"></span><span>    </span><span class="annot"><span class="annottext">NonEmpty Schema -&gt; State [TypeName] (NonEmpty Schema)
forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><span class="hs-identifier hs-var">pure</span></span><span> </span><span class="annot"><span class="annottext">(NonEmpty Schema -&gt; State [TypeName] (NonEmpty Schema))
-&gt; NonEmpty Schema -&gt; State [TypeName] (NonEmpty Schema)
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Schema
</span><a href="#local-6989586621679163070"><span class="hs-identifier hs-var">xSchema</span></a></span><span> </span><span class="annot"><span class="annottext">Schema -&gt; [Schema] -&gt; NonEmpty Schema
forall a. a -&gt; [a] -&gt; NonEmpty a
</span><span class="hs-operator hs-var">:|</span></span><span> </span><span class="annot"><span class="annottext">NonEmpty Schema -&gt; [Schema]
forall a. NonEmpty a -&gt; [a]
</span><span class="hs-identifier hs-var">NonEmptyList.toList</span></span><span> </span><span class="annot"><span class="annottext">NonEmpty Schema
</span><a href="#local-6989586621679163069"><span class="hs-identifier hs-var">yzsSchema</span></a></span></span></span></span></span><span>
</span><span id="line-185"></span><span>
</span><span id="line-186"></span><span class="hs-keyword">class</span><span> </span><span id="HasAvroSchemaFields"><span class="annot"><a href="Mu.Adapter.Avro.html#HasAvroSchemaFields"><span class="hs-identifier hs-var">HasAvroSchemaFields</span></a></span></span><span> </span><span id="local-6989586621679163589"><span class="annot"><a href="#local-6989586621679163589"><span class="hs-identifier hs-type">sch</span></a></span></span><span> </span><span class="hs-special">(</span><span id="local-6989586621679163588"><span class="annot"><a href="#local-6989586621679163588"><span class="hs-identifier hs-type">fs</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">[</span><span class="annot"><span class="hs-identifier hs-type">FieldDef</span></span><span> </span><span id="local-6989586621679163591"><span class="annot"><a href="#local-6989586621679163591"><span class="hs-identifier hs-type hs-type">tn</span></a></span></span><span> </span><span id="local-6989586621679163590"><span class="annot"><a href="#local-6989586621679163590"><span class="hs-identifier hs-type hs-type">fn</span></a></span></span><span class="hs-special">]</span><span class="hs-special">)</span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-187"></span><span>  </span><span id="schemaF"><span class="annot"><a href="Mu.Adapter.Avro.html#schemaF"><span class="hs-identifier hs-type">schemaF</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Proxy</span></span><span> </span><span class="annot"><a href="#local-6989586621679163589"><span class="hs-identifier hs-type">sch</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Proxy</span></span><span> </span><span class="annot"><a href="#local-6989586621679163588"><span class="hs-identifier hs-type">fs</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">State</span></span><span> </span><span class="hs-special">[</span><span class="annot"><span class="hs-identifier hs-type">ASch.TypeName</span></span><span class="hs-special">]</span><span> </span><span class="hs-special">[</span><span class="annot"><span class="hs-identifier hs-type">ASch.Field</span></span><span class="hs-special">]</span><span>
</span><span id="line-188"></span><span id="local-6989586621679163067"><span class="hs-keyword">instance</span><span> </span><span class="annot"><a href="Mu.Adapter.Avro.html#HasAvroSchemaFields"><span class="hs-identifier hs-type">HasAvroSchemaFields</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679163067"><span class="hs-identifier hs-type">sch</span></a></span><span> </span><span class="hs-special">'</span><span class="hs-special">[</span><span class="hs-special">]</span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-189"></span><span>  </span><span id="local-6989586621679163064"><span class="annot"><span class="annottext">schemaF :: Proxy sch -&gt; Proxy '[] -&gt; State [TypeName] [Field]
</span><a href="#local-6989586621679163064"><span class="hs-identifier hs-var hs-var hs-var hs-var">schemaF</span></a></span></span><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[Field] -&gt; State [TypeName] [Field]
forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><span class="hs-identifier hs-var">pure</span></span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span></span><span>
</span><span id="line-190"></span><span id="local-6989586621679163060"><span id="local-6989586621679163061"><span id="local-6989586621679163062"><span id="local-6989586621679163063"><span class="hs-keyword">instance</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">KnownName</span></span><span> </span><span class="annot"><a href="#local-6989586621679163063"><span class="hs-identifier hs-type">name</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Mu.Adapter.Avro.html#HasAvroSchema%27"><span class="hs-identifier hs-type">HasAvroSchema'</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">FieldValue</span></span><span> </span><span class="annot"><a href="#local-6989586621679163062"><span class="hs-identifier hs-type">sch</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679163061"><span class="hs-identifier hs-type">t</span></a></span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Mu.Adapter.Avro.html#HasAvroSchemaFields"><span class="hs-identifier hs-type">HasAvroSchemaFields</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679163062"><span class="hs-identifier hs-type">sch</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679163060"><span class="hs-identifier hs-type">fs</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-191"></span><span>         </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="Mu.Adapter.Avro.html#HasAvroSchemaFields"><span class="hs-identifier hs-type">HasAvroSchemaFields</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679163062"><span class="hs-identifier hs-type">sch</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">'</span><span class="annot"><span class="hs-identifier hs-type">FieldDef</span></span><span> </span><span class="annot"><a href="#local-6989586621679163063"><span class="hs-identifier hs-type">name</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679163061"><span class="hs-identifier hs-type">t</span></a></span><span> </span><span class="hs-special">'</span><span class="hs-glyph">:</span><span> </span><span class="annot"><a href="#local-6989586621679163060"><span class="hs-identifier hs-type">fs</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-192"></span><span>  </span><span id="local-6989586621679163058"><span class="annot"><span class="annottext">schemaF :: Proxy sch
-&gt; Proxy ('FieldDef name t : fs) -&gt; State [TypeName] [Field]
</span><a href="#local-6989586621679163058"><span class="hs-identifier hs-var hs-var hs-var hs-var">schemaF</span></a></span></span><span> </span><span id="local-6989586621679163057"><span class="annot"><span class="annottext">psch :: Proxy sch
</span><a href="#local-6989586621679163057"><span class="hs-identifier hs-var">psch</span></a></span></span><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-193"></span><span>    </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621679163056"><span class="annot"><span class="annottext">fieldName :: Text
</span><a href="#local-6989586621679163056"><span class="hs-identifier hs-var hs-var">fieldName</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Proxy name -&gt; Text
forall k (s :: k) (proxy :: k -&gt; *). KnownName s =&gt; proxy s -&gt; Text
</span><a href="Mu.Adapter.Avro.html#nameText"><span class="hs-identifier hs-var">nameText</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Proxy name
forall k (t :: k). Proxy t
</span><span class="hs-identifier hs-var">Proxy</span></span><span> </span><span class="hs-glyph">@</span><span class="annot"><a href="#local-6989586621679163063"><span class="hs-identifier hs-type">name</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-194"></span><span>    </span><span id="local-6989586621679163054"><span class="annot"><span class="annottext">Schema
</span><a href="#local-6989586621679163054"><span class="hs-identifier hs-var">schemaT</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Tagged (FieldValue sch t) Schema -&gt; Schema
forall k (s :: k) b. Tagged s b -&gt; b
</span><span class="hs-identifier hs-var hs-var">unTagged</span></span><span> </span><span class="annot"><span class="annottext">(Tagged (FieldValue sch t) Schema -&gt; Schema)
-&gt; StateT [TypeName] Identity (Tagged (FieldValue sch t) Schema)
-&gt; StateT [TypeName] Identity Schema
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;$&gt;</span></span><span> </span><span class="annot"><span class="annottext">HasAvroSchema' (FieldValue sch t) =&gt;
StateT [TypeName] Identity (Tagged (FieldValue sch t) Schema)
forall k (x :: k).
HasAvroSchema' x =&gt;
State [TypeName] (Tagged x Schema)
</span><a href="Mu.Adapter.Avro.html#schema%27"><span class="hs-identifier hs-var">schema'</span></a></span><span> </span><span class="hs-glyph">@</span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">FieldValue</span></span><span> </span><span class="annot"><a href="#local-6989586621679163062"><span class="hs-identifier hs-type">sch</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679163061"><span class="hs-identifier hs-type">t</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-195"></span><span>    </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621679163053"><span class="annot"><span class="annottext">schemaThis :: Field
</span><a href="#local-6989586621679163053"><span class="hs-identifier hs-var hs-var">schemaThis</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Text
-&gt; [Text]
-&gt; Maybe Text
-&gt; Maybe Order
-&gt; Schema
-&gt; Maybe DefaultValue
-&gt; Field
</span><span class="hs-identifier hs-var">ASch.Field</span></span><span> </span><span class="annot"><span class="annottext">Text
</span><a href="#local-6989586621679163056"><span class="hs-identifier hs-var">fieldName</span></a></span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span> </span><span class="annot"><span class="annottext">Maybe Text
forall a. Maybe a
</span><span class="hs-identifier hs-var">Nothing</span></span><span> </span><span class="annot"><span class="annottext">Maybe Order
forall a. Maybe a
</span><span class="hs-identifier hs-var">Nothing</span></span><span> </span><span class="annot"><span class="annottext">Schema
</span><a href="#local-6989586621679163054"><span class="hs-identifier hs-var">schemaT</span></a></span><span> </span><span class="annot"><span class="annottext">Maybe DefaultValue
forall a. Maybe a
</span><span class="hs-identifier hs-var">Nothing</span></span><span>
</span><span id="line-196"></span><span>    </span><span id="local-6989586621679163051"><span class="annot"><span class="annottext">[Field]
</span><a href="#local-6989586621679163051"><span class="hs-identifier hs-var">rest</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Proxy sch -&gt; Proxy fs -&gt; State [TypeName] [Field]
forall k tn fn (sch :: k) (fs :: [FieldDef tn fn]).
HasAvroSchemaFields sch fs =&gt;
Proxy sch -&gt; Proxy fs -&gt; State [TypeName] [Field]
</span><a href="Mu.Adapter.Avro.html#schemaF"><span class="hs-identifier hs-var">schemaF</span></a></span><span> </span><span class="annot"><span class="annottext">Proxy sch
</span><a href="#local-6989586621679163057"><span class="hs-identifier hs-var">psch</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Proxy fs
forall k (t :: k). Proxy t
</span><span class="hs-identifier hs-var">Proxy</span></span><span> </span><span class="hs-glyph">@</span><span class="annot"><a href="#local-6989586621679163060"><span class="hs-identifier hs-type">fs</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-197"></span><span>    </span><span class="annot"><span class="annottext">[Field] -&gt; State [TypeName] [Field]
forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><span class="hs-identifier hs-var">pure</span></span><span> </span><span class="annot"><span class="annottext">([Field] -&gt; State [TypeName] [Field])
-&gt; [Field] -&gt; State [TypeName] [Field]
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Field
</span><a href="#local-6989586621679163053"><span class="hs-identifier hs-var">schemaThis</span></a></span><span> </span><span class="annot"><span class="annottext">Field -&gt; [Field] -&gt; [Field]
forall a. a -&gt; [a] -&gt; [a]
</span><span class="hs-glyph hs-var">:</span></span><span> </span><span class="annot"><span class="annottext">[Field]
</span><a href="#local-6989586621679163051"><span class="hs-identifier hs-var">rest</span></a></span></span></span></span></span><span>
</span><span id="line-198"></span><span>
</span><span id="line-199"></span><span class="hs-keyword">class</span><span> </span><span id="HasAvroSchemaEnum"><span class="annot"><a href="Mu.Adapter.Avro.html#HasAvroSchemaEnum"><span class="hs-identifier hs-var">HasAvroSchemaEnum</span></a></span></span><span> </span><span class="hs-special">(</span><span id="local-6989586621679163578"><span class="annot"><a href="#local-6989586621679163578"><span class="hs-identifier hs-type">fs</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">[</span><span class="annot"><span class="hs-identifier hs-type">ChoiceDef</span></span><span> </span><span id="local-6989586621679163579"><span class="annot"><a href="#local-6989586621679163579"><span class="hs-identifier hs-type hs-type">fn</span></a></span></span><span class="hs-special">]</span><span class="hs-special">)</span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-200"></span><span>  </span><span id="schemaE"><span class="annot"><a href="Mu.Adapter.Avro.html#schemaE"><span class="hs-identifier hs-type">schemaE</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Proxy</span></span><span> </span><span class="annot"><a href="#local-6989586621679163578"><span class="hs-identifier hs-type">fs</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><span class="hs-identifier hs-type">T.Text</span></span><span class="hs-special">]</span><span>
</span><span id="line-201"></span><span class="hs-keyword">instance</span><span> </span><span class="annot"><a href="Mu.Adapter.Avro.html#HasAvroSchemaEnum"><span class="hs-identifier hs-type">HasAvroSchemaEnum</span></a></span><span> </span><span class="hs-special">'</span><span class="hs-special">[</span><span class="hs-special">]</span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-202"></span><span>  </span><span id="local-6989586621679163048"><span class="annot"><span class="annottext">schemaE :: Proxy '[] -&gt; [Text]
</span><a href="#local-6989586621679163048"><span class="hs-identifier hs-var hs-var hs-var hs-var">schemaE</span></a></span></span><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span>
</span><span id="line-203"></span><span id="local-6989586621679163046"><span id="local-6989586621679163047"><span class="hs-keyword">instance</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">KnownName</span></span><span> </span><span class="annot"><a href="#local-6989586621679163047"><span class="hs-identifier hs-type">name</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Mu.Adapter.Avro.html#HasAvroSchemaEnum"><span class="hs-identifier hs-type">HasAvroSchemaEnum</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679163046"><span class="hs-identifier hs-type">fs</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-204"></span><span>         </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="Mu.Adapter.Avro.html#HasAvroSchemaEnum"><span class="hs-identifier hs-type">HasAvroSchemaEnum</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">'</span><span class="annot"><span class="hs-identifier hs-type">ChoiceDef</span></span><span> </span><span class="annot"><a href="#local-6989586621679163047"><span class="hs-identifier hs-type">name</span></a></span><span> </span><span class="hs-special">'</span><span class="hs-glyph">:</span><span> </span><span class="annot"><a href="#local-6989586621679163046"><span class="hs-identifier hs-type">fs</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-205"></span><span>  </span><span id="local-6989586621679163044"><span class="annot"><span class="annottext">schemaE :: Proxy ('ChoiceDef name : fs) -&gt; [Text]
</span><a href="#local-6989586621679163044"><span class="hs-identifier hs-var hs-var hs-var hs-var">schemaE</span></a></span></span><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Proxy name -&gt; Text
forall k (s :: k) (proxy :: k -&gt; *). KnownName s =&gt; proxy s -&gt; Text
</span><a href="Mu.Adapter.Avro.html#nameText"><span class="hs-identifier hs-var">nameText</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Proxy name
forall k (t :: k). Proxy t
</span><span class="hs-identifier hs-var">Proxy</span></span><span> </span><span class="hs-glyph">@</span><span class="annot"><a href="#local-6989586621679163047"><span class="hs-identifier hs-type">name</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Text -&gt; [Text] -&gt; [Text]
forall a. a -&gt; [a] -&gt; [a]
</span><span class="hs-glyph hs-var">:</span></span><span> </span><span class="annot"><span class="annottext">Proxy fs -&gt; [Text]
forall fn (fs :: [ChoiceDef fn]).
HasAvroSchemaEnum fs =&gt;
Proxy fs -&gt; [Text]
</span><a href="Mu.Adapter.Avro.html#schemaE"><span class="hs-identifier hs-var">schemaE</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Proxy fs
forall k (t :: k). Proxy t
</span><span class="hs-identifier hs-var">Proxy</span></span><span> </span><span class="hs-glyph">@</span><span class="annot"><a href="#local-6989586621679163046"><span class="hs-identifier hs-type">fs</span></a></span><span class="hs-special">)</span></span></span><span>
</span><span id="line-206"></span><span>
</span><span id="line-207"></span><span class="hs-comment">-- FromAvro instances</span><span>
</span><span id="line-208"></span><span>
</span><span id="line-209"></span><span id="local-6989586621679163041"><span id="local-6989586621679163042"><span id="local-6989586621679163043"><span class="hs-keyword">instance</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">KnownName</span></span><span> </span><span class="annot"><a href="#local-6989586621679163043"><span class="hs-identifier hs-type">name</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Mu.Adapter.Avro.html#FromAvroFields"><span class="hs-identifier hs-type">FromAvroFields</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679163042"><span class="hs-identifier hs-type">sch</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679163041"><span class="hs-identifier hs-type">args</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-210"></span><span>         </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">A.FromAvro</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Term</span></span><span> </span><span class="annot"><a href="#local-6989586621679163042"><span class="hs-identifier hs-type">sch</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">'</span><span class="annot"><span class="hs-identifier hs-type">DRecord</span></span><span> </span><span class="annot"><a href="#local-6989586621679163043"><span class="hs-identifier hs-type">name</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679163041"><span class="hs-identifier hs-type">args</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-211"></span><span>  </span><span id="local-6989586621679163039"><span class="annot"><span class="annottext">fromAvro :: Value -&gt; Either [Char] (Term sch ('DRecord name args))
</span><a href="#local-6989586621679163039"><span class="hs-identifier hs-var hs-var hs-var hs-var">fromAvro</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">AVal.Record</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">RSch.Record</span></span><span> </span><span class="hs-special">{</span><span> </span><span class="annot"><span class="annottext">fields :: ReadSchema -&gt; [ReadField]
</span><span class="hs-identifier hs-var">RSch.fields</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span id="local-6989586621679163038"><span class="annot"><span class="annottext">[ReadField]
</span><a href="#local-6989586621679163038"><span class="hs-identifier hs-var">fs</span></a></span></span><span> </span><span class="hs-special">}</span><span> </span><span id="local-6989586621679163037"><span class="annot"><span class="annottext">fields :: Vector Value
</span><a href="#local-6989586621679163037"><span class="hs-identifier hs-var">fields</span></a></span></span><span class="hs-special">)</span><span>
</span><span id="line-212"></span><span>    </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">NP (Field sch) args -&gt; Term sch ('DRecord name args)
forall typeName fieldName (sch :: Schema typeName fieldName)
       (args :: [FieldDef typeName fieldName]) (name :: typeName).
NP (Field sch) args -&gt; Term sch ('DRecord name args)
</span><span class="hs-identifier hs-var">TRecord</span></span><span> </span><span class="annot"><span class="annottext">(NP (Field sch) args -&gt; Term sch ('DRecord name args))
-&gt; Either [Char] (NP (Field sch) args)
-&gt; Either [Char] (Term sch ('DRecord name args))
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;$&gt;</span></span><span> </span><span class="annot"><span class="annottext">HashMap Text Value -&gt; Either [Char] (NP (Field sch) args)
forall (sch :: Schema Symbol Symbol)
       (fs :: [FieldDef Symbol Symbol]).
FromAvroFields sch fs =&gt;
HashMap Text Value -&gt; Either [Char] (NP (Field sch) fs)
</span><a href="Mu.Adapter.Avro.html#fromAvroF"><span class="hs-identifier hs-var">fromAvroF</span></a></span><span> </span><span class="annot"><span class="annottext">HashMap Text Value
</span><a href="#local-6989586621679163034"><span class="hs-identifier hs-var">r</span></a></span><span>
</span><span id="line-213"></span><span>    </span><span class="hs-keyword">where</span><span>
</span><span id="line-214"></span><span>      </span><span id="local-6989586621679163034"><span class="annot"><span class="annottext">r :: HashMap Text Value
</span><a href="#local-6989586621679163034"><span class="hs-identifier hs-var hs-var">r</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[(Text, Value)] -&gt; HashMap Text Value
forall k v. (Eq k, Hashable k) =&gt; [(k, v)] -&gt; HashMap k v
</span><span class="hs-identifier hs-var">HM.fromList</span></span><span> </span><span class="annot"><span class="annottext">([(Text, Value)] -&gt; HashMap Text Value)
-&gt; [(Text, Value)] -&gt; HashMap Text Value
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">[Text] -&gt; [Value] -&gt; [(Text, Value)]
forall a b. [a] -&gt; [b] -&gt; [(a, b)]
</span><span class="hs-identifier hs-var">zip</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(ReadField -&gt; Text) -&gt; [ReadField] -&gt; [Text]
forall a b. (a -&gt; b) -&gt; [a] -&gt; [b]
</span><span class="hs-identifier hs-var">map</span></span><span> </span><span class="annot"><span class="annottext">ReadField -&gt; Text
</span><span class="hs-identifier hs-var hs-var">RSch.fldName</span></span><span> </span><span class="annot"><span class="annottext">[ReadField]
</span><a href="#local-6989586621679163038"><span class="hs-identifier hs-var">fs</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Vector Value -&gt; [Value]
forall a. Vector a -&gt; [a]
</span><span class="hs-identifier hs-var">V.toList</span></span><span> </span><span class="annot"><span class="annottext">Vector Value
</span><a href="#local-6989586621679163037"><span class="hs-identifier hs-var">fields</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-215"></span><span>  </span><span class="annot"><span class="hs-identifier hs-var">fromAvro</span></span><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[Char] -&gt; Either [Char] (Term sch ('DRecord name args))
forall a b. a -&gt; Either a b
</span><span class="hs-identifier hs-var">Left</span></span><span> </span><span class="annot"><span class="hs-string">&quot;expecting record&quot;</span></span></span></span></span><span>
</span><span id="line-216"></span><span id="local-6989586621679163030"><span id="local-6989586621679163031"><span id="local-6989586621679163032"><span class="hs-keyword">instance</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">KnownName</span></span><span> </span><span class="annot"><a href="#local-6989586621679163032"><span class="hs-identifier hs-type">name</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Mu.Adapter.Avro.html#FromAvroEnum"><span class="hs-identifier hs-type">FromAvroEnum</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679163031"><span class="hs-identifier hs-type">choices</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-217"></span><span>          </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">A.FromAvro</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Term</span></span><span> </span><span class="annot"><a href="#local-6989586621679163030"><span class="hs-identifier hs-type">sch</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">'</span><span class="annot"><span class="hs-identifier hs-type">DEnum</span></span><span> </span><span class="annot"><a href="#local-6989586621679163032"><span class="hs-identifier hs-type">name</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679163031"><span class="hs-identifier hs-type">choices</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-218"></span><span>  </span><span id="local-6989586621679163028"><span class="annot"><span class="annottext">fromAvro :: Value -&gt; Either [Char] (Term sch ('DEnum name choices))
</span><a href="#local-6989586621679163028"><span class="hs-identifier hs-var hs-var hs-var hs-var">fromAvro</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">AVal.Enum</span></span><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-identifier">_</span><span> </span><span id="local-6989586621679163027"><span class="annot"><span class="annottext">v :: Text
</span><a href="#local-6989586621679163027"><span class="hs-identifier hs-var">v</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">NS Proxy choices -&gt; Term sch ('DEnum name choices)
forall fieldName typeName (choices :: [ChoiceDef fieldName])
       (sch :: Schema typeName fieldName) (name :: typeName).
NS Proxy choices -&gt; Term sch ('DEnum name choices)
</span><span class="hs-identifier hs-var">TEnum</span></span><span> </span><span class="annot"><span class="annottext">(NS Proxy choices -&gt; Term sch ('DEnum name choices))
-&gt; Either [Char] (NS Proxy choices)
-&gt; Either [Char] (Term sch ('DEnum name choices))
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;$&gt;</span></span><span> </span><span class="annot"><span class="annottext">Text -&gt; Either [Char] (NS Proxy choices)
forall fn (vs :: [ChoiceDef fn]).
FromAvroEnum vs =&gt;
Text -&gt; Either [Char] (NS Proxy vs)
</span><a href="Mu.Adapter.Avro.html#fromAvroEnum"><span class="hs-identifier hs-var">fromAvroEnum</span></a></span><span> </span><span class="annot"><span class="annottext">Text
</span><a href="#local-6989586621679163027"><span class="hs-identifier hs-var">v</span></a></span><span>
</span><span id="line-219"></span><span>  </span><span class="annot"><span class="hs-identifier hs-var">fromAvro</span></span><span> </span><span class="hs-identifier">_</span><span>                 </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[Char] -&gt; Either [Char] (Term sch ('DEnum name choices))
forall a b. a -&gt; Either a b
</span><span class="hs-identifier hs-var">Left</span></span><span> </span><span class="annot"><span class="hs-string">&quot;expecting enum&quot;</span></span></span></span></span><span>
</span><span id="line-220"></span><span id="local-6989586621679163023"><span id="local-6989586621679163024"><span class="hs-keyword">instance</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">A.FromAvro</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">FieldValue</span></span><span> </span><span class="annot"><a href="#local-6989586621679163024"><span class="hs-identifier hs-type">sch</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679163023"><span class="hs-identifier hs-type">t</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-221"></span><span>         </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">A.FromAvro</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Term</span></span><span> </span><span class="annot"><a href="#local-6989586621679163024"><span class="hs-identifier hs-type">sch</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">'</span><span class="annot"><span class="hs-identifier hs-type">DSimple</span></span><span> </span><span class="annot"><a href="#local-6989586621679163023"><span class="hs-identifier hs-type">t</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-222"></span><span>  </span><span id="local-6989586621679163021"><span class="annot"><span class="annottext">fromAvro :: Value -&gt; Either [Char] (Term sch ('DSimple t))
</span><a href="#local-6989586621679163021"><span class="hs-identifier hs-var hs-var hs-var hs-var">fromAvro</span></a></span></span><span> </span><span id="local-6989586621679163020"><span class="annot"><span class="annottext">v :: Value
</span><a href="#local-6989586621679163020"><span class="hs-identifier hs-var">v</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">FieldValue sch t -&gt; Term sch ('DSimple t)
forall typeName fieldName (sch :: Schema typeName fieldName)
       (t1 :: FieldType typeName).
FieldValue sch t1 -&gt; Term sch ('DSimple t1)
</span><span class="hs-identifier hs-var">TSimple</span></span><span> </span><span class="annot"><span class="annottext">(FieldValue sch t -&gt; Term sch ('DSimple t))
-&gt; Either [Char] (FieldValue sch t)
-&gt; Either [Char] (Term sch ('DSimple t))
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;$&gt;</span></span><span> </span><span class="annot"><span class="annottext">Value -&gt; Either [Char] (FieldValue sch t)
forall a. FromAvro a =&gt; Value -&gt; Either [Char] a
</span><span class="hs-identifier hs-var">AVal.fromAvro</span></span><span> </span><span class="annot"><span class="annottext">Value
</span><a href="#local-6989586621679163020"><span class="hs-identifier hs-var">v</span></a></span></span></span><span>
</span><span id="line-223"></span><span>
</span><span id="line-224"></span><span id="local-6989586621679163018"><span class="hs-keyword">instance</span><span> </span><span class="annot"><span class="hs-identifier hs-type">A.FromAvro</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">FieldValue</span></span><span> </span><span class="annot"><a href="#local-6989586621679163018"><span class="hs-identifier hs-type">sch</span></a></span><span> </span><span class="hs-special">'</span><span class="annot"><span class="hs-identifier hs-type">TNull</span></span><span class="hs-special">)</span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-225"></span><span>  </span><span id="local-6989586621679163016"><span class="annot"><span class="annottext">fromAvro :: Value -&gt; Either [Char] (FieldValue sch 'TNull)
</span><a href="#local-6989586621679163016"><span class="hs-identifier hs-var hs-var hs-var hs-var">fromAvro</span></a></span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">AVal.Null</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">FieldValue sch 'TNull -&gt; Either [Char] (FieldValue sch 'TNull)
forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><span class="hs-identifier hs-var">pure</span></span><span> </span><span class="annot"><span class="annottext">FieldValue sch 'TNull
forall typeName fieldName (sch :: Schema typeName fieldName).
FieldValue sch 'TNull
</span><span class="hs-identifier hs-var">FNull</span></span><span>
</span><span id="line-226"></span><span>  </span><span class="annot"><span class="hs-identifier hs-var">fromAvro</span></span><span> </span><span class="hs-identifier">_</span><span>         </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[Char] -&gt; Either [Char] (FieldValue sch 'TNull)
forall a b. a -&gt; Either a b
</span><span class="hs-identifier hs-var">Left</span></span><span> </span><span class="annot"><span class="hs-string">&quot;expecting null&quot;</span></span></span><span>
</span><span id="line-227"></span><span id="local-6989586621679163013"><span id="local-6989586621679163014"><span class="hs-keyword">instance</span><span> </span><span class="annot"><span class="hs-identifier hs-type">A.FromAvro</span></span><span> </span><span class="annot"><a href="#local-6989586621679163014"><span class="hs-identifier hs-type">t</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">A.FromAvro</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">FieldValue</span></span><span> </span><span class="annot"><a href="#local-6989586621679163013"><span class="hs-identifier hs-type">sch</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">'</span><span class="annot"><span class="hs-identifier hs-type">TPrimitive</span></span><span> </span><span class="annot"><a href="#local-6989586621679163014"><span class="hs-identifier hs-type">t</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-228"></span><span>  </span><span id="local-6989586621679163011"><span class="annot"><span class="annottext">fromAvro :: Value -&gt; Either [Char] (FieldValue sch ('TPrimitive t))
</span><a href="#local-6989586621679163011"><span class="hs-identifier hs-var hs-var hs-var hs-var">fromAvro</span></a></span></span><span> </span><span id="local-6989586621679163010"><span class="annot"><span class="annottext">v :: Value
</span><a href="#local-6989586621679163010"><span class="hs-identifier hs-var">v</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">t -&gt; FieldValue sch ('TPrimitive t)
forall typeName fieldName t1 (sch :: Schema typeName fieldName).
t1 -&gt; FieldValue sch ('TPrimitive t1)
</span><span class="hs-identifier hs-var">FPrimitive</span></span><span> </span><span class="annot"><span class="annottext">(t -&gt; FieldValue sch ('TPrimitive t))
-&gt; Either [Char] t
-&gt; Either [Char] (FieldValue sch ('TPrimitive t))
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;$&gt;</span></span><span> </span><span class="annot"><span class="annottext">Value -&gt; Either [Char] t
forall a. FromAvro a =&gt; Value -&gt; Either [Char] a
</span><span class="hs-identifier hs-var">AVal.fromAvro</span></span><span> </span><span class="annot"><span class="annottext">Value
</span><a href="#local-6989586621679163010"><span class="hs-identifier hs-var">v</span></a></span></span></span><span>
</span><span id="line-229"></span><span id="local-6989586621679163007"><span id="local-6989586621679163008"><span class="hs-keyword">instance</span><span> </span><span class="hs-special">(</span><span> </span><span class="annot"><span class="hs-identifier hs-type">KnownName</span></span><span> </span><span class="annot"><a href="#local-6989586621679163008"><span class="hs-identifier hs-type">t</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">A.FromAvro</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Term</span></span><span> </span><span class="annot"><a href="#local-6989586621679163007"><span class="hs-identifier hs-type">sch</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679163007"><span class="hs-identifier hs-type">sch</span></a></span><span> </span><span class="annot"><span class="hs-operator hs-type">:/:</span></span><span> </span><span class="annot"><a href="#local-6989586621679163008"><span class="hs-identifier hs-type">t</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-special">)</span><span>
</span><span id="line-230"></span><span>         </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">A.FromAvro</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">FieldValue</span></span><span> </span><span class="annot"><a href="#local-6989586621679163007"><span class="hs-identifier hs-type">sch</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">'</span><span class="annot"><span class="hs-identifier hs-type">TSchematic</span></span><span> </span><span class="annot"><a href="#local-6989586621679163008"><span class="hs-identifier hs-type">t</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-231"></span><span>  </span><span id="local-6989586621679163005"><span class="annot"><span class="annottext">fromAvro :: Value -&gt; Either [Char] (FieldValue sch ('TSchematic t))
</span><a href="#local-6989586621679163005"><span class="hs-identifier hs-var hs-var hs-var hs-var">fromAvro</span></a></span></span><span> </span><span id="local-6989586621679163004"><span class="annot"><span class="annottext">v :: Value
</span><a href="#local-6989586621679163004"><span class="hs-identifier hs-var">v</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Term sch (sch :/: t) -&gt; FieldValue sch ('TSchematic t)
forall typeName fieldName (sch :: Schema typeName fieldName)
       (t1 :: typeName).
Term sch (sch :/: t1) -&gt; FieldValue sch ('TSchematic t1)
</span><span class="hs-identifier hs-var">FSchematic</span></span><span> </span><span class="annot"><span class="annottext">(Term sch (sch :/: t) -&gt; FieldValue sch ('TSchematic t))
-&gt; Either [Char] (Term sch (sch :/: t))
-&gt; Either [Char] (FieldValue sch ('TSchematic t))
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;$&gt;</span></span><span> </span><span class="annot"><span class="annottext">Value -&gt; Either [Char] (Term sch (sch :/: t))
forall a. FromAvro a =&gt; Value -&gt; Either [Char] a
</span><span class="hs-identifier hs-var">AVal.fromAvro</span></span><span> </span><span class="annot"><span class="annottext">Value
</span><a href="#local-6989586621679163004"><span class="hs-identifier hs-var">v</span></a></span></span></span><span>
</span><span id="line-232"></span><span id="local-6989586621679163001"><span id="local-6989586621679163002"><span class="hs-keyword">instance</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Mu.Adapter.Avro.html#FromAvroUnion"><span class="hs-identifier hs-type">FromAvroUnion</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679163002"><span class="hs-identifier hs-type">sch</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679163001"><span class="hs-identifier hs-type">choices</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-233"></span><span>         </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">A.FromAvro</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">FieldValue</span></span><span> </span><span class="annot"><a href="#local-6989586621679163002"><span class="hs-identifier hs-type">sch</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">'</span><span class="annot"><span class="hs-identifier hs-type">TUnion</span></span><span> </span><span class="annot"><a href="#local-6989586621679163001"><span class="hs-identifier hs-type">choices</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-234"></span><span>  </span><span id="local-6989586621679162999"><span class="annot"><span class="annottext">fromAvro :: Value -&gt; Either [Char] (FieldValue sch ('TUnion choices))
</span><a href="#local-6989586621679162999"><span class="hs-identifier hs-var hs-var hs-var hs-var">fromAvro</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">AVal.Union</span></span><span> </span><span class="hs-identifier">_</span><span> </span><span id="local-6989586621679162998"><span class="annot"><span class="annottext">i :: Int
</span><a href="#local-6989586621679162998"><span class="hs-identifier hs-var">i</span></a></span></span><span> </span><span id="local-6989586621679162997"><span class="annot"><span class="annottext">v :: Value
</span><a href="#local-6989586621679162997"><span class="hs-identifier hs-var">v</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">NS (FieldValue sch) choices -&gt; FieldValue sch ('TUnion choices)
forall typeName fieldName (sch :: Schema typeName fieldName)
       (choices :: [FieldType typeName]).
NS (FieldValue sch) choices -&gt; FieldValue sch ('TUnion choices)
</span><span class="hs-identifier hs-var">FUnion</span></span><span> </span><span class="annot"><span class="annottext">(NS (FieldValue sch) choices -&gt; FieldValue sch ('TUnion choices))
-&gt; Either [Char] (NS (FieldValue sch) choices)
-&gt; Either [Char] (FieldValue sch ('TUnion choices))
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;$&gt;</span></span><span> </span><span class="annot"><span class="annottext">Int -&gt; Value -&gt; Either [Char] (NS (FieldValue sch) choices)
forall typeName fieldName (sch :: Schema typeName fieldName)
       (choices :: [FieldType typeName]).
FromAvroUnion sch choices =&gt;
Int -&gt; Value -&gt; Either [Char] (NS (FieldValue sch) choices)
</span><a href="Mu.Adapter.Avro.html#fromAvroU"><span class="hs-identifier hs-var">fromAvroU</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679162998"><span class="hs-identifier hs-var">i</span></a></span><span> </span><span class="annot"><span class="annottext">Value
</span><a href="#local-6989586621679162997"><span class="hs-identifier hs-var">v</span></a></span><span>
</span><span id="line-235"></span><span>  </span><span class="annot"><span class="hs-identifier hs-var">fromAvro</span></span><span> </span><span class="hs-identifier">_</span><span>                  </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[Char] -&gt; Either [Char] (FieldValue sch ('TUnion choices))
forall a b. a -&gt; Either a b
</span><span class="hs-identifier hs-var">Left</span></span><span> </span><span class="annot"><span class="hs-string">&quot;expecting union&quot;</span></span></span></span><span>
</span><span id="line-236"></span><span id="local-6989586621679162993"><span id="local-6989586621679162994"><span class="hs-keyword">instance</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">A.FromAvro</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">FieldValue</span></span><span> </span><span class="annot"><a href="#local-6989586621679162994"><span class="hs-identifier hs-type">sch</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679162993"><span class="hs-identifier hs-type">t</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-237"></span><span>         </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">A.FromAvro</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">FieldValue</span></span><span> </span><span class="annot"><a href="#local-6989586621679162994"><span class="hs-identifier hs-type">sch</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">'</span><span class="annot"><span class="hs-identifier hs-type">TOption</span></span><span> </span><span class="annot"><a href="#local-6989586621679162993"><span class="hs-identifier hs-type">t</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-238"></span><span>  </span><span id="local-6989586621679162991"><span class="annot"><span class="annottext">fromAvro :: Value -&gt; Either [Char] (FieldValue sch ('TOption t))
</span><a href="#local-6989586621679162991"><span class="hs-identifier hs-var hs-var hs-var hs-var">fromAvro</span></a></span></span><span> </span><span id="local-6989586621679162990"><span class="annot"><span class="annottext">v :: Value
</span><a href="#local-6989586621679162990"><span class="hs-identifier hs-var">v</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Maybe (FieldValue sch t) -&gt; FieldValue sch ('TOption t)
forall typeName fieldName (sch :: Schema typeName fieldName)
       (t1 :: FieldType typeName).
Maybe (FieldValue sch t1) -&gt; FieldValue sch ('TOption t1)
</span><span class="hs-identifier hs-var">FOption</span></span><span> </span><span class="annot"><span class="annottext">(Maybe (FieldValue sch t) -&gt; FieldValue sch ('TOption t))
-&gt; Either [Char] (Maybe (FieldValue sch t))
-&gt; Either [Char] (FieldValue sch ('TOption t))
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;$&gt;</span></span><span> </span><span class="annot"><span class="annottext">Value -&gt; Either [Char] (Maybe (FieldValue sch t))
forall a. FromAvro a =&gt; Value -&gt; Either [Char] a
</span><span class="hs-identifier hs-var">AVal.fromAvro</span></span><span> </span><span class="annot"><span class="annottext">Value
</span><a href="#local-6989586621679162990"><span class="hs-identifier hs-var">v</span></a></span></span></span><span>
</span><span id="line-239"></span><span id="local-6989586621679162987"><span id="local-6989586621679162988"><span class="hs-keyword">instance</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">A.FromAvro</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">FieldValue</span></span><span> </span><span class="annot"><a href="#local-6989586621679162988"><span class="hs-identifier hs-type">sch</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679162987"><span class="hs-identifier hs-type">t</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-240"></span><span>         </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">A.FromAvro</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">FieldValue</span></span><span> </span><span class="annot"><a href="#local-6989586621679162988"><span class="hs-identifier hs-type">sch</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">'</span><span class="annot"><span class="hs-identifier hs-type">TList</span></span><span> </span><span class="annot"><a href="#local-6989586621679162987"><span class="hs-identifier hs-type">t</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-241"></span><span>  </span><span id="local-6989586621679162985"><span class="annot"><span class="annottext">fromAvro :: Value -&gt; Either [Char] (FieldValue sch ('TList t))
</span><a href="#local-6989586621679162985"><span class="hs-identifier hs-var hs-var hs-var hs-var">fromAvro</span></a></span></span><span> </span><span id="local-6989586621679162984"><span class="annot"><span class="annottext">v :: Value
</span><a href="#local-6989586621679162984"><span class="hs-identifier hs-var">v</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[FieldValue sch t] -&gt; FieldValue sch ('TList t)
forall typeName fieldName (sch :: Schema typeName fieldName)
       (t1 :: FieldType typeName).
[FieldValue sch t1] -&gt; FieldValue sch ('TList t1)
</span><span class="hs-identifier hs-var">FList</span></span><span> </span><span class="annot"><span class="annottext">([FieldValue sch t] -&gt; FieldValue sch ('TList t))
-&gt; Either [Char] [FieldValue sch t]
-&gt; Either [Char] (FieldValue sch ('TList t))
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;$&gt;</span></span><span> </span><span class="annot"><span class="annottext">Value -&gt; Either [Char] [FieldValue sch t]
forall a. FromAvro a =&gt; Value -&gt; Either [Char] a
</span><span class="hs-identifier hs-var">AVal.fromAvro</span></span><span> </span><span class="annot"><span class="annottext">Value
</span><a href="#local-6989586621679162984"><span class="hs-identifier hs-var">v</span></a></span></span></span><span>
</span><span id="line-242"></span><span class="hs-comment">-- These are the only two versions of Map supported by the library</span><span>
</span><span id="line-243"></span><span id="local-6989586621679162981"><span id="local-6989586621679162982"><span class="hs-keyword">instance</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">A.FromAvro</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">FieldValue</span></span><span> </span><span class="annot"><a href="#local-6989586621679162982"><span class="hs-identifier hs-type">sch</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679162981"><span class="hs-identifier hs-type">v</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-244"></span><span>         </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">A.FromAvro</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">FieldValue</span></span><span> </span><span class="annot"><a href="#local-6989586621679162982"><span class="hs-identifier hs-type">sch</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">'</span><span class="annot"><span class="hs-identifier hs-type">TMap</span></span><span> </span><span class="hs-special">(</span><span class="hs-special">'</span><span class="annot"><span class="hs-identifier hs-type">TPrimitive</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">T.Text</span></span><span class="hs-special">)</span><span> </span><span class="annot"><a href="#local-6989586621679162981"><span class="hs-identifier hs-type">v</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-245"></span><span>  </span><span id="local-6989586621679162979"><span class="annot"><span class="annottext">fromAvro :: Value
-&gt; Either [Char] (FieldValue sch ('TMap ('TPrimitive Text) v))
</span><a href="#local-6989586621679162979"><span class="hs-identifier hs-var hs-var hs-var hs-var">fromAvro</span></a></span></span><span> </span><span id="local-6989586621679162978"><span class="annot"><span class="annottext">v :: Value
</span><a href="#local-6989586621679162978"><span class="hs-identifier hs-var">v</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Map (FieldValue sch ('TPrimitive Text)) (FieldValue sch v)
-&gt; FieldValue sch ('TMap ('TPrimitive Text) v)
forall typeName fieldName (sch :: Schema typeName fieldName)
       (k :: FieldType typeName) (v :: FieldType typeName).
Ord (FieldValue sch k) =&gt;
Map (FieldValue sch k) (FieldValue sch v)
-&gt; FieldValue sch ('TMap k v)
</span><span class="hs-identifier hs-var">FMap</span></span><span> </span><span class="annot"><span class="annottext">(Map (FieldValue sch ('TPrimitive Text)) (FieldValue sch v)
 -&gt; FieldValue sch ('TMap ('TPrimitive Text) v))
-&gt; (Map Text (FieldValue sch v)
    -&gt; Map (FieldValue sch ('TPrimitive Text)) (FieldValue sch v))
-&gt; Map Text (FieldValue sch v)
-&gt; FieldValue sch ('TMap ('TPrimitive Text) v)
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">(Text -&gt; FieldValue sch ('TPrimitive Text))
-&gt; Map Text (FieldValue sch v)
-&gt; Map (FieldValue sch ('TPrimitive Text)) (FieldValue sch v)
forall k2 k1 a. Ord k2 =&gt; (k1 -&gt; k2) -&gt; Map k1 a -&gt; Map k2 a
</span><span class="hs-identifier hs-var">M.mapKeys</span></span><span> </span><span class="annot"><span class="annottext">Text -&gt; FieldValue sch ('TPrimitive Text)
forall typeName fieldName t1 (sch :: Schema typeName fieldName).
t1 -&gt; FieldValue sch ('TPrimitive t1)
</span><span class="hs-identifier hs-var">FPrimitive</span></span><span> </span><span class="annot"><span class="annottext">(Map Text (FieldValue sch v)
 -&gt; FieldValue sch ('TMap ('TPrimitive Text) v))
-&gt; Either [Char] (Map Text (FieldValue sch v))
-&gt; Either [Char] (FieldValue sch ('TMap ('TPrimitive Text) v))
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;$&gt;</span></span><span> </span><span class="annot"><span class="annottext">Value -&gt; Either [Char] (Map Text (FieldValue sch v))
forall a. FromAvro a =&gt; Value -&gt; Either [Char] a
</span><span class="hs-identifier hs-var">AVal.fromAvro</span></span><span> </span><span class="annot"><span class="annottext">Value
</span><a href="#local-6989586621679162978"><span class="hs-identifier hs-var">v</span></a></span></span></span><span>
</span><span id="line-246"></span><span id="local-6989586621679162974"><span id="local-6989586621679162975"><span class="hs-keyword">instance</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">A.FromAvro</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">FieldValue</span></span><span> </span><span class="annot"><a href="#local-6989586621679162975"><span class="hs-identifier hs-type">sch</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679162974"><span class="hs-identifier hs-type">v</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-247"></span><span>         </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">A.FromAvro</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">FieldValue</span></span><span> </span><span class="annot"><a href="#local-6989586621679162975"><span class="hs-identifier hs-type">sch</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">'</span><span class="annot"><span class="hs-identifier hs-type">TMap</span></span><span> </span><span class="hs-special">(</span><span class="hs-special">'</span><span class="annot"><span class="hs-identifier hs-type">TPrimitive</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">String</span></span><span class="hs-special">)</span><span> </span><span class="annot"><a href="#local-6989586621679162974"><span class="hs-identifier hs-type">v</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-248"></span><span>  </span><span id="local-6989586621679162972"><span class="annot"><span class="annottext">fromAvro :: Value
-&gt; Either [Char] (FieldValue sch ('TMap ('TPrimitive [Char]) v))
</span><a href="#local-6989586621679162972"><span class="hs-identifier hs-var hs-var hs-var hs-var">fromAvro</span></a></span></span><span> </span><span id="local-6989586621679162971"><span class="annot"><span class="annottext">v :: Value
</span><a href="#local-6989586621679162971"><span class="hs-identifier hs-var">v</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Map (FieldValue sch ('TPrimitive [Char])) (FieldValue sch v)
-&gt; FieldValue sch ('TMap ('TPrimitive [Char]) v)
forall typeName fieldName (sch :: Schema typeName fieldName)
       (k :: FieldType typeName) (v :: FieldType typeName).
Ord (FieldValue sch k) =&gt;
Map (FieldValue sch k) (FieldValue sch v)
-&gt; FieldValue sch ('TMap k v)
</span><span class="hs-identifier hs-var">FMap</span></span><span> </span><span class="annot"><span class="annottext">(Map (FieldValue sch ('TPrimitive [Char])) (FieldValue sch v)
 -&gt; FieldValue sch ('TMap ('TPrimitive [Char]) v))
-&gt; (Map Text (FieldValue sch v)
    -&gt; Map (FieldValue sch ('TPrimitive [Char])) (FieldValue sch v))
-&gt; Map Text (FieldValue sch v)
-&gt; FieldValue sch ('TMap ('TPrimitive [Char]) v)
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">(Text -&gt; FieldValue sch ('TPrimitive [Char]))
-&gt; Map Text (FieldValue sch v)
-&gt; Map (FieldValue sch ('TPrimitive [Char])) (FieldValue sch v)
forall k2 k1 a. Ord k2 =&gt; (k1 -&gt; k2) -&gt; Map k1 a -&gt; Map k2 a
</span><span class="hs-identifier hs-var">M.mapKeys</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[Char] -&gt; FieldValue sch ('TPrimitive [Char])
forall typeName fieldName t1 (sch :: Schema typeName fieldName).
t1 -&gt; FieldValue sch ('TPrimitive t1)
</span><span class="hs-identifier hs-var">FPrimitive</span></span><span> </span><span class="annot"><span class="annottext">([Char] -&gt; FieldValue sch ('TPrimitive [Char]))
-&gt; (Text -&gt; [Char]) -&gt; Text -&gt; FieldValue sch ('TPrimitive [Char])
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">Text -&gt; [Char]
</span><span class="hs-identifier hs-var">T.unpack</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">(Map Text (FieldValue sch v)
 -&gt; FieldValue sch ('TMap ('TPrimitive [Char]) v))
-&gt; Either [Char] (Map Text (FieldValue sch v))
-&gt; Either [Char] (FieldValue sch ('TMap ('TPrimitive [Char]) v))
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;$&gt;</span></span><span> </span><span class="annot"><span class="annottext">Value -&gt; Either [Char] (Map Text (FieldValue sch v))
forall a. FromAvro a =&gt; Value -&gt; Either [Char] a
</span><span class="hs-identifier hs-var">AVal.fromAvro</span></span><span> </span><span class="annot"><span class="annottext">Value
</span><a href="#local-6989586621679162971"><span class="hs-identifier hs-var">v</span></a></span></span></span><span>
</span><span id="line-249"></span><span>
</span><span id="line-250"></span><span class="hs-keyword">class</span><span> </span><span id="FromAvroEnum"><span class="annot"><a href="Mu.Adapter.Avro.html#FromAvroEnum"><span class="hs-identifier hs-var">FromAvroEnum</span></a></span></span><span> </span><span class="hs-special">(</span><span id="local-6989586621679163464"><span class="annot"><a href="#local-6989586621679163464"><span class="hs-identifier hs-type">vs</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">[</span><span class="annot"><span class="hs-identifier hs-type">ChoiceDef</span></span><span> </span><span id="local-6989586621679163465"><span class="annot"><a href="#local-6989586621679163465"><span class="hs-identifier hs-type hs-type">fn</span></a></span></span><span class="hs-special">]</span><span class="hs-special">)</span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-251"></span><span>  </span><span id="fromAvroEnum"><span class="annot"><a href="Mu.Adapter.Avro.html#fromAvroEnum"><span class="hs-identifier hs-type">fromAvroEnum</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">T.Text</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Either</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">String</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">NS</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Proxy</span></span><span> </span><span class="annot"><a href="#local-6989586621679163464"><span class="hs-identifier hs-type">vs</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-252"></span><span class="hs-keyword">instance</span><span> </span><span class="annot"><a href="Mu.Adapter.Avro.html#FromAvroEnum"><span class="hs-identifier hs-type">FromAvroEnum</span></a></span><span> </span><span class="hs-special">'</span><span class="hs-special">[</span><span class="hs-special">]</span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-253"></span><span>  </span><span id="local-6989586621679162967"><span class="annot"><span class="annottext">fromAvroEnum :: Text -&gt; Either [Char] (NS Proxy '[])
</span><a href="#local-6989586621679162967"><span class="hs-identifier hs-var hs-var hs-var hs-var">fromAvroEnum</span></a></span></span><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[Char] -&gt; Either [Char] (NS Proxy '[])
forall a b. a -&gt; Either a b
</span><span class="hs-identifier hs-var">Left</span></span><span> </span><span class="annot"><span class="hs-string">&quot;enum choice not found&quot;</span></span><span>
</span><span id="line-254"></span><span id="local-6989586621679162965"><span id="local-6989586621679162966"><span class="hs-keyword">instance</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">KnownName</span></span><span> </span><span class="annot"><a href="#local-6989586621679162966"><span class="hs-identifier hs-type">name</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Mu.Adapter.Avro.html#FromAvroEnum"><span class="hs-identifier hs-type">FromAvroEnum</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679162965"><span class="hs-identifier hs-type">vs</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-255"></span><span>         </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="Mu.Adapter.Avro.html#FromAvroEnum"><span class="hs-identifier hs-type">FromAvroEnum</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">'</span><span class="annot"><span class="hs-identifier hs-type">ChoiceDef</span></span><span> </span><span class="annot"><a href="#local-6989586621679162966"><span class="hs-identifier hs-type">name</span></a></span><span> </span><span class="hs-special">'</span><span class="hs-glyph">:</span><span> </span><span class="annot"><a href="#local-6989586621679162965"><span class="hs-identifier hs-type">vs</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-256"></span><span>  </span><span id="local-6989586621679162963"><span class="annot"><span class="annottext">fromAvroEnum :: Text -&gt; Either [Char] (NS Proxy ('ChoiceDef name : vs))
</span><a href="#local-6989586621679162963"><span class="hs-identifier hs-var hs-var hs-var hs-var">fromAvroEnum</span></a></span></span><span> </span><span id="local-6989586621679162962"><span class="annot"><span class="annottext">s :: Text
</span><a href="#local-6989586621679162962"><span class="hs-identifier hs-var">s</span></a></span></span><span>
</span><span id="line-257"></span><span>    </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Text
</span><a href="#local-6989586621679162962"><span class="hs-identifier hs-var">s</span></a></span><span> </span><span class="annot"><span class="annottext">Text -&gt; Text -&gt; Bool
forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">==</span></span><span> </span><span class="annot"><span class="annottext">Text
</span><a href="#local-6989586621679162961"><span class="hs-identifier hs-var">fieldName</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">NS Proxy ('ChoiceDef name : vs)
-&gt; Either [Char] (NS Proxy ('ChoiceDef name : vs))
forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><span class="hs-identifier hs-var">pure</span></span><span> </span><span class="annot"><span class="annottext">(NS Proxy ('ChoiceDef name : vs)
 -&gt; Either [Char] (NS Proxy ('ChoiceDef name : vs)))
-&gt; NS Proxy ('ChoiceDef name : vs)
-&gt; Either [Char] (NS Proxy ('ChoiceDef name : vs))
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Proxy ('ChoiceDef name) -&gt; NS Proxy ('ChoiceDef name : vs)
forall k (a :: k -&gt; *) (x :: k) (xs :: [k]). a x -&gt; NS a (x : xs)
</span><span class="hs-identifier hs-var">Z</span></span><span> </span><span class="annot"><span class="annottext">Proxy ('ChoiceDef name)
forall k (t :: k). Proxy t
</span><span class="hs-identifier hs-var">Proxy</span></span><span>
</span><span id="line-258"></span><span>    </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">otherwise</span></span><span>      </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">NS Proxy vs -&gt; NS Proxy ('ChoiceDef name : vs)
forall k (a :: k -&gt; *) (xs :: [k]) (x :: k).
NS a xs -&gt; NS a (x : xs)
</span><span class="hs-identifier hs-var">S</span></span><span> </span><span class="annot"><span class="annottext">(NS Proxy vs -&gt; NS Proxy ('ChoiceDef name : vs))
-&gt; Either [Char] (NS Proxy vs)
-&gt; Either [Char] (NS Proxy ('ChoiceDef name : vs))
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;$&gt;</span></span><span> </span><span class="annot"><span class="annottext">Text -&gt; Either [Char] (NS Proxy vs)
forall fn (vs :: [ChoiceDef fn]).
FromAvroEnum vs =&gt;
Text -&gt; Either [Char] (NS Proxy vs)
</span><a href="Mu.Adapter.Avro.html#fromAvroEnum"><span class="hs-identifier hs-var">fromAvroEnum</span></a></span><span> </span><span class="annot"><span class="annottext">Text
</span><a href="#local-6989586621679162962"><span class="hs-identifier hs-var">s</span></a></span><span>
</span><span id="line-259"></span><span>    </span><span class="hs-keyword">where</span><span> </span><span id="local-6989586621679162961"><span class="annot"><span class="annottext">fieldName :: Text
</span><a href="#local-6989586621679162961"><span class="hs-identifier hs-var hs-var">fieldName</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Proxy name -&gt; Text
forall k (s :: k) (proxy :: k -&gt; *). KnownName s =&gt; proxy s -&gt; Text
</span><a href="Mu.Adapter.Avro.html#nameText"><span class="hs-identifier hs-var">nameText</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Proxy name
forall k (t :: k). Proxy t
</span><span class="hs-identifier hs-var">Proxy</span></span><span> </span><span class="hs-glyph">@</span><span class="annot"><a href="#local-6989586621679162966"><span class="hs-identifier hs-type">name</span></a></span><span class="hs-special">)</span></span></span><span>
</span><span id="line-260"></span><span>
</span><span id="line-261"></span><span class="hs-keyword">class</span><span> </span><span id="FromAvroUnion"><span class="annot"><a href="Mu.Adapter.Avro.html#FromAvroUnion"><span class="hs-identifier hs-var">FromAvroUnion</span></a></span></span><span> </span><span id="local-6989586621679163434"><span class="annot"><a href="#local-6989586621679163434"><span class="hs-identifier hs-type">sch</span></a></span></span><span> </span><span id="local-6989586621679163433"><span class="annot"><a href="#local-6989586621679163433"><span class="hs-identifier hs-type">choices</span></a></span></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-262"></span><span>  </span><span id="fromAvroU"><span class="annot"><a href="Mu.Adapter.Avro.html#fromAvroU"><span class="hs-identifier hs-type">fromAvroU</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Int</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">AVal.Value</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Either</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">String</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">NS</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">FieldValue</span></span><span> </span><span class="annot"><a href="#local-6989586621679163434"><span class="hs-identifier hs-type">sch</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><a href="#local-6989586621679163433"><span class="hs-identifier hs-type">choices</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-263"></span><span id="local-6989586621679162958"><span class="hs-keyword">instance</span><span> </span><span class="annot"><a href="Mu.Adapter.Avro.html#FromAvroUnion"><span class="hs-identifier hs-type">FromAvroUnion</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679162958"><span class="hs-identifier hs-type">sch</span></a></span><span> </span><span class="hs-special">'</span><span class="hs-special">[</span><span class="hs-special">]</span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-264"></span><span>  </span><span id="local-6989586621679162955"><span class="annot"><span class="annottext">fromAvroU :: Int -&gt; Value -&gt; Either [Char] (NS (FieldValue sch) '[])
</span><a href="#local-6989586621679162955"><span class="hs-identifier hs-var hs-var hs-var hs-var">fromAvroU</span></a></span></span><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[Char] -&gt; Either [Char] (NS (FieldValue sch) '[])
forall a b. a -&gt; Either a b
</span><span class="hs-identifier hs-var">Left</span></span><span> </span><span class="annot"><span class="hs-string">&quot;union choice not found&quot;</span></span></span><span>
</span><span id="line-265"></span><span id="local-6989586621679162952"><span id="local-6989586621679162953"><span id="local-6989586621679162954"><span class="hs-keyword">instance</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">A.FromAvro</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">FieldValue</span></span><span> </span><span class="annot"><a href="#local-6989586621679162954"><span class="hs-identifier hs-type">sch</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679162953"><span class="hs-identifier hs-type">u</span></a></span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Mu.Adapter.Avro.html#FromAvroUnion"><span class="hs-identifier hs-type">FromAvroUnion</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679162954"><span class="hs-identifier hs-type">sch</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679162952"><span class="hs-identifier hs-type">us</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-266"></span><span>         </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="Mu.Adapter.Avro.html#FromAvroUnion"><span class="hs-identifier hs-type">FromAvroUnion</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679162954"><span class="hs-identifier hs-type">sch</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679162953"><span class="hs-identifier hs-type">u</span></a></span><span> </span><span class="hs-special">'</span><span class="hs-glyph">:</span><span> </span><span class="annot"><a href="#local-6989586621679162952"><span class="hs-identifier hs-type">us</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-267"></span><span>  </span><span id="local-6989586621679162950"><span class="annot"><span class="annottext">fromAvroU :: Int -&gt; Value -&gt; Either [Char] (NS (FieldValue sch) (u : us))
</span><a href="#local-6989586621679162950"><span class="hs-identifier hs-var hs-var hs-var hs-var">fromAvroU</span></a></span></span><span> </span><span class="hs-number">0</span><span> </span><span id="local-6989586621679162949"><span class="annot"><span class="annottext">v :: Value
</span><a href="#local-6989586621679162949"><span class="hs-identifier hs-var">v</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">FieldValue sch u -&gt; NS (FieldValue sch) (u : us)
forall k (a :: k -&gt; *) (x :: k) (xs :: [k]). a x -&gt; NS a (x : xs)
</span><span class="hs-identifier hs-var">Z</span></span><span> </span><span class="annot"><span class="annottext">(FieldValue sch u -&gt; NS (FieldValue sch) (u : us))
-&gt; Either [Char] (FieldValue sch u)
-&gt; Either [Char] (NS (FieldValue sch) (u : us))
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;$&gt;</span></span><span> </span><span class="annot"><span class="annottext">Value -&gt; Either [Char] (FieldValue sch u)
forall a. FromAvro a =&gt; Value -&gt; Either [Char] a
</span><span class="hs-identifier hs-var">AVal.fromAvro</span></span><span> </span><span class="annot"><span class="annottext">Value
</span><a href="#local-6989586621679162949"><span class="hs-identifier hs-var">v</span></a></span><span>
</span><span id="line-268"></span><span>  </span><span class="annot"><a href="Mu.Adapter.Avro.html#fromAvroU"><span class="hs-identifier hs-var">fromAvroU</span></a></span><span> </span><span id="local-6989586621679162948"><span class="annot"><span class="annottext">n :: Int
</span><a href="#local-6989586621679162948"><span class="hs-identifier hs-var">n</span></a></span></span><span> </span><span id="local-6989586621679162947"><span class="annot"><span class="annottext">v :: Value
</span><a href="#local-6989586621679162947"><span class="hs-identifier hs-var">v</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">NS (FieldValue sch) us -&gt; NS (FieldValue sch) (u : us)
forall k (a :: k -&gt; *) (xs :: [k]) (x :: k).
NS a xs -&gt; NS a (x : xs)
</span><span class="hs-identifier hs-var">S</span></span><span> </span><span class="annot"><span class="annottext">(NS (FieldValue sch) us -&gt; NS (FieldValue sch) (u : us))
-&gt; Either [Char] (NS (FieldValue sch) us)
-&gt; Either [Char] (NS (FieldValue sch) (u : us))
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;$&gt;</span></span><span> </span><span class="annot"><span class="annottext">Int -&gt; Value -&gt; Either [Char] (NS (FieldValue sch) us)
forall typeName fieldName (sch :: Schema typeName fieldName)
       (choices :: [FieldType typeName]).
FromAvroUnion sch choices =&gt;
Int -&gt; Value -&gt; Either [Char] (NS (FieldValue sch) choices)
</span><a href="Mu.Adapter.Avro.html#fromAvroU"><span class="hs-identifier hs-var">fromAvroU</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679162948"><span class="hs-identifier hs-var">n</span></a></span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Int
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-glyph hs-var">-</span></span><span class="annot"><span class="hs-number">1</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Value
</span><a href="#local-6989586621679162947"><span class="hs-identifier hs-var">v</span></a></span></span></span></span><span>
</span><span id="line-269"></span><span>
</span><span id="line-270"></span><span class="hs-keyword">class</span><span> </span><span id="FromAvroFields"><span class="annot"><a href="Mu.Adapter.Avro.html#FromAvroFields"><span class="hs-identifier hs-var">FromAvroFields</span></a></span></span><span> </span><span id="local-6989586621679163483"><span class="annot"><a href="#local-6989586621679163483"><span class="hs-identifier hs-type">sch</span></a></span></span><span> </span><span class="hs-special">(</span><span id="local-6989586621679163482"><span class="annot"><a href="#local-6989586621679163482"><span class="hs-identifier hs-type">fs</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">[</span><span class="annot"><span class="hs-identifier hs-type">FieldDef</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Symbol</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Symbol</span></span><span class="hs-special">]</span><span class="hs-special">)</span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-271"></span><span>  </span><span id="fromAvroF"><span class="annot"><a href="Mu.Adapter.Avro.html#fromAvroF"><span class="hs-identifier hs-type">fromAvroF</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">HM.HashMap</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">T.Text</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">AVal.Value</span></span><span>
</span><span id="line-272"></span><span>            </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Either</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">String</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">NP</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Field</span></span><span> </span><span class="annot"><a href="#local-6989586621679163483"><span class="hs-identifier hs-type">sch</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><a href="#local-6989586621679163482"><span class="hs-identifier hs-type">fs</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-273"></span><span id="local-6989586621679162946"><span class="hs-keyword">instance</span><span> </span><span class="annot"><a href="Mu.Adapter.Avro.html#FromAvroFields"><span class="hs-identifier hs-type">FromAvroFields</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679162946"><span class="hs-identifier hs-type">sch</span></a></span><span> </span><span class="hs-special">'</span><span class="hs-special">[</span><span class="hs-special">]</span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-274"></span><span>  </span><span id="local-6989586621679162943"><span class="annot"><span class="annottext">fromAvroF :: HashMap Text Value -&gt; Either [Char] (NP (Field sch) '[])
</span><a href="#local-6989586621679162943"><span class="hs-identifier hs-var hs-var hs-var hs-var">fromAvroF</span></a></span></span><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">NP (Field sch) '[] -&gt; Either [Char] (NP (Field sch) '[])
forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><span class="hs-identifier hs-var">pure</span></span><span> </span><span class="annot"><span class="annottext">NP (Field sch) '[]
forall k (a :: k -&gt; *). NP a '[]
</span><span class="hs-identifier hs-var">Nil</span></span></span><span>
</span><span id="line-275"></span><span id="local-6989586621679162938"><span id="local-6989586621679162939"><span id="local-6989586621679162940"><span id="local-6989586621679162941"><span class="hs-keyword">instance</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">KnownName</span></span><span> </span><span class="annot"><a href="#local-6989586621679162941"><span class="hs-identifier hs-type">name</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">A.FromAvro</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">FieldValue</span></span><span> </span><span class="annot"><a href="#local-6989586621679162940"><span class="hs-identifier hs-type">sch</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679162939"><span class="hs-identifier hs-type">t</span></a></span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Mu.Adapter.Avro.html#FromAvroFields"><span class="hs-identifier hs-type">FromAvroFields</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679162940"><span class="hs-identifier hs-type">sch</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679162938"><span class="hs-identifier hs-type">fs</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-276"></span><span>         </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="Mu.Adapter.Avro.html#FromAvroFields"><span class="hs-identifier hs-type">FromAvroFields</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679162940"><span class="hs-identifier hs-type">sch</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">'</span><span class="annot"><span class="hs-identifier hs-type">FieldDef</span></span><span> </span><span class="annot"><a href="#local-6989586621679162941"><span class="hs-identifier hs-type">name</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679162939"><span class="hs-identifier hs-type">t</span></a></span><span> </span><span class="hs-special">'</span><span class="hs-glyph">:</span><span> </span><span class="annot"><a href="#local-6989586621679162938"><span class="hs-identifier hs-type">fs</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-277"></span><span>  </span><span id="local-6989586621679162936"><span class="annot"><span class="annottext">fromAvroF :: HashMap Text Value
-&gt; Either [Char] (NP (Field sch) ('FieldDef name t : fs))
</span><a href="#local-6989586621679162936"><span class="hs-identifier hs-var hs-var hs-var hs-var">fromAvroF</span></a></span></span><span> </span><span id="local-6989586621679162935"><span class="annot"><span class="annottext">v :: HashMap Text Value
</span><a href="#local-6989586621679162935"><span class="hs-identifier hs-var">v</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">Text -&gt; HashMap Text Value -&gt; Maybe Value
forall k v. (Eq k, Hashable k) =&gt; k -&gt; HashMap k v -&gt; Maybe v
</span><span class="hs-identifier hs-var">HM.lookup</span></span><span> </span><span class="annot"><span class="annottext">Text
</span><a href="#local-6989586621679162933"><span class="hs-identifier hs-var">fieldName</span></a></span><span> </span><span class="annot"><span class="annottext">HashMap Text Value
</span><a href="#local-6989586621679162935"><span class="hs-identifier hs-var">v</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-278"></span><span>                  </span><span class="annot"><span class="hs-identifier hs-type">Nothing</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">[Char] -&gt; Either [Char] (NP (Field sch) ('FieldDef name t : fs))
forall a b. a -&gt; Either a b
</span><span class="hs-identifier hs-var">Left</span></span><span> </span><span class="annot"><span class="hs-string">&quot;field not found&quot;</span></span><span>
</span><span id="line-279"></span><span>                  </span><span class="annot"><span class="hs-identifier hs-type">Just</span></span><span> </span><span id="local-6989586621679162932"><span class="annot"><span class="annottext">f :: Value
</span><a href="#local-6989586621679162932"><span class="hs-identifier hs-var">f</span></a></span></span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Field sch ('FieldDef name t)
-&gt; NP (Field sch) fs -&gt; NP (Field sch) ('FieldDef name t : fs)
forall k (a :: k -&gt; *) (x :: k) (xs :: [k]).
a x -&gt; NP a xs -&gt; NP a (x : xs)
</span><span class="hs-operator hs-var">(:*)</span></span><span> </span><span class="annot"><span class="annottext">(Field sch ('FieldDef name t)
 -&gt; NP (Field sch) fs -&gt; NP (Field sch) ('FieldDef name t : fs))
-&gt; Either [Char] (Field sch ('FieldDef name t))
-&gt; Either
     [Char]
     (NP (Field sch) fs -&gt; NP (Field sch) ('FieldDef name t : fs))
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;$&gt;</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">FieldValue sch t -&gt; Field sch ('FieldDef name t)
forall typeName fieldName (sch :: Schema typeName fieldName)
       (t :: FieldType typeName) (name :: fieldName).
FieldValue sch t -&gt; Field sch ('FieldDef name t)
</span><span class="hs-identifier hs-var">Field</span></span><span> </span><span class="annot"><span class="annottext">(FieldValue sch t -&gt; Field sch ('FieldDef name t))
-&gt; Either [Char] (FieldValue sch t)
-&gt; Either [Char] (Field sch ('FieldDef name t))
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;$&gt;</span></span><span> </span><span class="annot"><span class="annottext">Value -&gt; Either [Char] (FieldValue sch t)
forall a. FromAvro a =&gt; Value -&gt; Either [Char] a
</span><span class="hs-identifier hs-var">AVal.fromAvro</span></span><span> </span><span class="annot"><span class="annottext">Value
</span><a href="#local-6989586621679162932"><span class="hs-identifier hs-var">f</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Either
  [Char]
  (NP (Field sch) fs -&gt; NP (Field sch) ('FieldDef name t : fs))
-&gt; Either [Char] (NP (Field sch) fs)
-&gt; Either [Char] (NP (Field sch) ('FieldDef name t : fs))
forall (f :: * -&gt; *) a b. Applicative f =&gt; f (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;*&gt;</span></span><span> </span><span class="annot"><span class="annottext">HashMap Text Value -&gt; Either [Char] (NP (Field sch) fs)
forall (sch :: Schema Symbol Symbol)
       (fs :: [FieldDef Symbol Symbol]).
FromAvroFields sch fs =&gt;
HashMap Text Value -&gt; Either [Char] (NP (Field sch) fs)
</span><a href="Mu.Adapter.Avro.html#fromAvroF"><span class="hs-identifier hs-var">fromAvroF</span></a></span><span> </span><span class="annot"><span class="annottext">HashMap Text Value
</span><a href="#local-6989586621679162935"><span class="hs-identifier hs-var">v</span></a></span><span>
</span><span id="line-280"></span><span>    </span><span class="hs-keyword">where</span><span> </span><span id="local-6989586621679162933"><span class="annot"><span class="annottext">fieldName :: Text
</span><a href="#local-6989586621679162933"><span class="hs-identifier hs-var hs-var">fieldName</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Proxy name -&gt; Text
forall k (s :: k) (proxy :: k -&gt; *). KnownName s =&gt; proxy s -&gt; Text
</span><a href="Mu.Adapter.Avro.html#nameText"><span class="hs-identifier hs-var">nameText</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Proxy name
forall k (t :: k). Proxy t
</span><span class="hs-identifier hs-var">Proxy</span></span><span> </span><span class="hs-glyph">@</span><span class="annot"><a href="#local-6989586621679162941"><span class="hs-identifier hs-type">name</span></a></span><span class="hs-special">)</span></span></span></span></span><span>
</span><span id="line-281"></span><span>
</span><span id="line-282"></span><span class="hs-comment">-- ToAvro instances</span><span>
</span><span id="line-283"></span><span>
</span><span id="line-284"></span><span id="local-6989586621679162927"><span id="local-6989586621679162928"><span id="local-6989586621679162929"><span class="hs-keyword">instance</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">KnownName</span></span><span> </span><span class="annot"><a href="#local-6989586621679162929"><span class="hs-identifier hs-type">name</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Mu.Adapter.Avro.html#ToAvroFields"><span class="hs-identifier hs-type">ToAvroFields</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679162928"><span class="hs-identifier hs-type">sch</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679162927"><span class="hs-identifier hs-type">args</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Mu.Adapter.Avro.html#HasAvroSchemaFields"><span class="hs-identifier hs-type">HasAvroSchemaFields</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679162928"><span class="hs-identifier hs-type">sch</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679162927"><span class="hs-identifier hs-type">args</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-285"></span><span>         </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">A.ToAvro</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Term</span></span><span> </span><span class="annot"><a href="#local-6989586621679162928"><span class="hs-identifier hs-type">sch</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">'</span><span class="annot"><span class="hs-identifier hs-type">DRecord</span></span><span> </span><span class="annot"><a href="#local-6989586621679162929"><span class="hs-identifier hs-type">name</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679162927"><span class="hs-identifier hs-type">args</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-286"></span><span>  </span><span id="local-6989586621679162925"><span class="annot"><span class="annottext">toAvro :: Schema -&gt; Term sch ('DRecord name args) -&gt; Builder
</span><a href="#local-6989586621679162925"><span class="hs-identifier hs-var hs-var hs-var hs-var">toAvro</span></a></span></span><span> </span><span id="local-6989586621679162924"><span class="annot"><span class="annottext">s :: Schema
</span><a href="#local-6989586621679162924"><span class="hs-identifier hs-var">s</span></a></span></span><span class="hs-glyph">@</span><span class="annot"><span class="hs-identifier hs-type">ASch.Record</span></span><span> </span><span class="hs-special">{</span><span class="hs-special">}</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">TRecord</span></span><span> </span><span id="local-6989586621679162923"><span class="annot"><span class="annottext">fields :: NP (Field sch) args
</span><a href="#local-6989586621679162923"><span class="hs-identifier hs-var">fields</span></a></span></span><span class="hs-special">)</span><span>
</span><span id="line-287"></span><span>    </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Schema -&gt; [(Text, Encoder)] -&gt; Builder
</span><span class="hs-identifier hs-var">A.record</span></span><span> </span><span class="annot"><span class="annottext">Schema
</span><a href="#local-6989586621679162924"><span class="hs-identifier hs-var">s</span></a></span><span> </span><span class="annot"><span class="annottext">([(Text, Encoder)] -&gt; Builder) -&gt; [(Text, Encoder)] -&gt; Builder
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">NP (Field sch) args -&gt; [(Text, Encoder)]
forall (sch :: Schema Symbol Symbol)
       (fs :: [FieldDef Symbol Symbol]).
ToAvroFields sch fs =&gt;
NP (Field sch) fs -&gt; [(Text, Encoder)]
</span><a href="Mu.Adapter.Avro.html#toAvroF"><span class="hs-identifier hs-var">toAvroF</span></a></span><span> </span><span class="annot"><span class="annottext">NP (Field sch) args
</span><a href="#local-6989586621679162923"><span class="hs-identifier hs-var">fields</span></a></span><span>
</span><span id="line-288"></span><span>  </span><span class="hs-comment">-- if we don't have a record, fall back to the one from schema</span><span>
</span><span id="line-289"></span><span>  </span><span class="annot"><span class="hs-identifier hs-var">toAvro</span></span><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">TRecord</span></span><span> </span><span id="local-6989586621679162920"><span class="annot"><span class="annottext">fields :: NP (Field sch) args
</span><a href="#local-6989586621679162920"><span class="hs-identifier hs-var">fields</span></a></span></span><span class="hs-special">)</span><span>
</span><span id="line-290"></span><span>    </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Schema -&gt; [(Text, Encoder)] -&gt; Builder
</span><span class="hs-identifier hs-var">A.record</span></span><span> </span><span class="annot"><span class="annottext">Schema
</span><a href="#local-6989586621679162919"><span class="hs-identifier hs-var">sch</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">NP (Field sch) args -&gt; [(Text, Encoder)]
forall (sch :: Schema Symbol Symbol)
       (fs :: [FieldDef Symbol Symbol]).
ToAvroFields sch fs =&gt;
NP (Field sch) fs -&gt; [(Text, Encoder)]
</span><a href="Mu.Adapter.Avro.html#toAvroF"><span class="hs-identifier hs-var">toAvroF</span></a></span><span> </span><span class="annot"><span class="annottext">NP (Field sch) args
</span><a href="#local-6989586621679162920"><span class="hs-identifier hs-var">fields</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-291"></span><span>    </span><span class="hs-keyword">where</span><span> </span><span id="local-6989586621679162919"><span class="annot"><span class="annottext">sch :: Schema
</span><a href="#local-6989586621679162919"><span class="hs-identifier hs-var hs-var">sch</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Tagged (Term sch ('DRecord name args)) Schema -&gt; Schema
forall k (s :: k) b. Tagged s b -&gt; b
</span><span class="hs-identifier hs-var hs-var">unTagged</span></span><span> </span><span class="annot"><span class="annottext">(Tagged (Term sch ('DRecord name args)) Schema -&gt; Schema)
-&gt; Tagged (Term sch ('DRecord name args)) Schema -&gt; Schema
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">State [TypeName] (Tagged (Term sch ('DRecord name args)) Schema)
-&gt; [TypeName] -&gt; Tagged (Term sch ('DRecord name args)) Schema
forall s a. State s a -&gt; s -&gt; a
</span><span class="hs-identifier hs-var">evalState</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">HasAvroSchema' (Term sch ('DRecord name args)) =&gt;
State [TypeName] (Tagged (Term sch ('DRecord name args)) Schema)
forall k (x :: k).
HasAvroSchema' x =&gt;
State [TypeName] (Tagged x Schema)
</span><a href="Mu.Adapter.Avro.html#schema%27"><span class="hs-identifier hs-var">schema'</span></a></span><span> </span><span class="hs-glyph">@</span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Term</span></span><span> </span><span class="annot"><a href="#local-6989586621679162928"><span class="hs-identifier hs-type">sch</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">'</span><span class="annot"><span class="hs-identifier hs-type">DRecord</span></span><span> </span><span class="annot"><a href="#local-6989586621679162929"><span class="hs-identifier hs-type">name</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679162927"><span class="hs-identifier hs-type">args</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span></span></span></span><span>
</span><span id="line-292"></span><span id="local-6989586621679162916"><span id="local-6989586621679162917"><span id="local-6989586621679162918"><span class="hs-keyword">instance</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">KnownName</span></span><span> </span><span class="annot"><a href="#local-6989586621679162918"><span class="hs-identifier hs-type">name</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Mu.Adapter.Avro.html#ToAvroEnum"><span class="hs-identifier hs-type">ToAvroEnum</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679162917"><span class="hs-identifier hs-type">choices</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Mu.Adapter.Avro.html#HasAvroSchemaEnum"><span class="hs-identifier hs-type">HasAvroSchemaEnum</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679162917"><span class="hs-identifier hs-type">choices</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-293"></span><span>          </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">A.ToAvro</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Term</span></span><span> </span><span class="annot"><a href="#local-6989586621679162916"><span class="hs-identifier hs-type">sch</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">'</span><span class="annot"><span class="hs-identifier hs-type">DEnum</span></span><span> </span><span class="annot"><a href="#local-6989586621679162918"><span class="hs-identifier hs-type">name</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679162917"><span class="hs-identifier hs-type">choices</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-294"></span><span>  </span><span id="local-6989586621679162914"><span class="annot"><span class="annottext">toAvro :: Schema -&gt; Term sch ('DEnum name choices) -&gt; Builder
</span><a href="#local-6989586621679162914"><span class="hs-identifier hs-var hs-var hs-var hs-var">toAvro</span></a></span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">ASch.Enum</span></span><span> </span><span class="hs-special">{</span><span> </span><span class="annot"><span class="annottext">symbols :: Schema -&gt; Vector Text
</span><span class="hs-identifier hs-var">ASch.symbols</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span id="local-6989586621679162911"><span class="annot"><span class="annottext">Vector Text
</span><a href="#local-6989586621679162911"><span class="hs-identifier hs-var">ss</span></a></span></span><span> </span><span class="hs-special">}</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">TEnum</span></span><span> </span><span id="local-6989586621679162910"><span class="annot"><span class="annottext">n :: NS Proxy choices
</span><a href="#local-6989586621679162910"><span class="hs-identifier hs-var">n</span></a></span></span><span class="hs-special">)</span><span>
</span><span id="line-295"></span><span>    </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Word8 -&gt; Builder
</span><span class="hs-identifier hs-var">word8</span></span><span> </span><span class="annot"><span class="annottext">(Word8 -&gt; Builder) -&gt; Word8 -&gt; Builder
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Int -&gt; Word8
forall a b. (Integral a, Num b) =&gt; a -&gt; b
</span><span class="hs-identifier hs-var">fromIntegral</span></span><span> </span><span class="annot"><span class="annottext">(Int -&gt; Word8) -&gt; Int -&gt; Word8
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Vector Text -&gt; NS Proxy choices -&gt; Int
forall k (choices :: [k]).
ToAvroEnum choices =&gt;
Vector Text -&gt; NS Proxy choices -&gt; Int
</span><a href="Mu.Adapter.Avro.html#toAvroE"><span class="hs-identifier hs-var">toAvroE</span></a></span><span> </span><span class="annot"><span class="annottext">Vector Text
</span><a href="#local-6989586621679162911"><span class="hs-identifier hs-var">ss</span></a></span><span> </span><span class="annot"><span class="annottext">NS Proxy choices
</span><a href="#local-6989586621679162910"><span class="hs-identifier hs-var">n</span></a></span><span>
</span><span id="line-296"></span><span>  </span><span class="hs-comment">-- otherwise fall back to the one from schema</span><span>
</span><span id="line-297"></span><span>  </span><span class="annot"><span class="hs-identifier hs-var">toAvro</span></span><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">TEnum</span></span><span> </span><span id="local-6989586621679162908"><span class="annot"><span class="annottext">n :: NS Proxy choices
</span><a href="#local-6989586621679162908"><span class="hs-identifier hs-var">n</span></a></span></span><span class="hs-special">)</span><span>
</span><span id="line-298"></span><span>    </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Word8 -&gt; Builder
</span><span class="hs-identifier hs-var">word8</span></span><span> </span><span class="annot"><span class="annottext">(Word8 -&gt; Builder) -&gt; Word8 -&gt; Builder
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Int -&gt; Word8
forall a b. (Integral a, Num b) =&gt; a -&gt; b
</span><span class="hs-identifier hs-var">fromIntegral</span></span><span> </span><span class="annot"><span class="annottext">(Int -&gt; Word8) -&gt; Int -&gt; Word8
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Vector Text -&gt; NS Proxy choices -&gt; Int
forall k (choices :: [k]).
ToAvroEnum choices =&gt;
Vector Text -&gt; NS Proxy choices -&gt; Int
</span><a href="Mu.Adapter.Avro.html#toAvroE"><span class="hs-identifier hs-var">toAvroE</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[Text] -&gt; Vector Text
forall a. [a] -&gt; Vector a
</span><span class="hs-identifier hs-var">V.fromList</span></span><span> </span><span class="annot"><span class="annottext">([Text] -&gt; Vector Text) -&gt; [Text] -&gt; Vector Text
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Proxy choices -&gt; [Text]
forall fn (fs :: [ChoiceDef fn]).
HasAvroSchemaEnum fs =&gt;
Proxy fs -&gt; [Text]
</span><a href="Mu.Adapter.Avro.html#schemaE"><span class="hs-identifier hs-var">schemaE</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Proxy choices
forall k (t :: k). Proxy t
</span><span class="hs-identifier hs-var">Proxy</span></span><span> </span><span class="hs-glyph">@</span><span class="annot"><a href="#local-6989586621679162917"><span class="hs-identifier hs-type">choices</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">NS Proxy choices
</span><a href="#local-6989586621679162908"><span class="hs-identifier hs-var">n</span></a></span></span></span></span><span>
</span><span id="line-299"></span><span id="local-6989586621679162905"><span id="local-6989586621679162906"><span class="hs-keyword">instance</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">A.ToAvro</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">FieldValue</span></span><span> </span><span class="annot"><a href="#local-6989586621679162906"><span class="hs-identifier hs-type">sch</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679162905"><span class="hs-identifier hs-type">t</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-300"></span><span>         </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">A.ToAvro</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Term</span></span><span> </span><span class="annot"><a href="#local-6989586621679162906"><span class="hs-identifier hs-type">sch</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">'</span><span class="annot"><span class="hs-identifier hs-type">DSimple</span></span><span> </span><span class="annot"><a href="#local-6989586621679162905"><span class="hs-identifier hs-type">t</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-301"></span><span>  </span><span id="local-6989586621679162903"><span class="annot"><span class="annottext">toAvro :: Schema -&gt; Term sch ('DSimple t) -&gt; Builder
</span><a href="#local-6989586621679162903"><span class="hs-identifier hs-var hs-var hs-var hs-var">toAvro</span></a></span></span><span> </span><span id="local-6989586621679162902"><span class="annot"><span class="annottext">s :: Schema
</span><a href="#local-6989586621679162902"><span class="hs-identifier hs-var">s</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">TSimple</span></span><span> </span><span id="local-6989586621679162901"><span class="annot"><span class="annottext">v :: FieldValue sch t1
</span><a href="#local-6989586621679162901"><span class="hs-identifier hs-var">v</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Schema -&gt; FieldValue sch t1 -&gt; Builder
forall a. ToAvro a =&gt; Schema -&gt; a -&gt; Builder
</span><span class="hs-identifier hs-var">A.toAvro</span></span><span> </span><span class="annot"><span class="annottext">Schema
</span><a href="#local-6989586621679162902"><span class="hs-identifier hs-var">s</span></a></span><span> </span><span class="annot"><span class="annottext">FieldValue sch t1
</span><a href="#local-6989586621679162901"><span class="hs-identifier hs-var">v</span></a></span></span></span><span>
</span><span id="line-302"></span><span>
</span><span id="line-303"></span><span id="local-6989586621679162900"><span class="hs-keyword">instance</span><span> </span><span class="annot"><span class="hs-identifier hs-type">A.ToAvro</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">FieldValue</span></span><span> </span><span class="annot"><a href="#local-6989586621679162900"><span class="hs-identifier hs-type">sch</span></a></span><span> </span><span class="hs-special">'</span><span class="annot"><span class="hs-identifier hs-type">TNull</span></span><span class="hs-special">)</span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-304"></span><span>  </span><span id="local-6989586621679162898"><span class="annot"><span class="annottext">toAvro :: Schema -&gt; FieldValue sch 'TNull -&gt; Builder
</span><a href="#local-6989586621679162898"><span class="hs-identifier hs-var hs-var hs-var hs-var">toAvro</span></a></span></span><span> </span><span class="hs-identifier">_</span><span> </span><span class="annot"><span class="hs-identifier hs-type">FNull</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Builder
forall a. Monoid a =&gt; a
</span><span class="hs-identifier hs-var">mempty</span></span></span><span>
</span><span id="line-305"></span><span id="local-6989586621679162896"><span id="local-6989586621679162897"><span class="hs-keyword">instance</span><span> </span><span class="annot"><span class="hs-identifier hs-type">A.ToAvro</span></span><span> </span><span class="annot"><a href="#local-6989586621679162897"><span class="hs-identifier hs-type">t</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">A.ToAvro</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">FieldValue</span></span><span> </span><span class="annot"><a href="#local-6989586621679162896"><span class="hs-identifier hs-type">sch</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">'</span><span class="annot"><span class="hs-identifier hs-type">TPrimitive</span></span><span> </span><span class="annot"><a href="#local-6989586621679162897"><span class="hs-identifier hs-type">t</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-306"></span><span>  </span><span id="local-6989586621679162894"><span class="annot"><span class="annottext">toAvro :: Schema -&gt; FieldValue sch ('TPrimitive t) -&gt; Builder
</span><a href="#local-6989586621679162894"><span class="hs-identifier hs-var hs-var hs-var hs-var">toAvro</span></a></span></span><span> </span><span id="local-6989586621679162893"><span class="annot"><span class="annottext">s :: Schema
</span><a href="#local-6989586621679162893"><span class="hs-identifier hs-var">s</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">FPrimitive</span></span><span> </span><span id="local-6989586621679162892"><span class="annot"><span class="annottext">v :: t1
</span><a href="#local-6989586621679162892"><span class="hs-identifier hs-var">v</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Schema -&gt; t1 -&gt; Builder
forall a. ToAvro a =&gt; Schema -&gt; a -&gt; Builder
</span><span class="hs-identifier hs-var">A.toAvro</span></span><span> </span><span class="annot"><span class="annottext">Schema
</span><a href="#local-6989586621679162893"><span class="hs-identifier hs-var">s</span></a></span><span> </span><span class="annot"><span class="annottext">t1
</span><a href="#local-6989586621679162892"><span class="hs-identifier hs-var">v</span></a></span></span></span><span>
</span><span id="line-307"></span><span id="local-6989586621679162890"><span id="local-6989586621679162891"><span class="hs-keyword">instance</span><span> </span><span class="hs-special">(</span><span> </span><span class="annot"><span class="hs-identifier hs-type">KnownName</span></span><span> </span><span class="annot"><a href="#local-6989586621679162891"><span class="hs-identifier hs-type">t</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">A.ToAvro</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Term</span></span><span> </span><span class="annot"><a href="#local-6989586621679162890"><span class="hs-identifier hs-type">sch</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679162890"><span class="hs-identifier hs-type">sch</span></a></span><span> </span><span class="annot"><span class="hs-operator hs-type">:/:</span></span><span> </span><span class="annot"><a href="#local-6989586621679162891"><span class="hs-identifier hs-type">t</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-special">)</span><span>
</span><span id="line-308"></span><span>         </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">A.ToAvro</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">FieldValue</span></span><span> </span><span class="annot"><a href="#local-6989586621679162890"><span class="hs-identifier hs-type">sch</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">'</span><span class="annot"><span class="hs-identifier hs-type">TSchematic</span></span><span> </span><span class="annot"><a href="#local-6989586621679162891"><span class="hs-identifier hs-type">t</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-309"></span><span>  </span><span id="local-6989586621679162888"><span class="annot"><span class="annottext">toAvro :: Schema -&gt; FieldValue sch ('TSchematic t) -&gt; Builder
</span><a href="#local-6989586621679162888"><span class="hs-identifier hs-var hs-var hs-var hs-var">toAvro</span></a></span></span><span> </span><span id="local-6989586621679162887"><span class="annot"><span class="annottext">s :: Schema
</span><a href="#local-6989586621679162887"><span class="hs-identifier hs-var">s</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">FSchematic</span></span><span> </span><span id="local-6989586621679162886"><span class="annot"><span class="annottext">v :: Term sch (sch :/: t1)
</span><a href="#local-6989586621679162886"><span class="hs-identifier hs-var">v</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Schema -&gt; Term sch (sch :/: t) -&gt; Builder
forall a. ToAvro a =&gt; Schema -&gt; a -&gt; Builder
</span><span class="hs-identifier hs-var">A.toAvro</span></span><span> </span><span class="annot"><span class="annottext">Schema
</span><a href="#local-6989586621679162887"><span class="hs-identifier hs-var">s</span></a></span><span> </span><span class="annot"><span class="annottext">Term sch (sch :/: t)
Term sch (sch :/: t1)
</span><a href="#local-6989586621679162886"><span class="hs-identifier hs-var">v</span></a></span></span></span><span>
</span><span id="line-310"></span><span id="local-6989586621679162884"><span id="local-6989586621679162885"><span class="hs-keyword">instance</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Mu.Adapter.Avro.html#ToAvroUnion"><span class="hs-identifier hs-type">ToAvroUnion</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679162885"><span class="hs-identifier hs-type">sch</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679162884"><span class="hs-identifier hs-type">choices</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-311"></span><span>         </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">A.ToAvro</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">FieldValue</span></span><span> </span><span class="annot"><a href="#local-6989586621679162885"><span class="hs-identifier hs-type">sch</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">'</span><span class="annot"><span class="hs-identifier hs-type">TUnion</span></span><span> </span><span class="annot"><a href="#local-6989586621679162884"><span class="hs-identifier hs-type">choices</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-312"></span><span>  </span><span id="local-6989586621679162882"><span class="annot"><span class="annottext">toAvro :: Schema -&gt; FieldValue sch ('TUnion choices) -&gt; Builder
</span><a href="#local-6989586621679162882"><span class="hs-identifier hs-var hs-var hs-var hs-var">toAvro</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">ASch.Union</span></span><span> </span><span id="local-6989586621679162880"><span class="annot"><span class="annottext">vs :: Vector Schema
</span><a href="#local-6989586621679162880"><span class="hs-identifier hs-var">vs</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">FUnion</span></span><span> </span><span id="local-6989586621679162879"><span class="annot"><span class="annottext">v :: NS (FieldValue sch) choices
</span><a href="#local-6989586621679162879"><span class="hs-identifier hs-var">v</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Vector Schema -&gt; Int -&gt; NS (FieldValue sch) choices -&gt; Builder
forall typeName fieldName (sch :: Schema typeName fieldName)
       (choices :: [FieldType typeName]).
ToAvroUnion sch choices =&gt;
Vector Schema -&gt; Int -&gt; NS (FieldValue sch) choices -&gt; Builder
</span><a href="Mu.Adapter.Avro.html#toAvroU"><span class="hs-identifier hs-var">toAvroU</span></a></span><span> </span><span class="annot"><span class="annottext">Vector Schema
</span><a href="#local-6989586621679162880"><span class="hs-identifier hs-var">vs</span></a></span><span> </span><span class="annot"><span class="hs-number">0</span></span><span> </span><span class="annot"><span class="annottext">NS (FieldValue sch) choices
</span><a href="#local-6989586621679162879"><span class="hs-identifier hs-var">v</span></a></span><span>
</span><span id="line-313"></span><span>  </span><span class="annot"><span class="hs-identifier hs-var">toAvro</span></span><span> </span><span id="local-6989586621679162877"><span class="annot"><span class="annottext">s :: Schema
</span><a href="#local-6989586621679162877"><span class="hs-identifier hs-var">s</span></a></span></span><span> </span><span class="hs-identifier">_</span><span>                        </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[Char] -&gt; Builder
forall a. HasCallStack =&gt; [Char] -&gt; a
</span><span class="hs-identifier hs-var">error</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-string">&quot;this should never happen:\n&quot;</span></span><span> </span><span class="annot"><span class="annottext">[Char] -&gt; [Char] -&gt; [Char]
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="annot"><span class="annottext">Schema -&gt; [Char]
forall a. Show a =&gt; a -&gt; [Char]
</span><span class="hs-identifier hs-var">show</span></span><span> </span><span class="annot"><span class="annottext">Schema
</span><a href="#local-6989586621679162877"><span class="hs-identifier hs-var">s</span></a></span><span class="hs-special">)</span></span></span><span>
</span><span id="line-314"></span><span id="local-6989586621679162875"><span id="local-6989586621679162876"><span class="hs-keyword">instance</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">A.ToAvro</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">FieldValue</span></span><span> </span><span class="annot"><a href="#local-6989586621679162876"><span class="hs-identifier hs-type">sch</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679162875"><span class="hs-identifier hs-type">t</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-315"></span><span>         </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">A.ToAvro</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">FieldValue</span></span><span> </span><span class="annot"><a href="#local-6989586621679162876"><span class="hs-identifier hs-type">sch</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">'</span><span class="annot"><span class="hs-identifier hs-type">TOption</span></span><span> </span><span class="annot"><a href="#local-6989586621679162875"><span class="hs-identifier hs-type">t</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-316"></span><span>  </span><span id="local-6989586621679162873"><span class="annot"><span class="annottext">toAvro :: Schema -&gt; FieldValue sch ('TOption t) -&gt; Builder
</span><a href="#local-6989586621679162873"><span class="hs-identifier hs-var hs-var hs-var hs-var">toAvro</span></a></span></span><span> </span><span id="local-6989586621679162872"><span class="annot"><span class="annottext">s :: Schema
</span><a href="#local-6989586621679162872"><span class="hs-identifier hs-var">s</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">FOption</span></span><span> </span><span id="local-6989586621679162871"><span class="annot"><span class="annottext">v :: Maybe (FieldValue sch t1)
</span><a href="#local-6989586621679162871"><span class="hs-identifier hs-var">v</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Schema -&gt; Maybe (FieldValue sch t1) -&gt; Builder
forall a. ToAvro a =&gt; Schema -&gt; a -&gt; Builder
</span><span class="hs-identifier hs-var">A.toAvro</span></span><span> </span><span class="annot"><span class="annottext">Schema
</span><a href="#local-6989586621679162872"><span class="hs-identifier hs-var">s</span></a></span><span> </span><span class="annot"><span class="annottext">Maybe (FieldValue sch t1)
</span><a href="#local-6989586621679162871"><span class="hs-identifier hs-var">v</span></a></span></span></span><span>
</span><span id="line-317"></span><span id="local-6989586621679162869"><span id="local-6989586621679162870"><span class="hs-keyword">instance</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">A.ToAvro</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">FieldValue</span></span><span> </span><span class="annot"><a href="#local-6989586621679162870"><span class="hs-identifier hs-type">sch</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679162869"><span class="hs-identifier hs-type">t</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-318"></span><span>         </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">A.ToAvro</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">FieldValue</span></span><span> </span><span class="annot"><a href="#local-6989586621679162870"><span class="hs-identifier hs-type">sch</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">'</span><span class="annot"><span class="hs-identifier hs-type">TList</span></span><span> </span><span class="annot"><a href="#local-6989586621679162869"><span class="hs-identifier hs-type">t</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-319"></span><span>  </span><span id="local-6989586621679162867"><span class="annot"><span class="annottext">toAvro :: Schema -&gt; FieldValue sch ('TList t) -&gt; Builder
</span><a href="#local-6989586621679162867"><span class="hs-identifier hs-var hs-var hs-var hs-var">toAvro</span></a></span></span><span> </span><span id="local-6989586621679162866"><span class="annot"><span class="annottext">s :: Schema
</span><a href="#local-6989586621679162866"><span class="hs-identifier hs-var">s</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">FList</span></span><span> </span><span id="local-6989586621679162865"><span class="annot"><span class="annottext">v :: [FieldValue sch t1]
</span><a href="#local-6989586621679162865"><span class="hs-identifier hs-var">v</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Schema -&gt; [FieldValue sch t1] -&gt; Builder
forall a. ToAvro a =&gt; Schema -&gt; a -&gt; Builder
</span><span class="hs-identifier hs-var">A.toAvro</span></span><span> </span><span class="annot"><span class="annottext">Schema
</span><a href="#local-6989586621679162866"><span class="hs-identifier hs-var">s</span></a></span><span> </span><span class="annot"><span class="annottext">[FieldValue sch t1]
</span><a href="#local-6989586621679162865"><span class="hs-identifier hs-var">v</span></a></span></span></span><span>
</span><span id="line-320"></span><span class="hs-comment">-- These are the only two versions of Map supported by the library</span><span>
</span><span id="line-321"></span><span id="local-6989586621679162863"><span id="local-6989586621679162864"><span class="hs-keyword">instance</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">A.ToAvro</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">FieldValue</span></span><span> </span><span class="annot"><a href="#local-6989586621679162864"><span class="hs-identifier hs-type">sch</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679162863"><span class="hs-identifier hs-type">v</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-322"></span><span>         </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">A.ToAvro</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">FieldValue</span></span><span> </span><span class="annot"><a href="#local-6989586621679162864"><span class="hs-identifier hs-type">sch</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">'</span><span class="annot"><span class="hs-identifier hs-type">TMap</span></span><span> </span><span class="hs-special">(</span><span class="hs-special">'</span><span class="annot"><span class="hs-identifier hs-type">TPrimitive</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">T.Text</span></span><span class="hs-special">)</span><span> </span><span class="annot"><a href="#local-6989586621679162863"><span class="hs-identifier hs-type">v</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-323"></span><span>  </span><span id="local-6989586621679162861"><span class="annot"><span class="annottext">toAvro :: Schema -&gt; FieldValue sch ('TMap ('TPrimitive Text) v) -&gt; Builder
</span><a href="#local-6989586621679162861"><span class="hs-identifier hs-var hs-var hs-var hs-var">toAvro</span></a></span></span><span> </span><span id="local-6989586621679162860"><span class="annot"><span class="annottext">s :: Schema
</span><a href="#local-6989586621679162860"><span class="hs-identifier hs-var">s</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">FMap</span></span><span> </span><span id="local-6989586621679162859"><span class="annot"><span class="annottext">v :: Map (FieldValue sch k) (FieldValue sch v)
</span><a href="#local-6989586621679162859"><span class="hs-identifier hs-var">v</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Schema -&gt; Map Text (FieldValue sch v) -&gt; Builder
forall a. ToAvro a =&gt; Schema -&gt; a -&gt; Builder
</span><span class="hs-identifier hs-var">A.toAvro</span></span><span> </span><span class="annot"><span class="annottext">Schema
</span><a href="#local-6989586621679162860"><span class="hs-identifier hs-var">s</span></a></span><span> </span><span class="annot"><span class="annottext">(Map Text (FieldValue sch v) -&gt; Builder)
-&gt; Map Text (FieldValue sch v) -&gt; Builder
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">(FieldValue sch k -&gt; Text)
-&gt; Map (FieldValue sch k) (FieldValue sch v)
-&gt; Map Text (FieldValue sch v)
forall k2 k1 a. Ord k2 =&gt; (k1 -&gt; k2) -&gt; Map k1 a -&gt; Map k2 a
</span><span class="hs-identifier hs-var">M.mapKeys</span></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">FPrimitive</span></span><span> </span><span id="local-6989586621679162858"><span class="annot"><span class="annottext">k :: t1
</span><a href="#local-6989586621679162858"><span class="hs-identifier hs-var">k</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">t1
Text
</span><a href="#local-6989586621679162858"><span class="hs-identifier hs-var">k</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Map (FieldValue sch k) (FieldValue sch v)
</span><a href="#local-6989586621679162859"><span class="hs-identifier hs-var">v</span></a></span></span></span><span>
</span><span id="line-324"></span><span id="local-6989586621679162856"><span id="local-6989586621679162857"><span class="hs-keyword">instance</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">A.ToAvro</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">FieldValue</span></span><span> </span><span class="annot"><a href="#local-6989586621679162857"><span class="hs-identifier hs-type">sch</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679162856"><span class="hs-identifier hs-type">v</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-325"></span><span>         </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">A.ToAvro</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">FieldValue</span></span><span> </span><span class="annot"><a href="#local-6989586621679162857"><span class="hs-identifier hs-type">sch</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">'</span><span class="annot"><span class="hs-identifier hs-type">TMap</span></span><span> </span><span class="hs-special">(</span><span class="hs-special">'</span><span class="annot"><span class="hs-identifier hs-type">TPrimitive</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">String</span></span><span class="hs-special">)</span><span> </span><span class="annot"><a href="#local-6989586621679162856"><span class="hs-identifier hs-type">v</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-326"></span><span>  </span><span id="local-6989586621679162854"><span class="annot"><span class="annottext">toAvro :: Schema -&gt; FieldValue sch ('TMap ('TPrimitive [Char]) v) -&gt; Builder
</span><a href="#local-6989586621679162854"><span class="hs-identifier hs-var hs-var hs-var hs-var">toAvro</span></a></span></span><span> </span><span id="local-6989586621679162853"><span class="annot"><span class="annottext">s :: Schema
</span><a href="#local-6989586621679162853"><span class="hs-identifier hs-var">s</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">FMap</span></span><span> </span><span id="local-6989586621679162852"><span class="annot"><span class="annottext">v :: Map (FieldValue sch k) (FieldValue sch v)
</span><a href="#local-6989586621679162852"><span class="hs-identifier hs-var">v</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Schema -&gt; Map Text (FieldValue sch v) -&gt; Builder
forall a. ToAvro a =&gt; Schema -&gt; a -&gt; Builder
</span><span class="hs-identifier hs-var">A.toAvro</span></span><span> </span><span class="annot"><span class="annottext">Schema
</span><a href="#local-6989586621679162853"><span class="hs-identifier hs-var">s</span></a></span><span> </span><span class="annot"><span class="annottext">(Map Text (FieldValue sch v) -&gt; Builder)
-&gt; Map Text (FieldValue sch v) -&gt; Builder
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">(FieldValue sch k -&gt; Text)
-&gt; Map (FieldValue sch k) (FieldValue sch v)
-&gt; Map Text (FieldValue sch v)
forall k2 k1 a. Ord k2 =&gt; (k1 -&gt; k2) -&gt; Map k1 a -&gt; Map k2 a
</span><span class="hs-identifier hs-var">M.mapKeys</span></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">FPrimitive</span></span><span> </span><span id="local-6989586621679162851"><span class="annot"><span class="annottext">k :: t1
</span><a href="#local-6989586621679162851"><span class="hs-identifier hs-var">k</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">[Char] -&gt; Text
</span><span class="hs-identifier hs-var">T.pack</span></span><span> </span><span class="annot"><span class="annottext">t1
[Char]
</span><a href="#local-6989586621679162851"><span class="hs-identifier hs-var">k</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Map (FieldValue sch k) (FieldValue sch v)
</span><a href="#local-6989586621679162852"><span class="hs-identifier hs-var">v</span></a></span></span></span><span>
</span><span id="line-327"></span><span>
</span><span id="line-328"></span><span class="hs-keyword">class</span><span> </span><span id="ToAvroEnum"><span class="annot"><a href="Mu.Adapter.Avro.html#ToAvroEnum"><span class="hs-identifier hs-var">ToAvroEnum</span></a></span></span><span> </span><span id="local-6989586621679163352"><span class="annot"><a href="#local-6989586621679163352"><span class="hs-identifier hs-type">choices</span></a></span></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-329"></span><span>  </span><span id="toAvroE"><span class="annot"><a href="Mu.Adapter.Avro.html#toAvroE"><span class="hs-identifier hs-type">toAvroE</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">V.Vector</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">T.Text</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">NS</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Proxy</span></span><span> </span><span class="annot"><a href="#local-6989586621679163352"><span class="hs-identifier hs-type">choices</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Int</span></span><span>
</span><span id="line-330"></span><span class="hs-keyword">instance</span><span> </span><span class="annot"><a href="Mu.Adapter.Avro.html#ToAvroEnum"><span class="hs-identifier hs-type">ToAvroEnum</span></a></span><span> </span><span class="hs-special">'</span><span class="hs-special">[</span><span class="hs-special">]</span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-331"></span><span>  </span><span id="local-6989586621679162847"><span class="annot"><span class="annottext">toAvroE :: Vector Text -&gt; NS Proxy '[] -&gt; Int
</span><a href="#local-6989586621679162847"><span class="hs-identifier hs-var hs-var hs-var hs-var">toAvroE</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[Char] -&gt; Vector Text -&gt; NS Proxy '[] -&gt; Int
forall a. HasCallStack =&gt; [Char] -&gt; a
</span><span class="hs-identifier hs-var">error</span></span><span> </span><span class="annot"><span class="hs-string">&quot;ToAvro in an empty enum&quot;</span></span><span>
</span><span id="line-332"></span><span id="local-6989586621679162845"><span id="local-6989586621679162846"><span class="hs-keyword">instance</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">KnownName</span></span><span> </span><span class="annot"><a href="#local-6989586621679162846"><span class="hs-identifier hs-type">u</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Mu.Adapter.Avro.html#ToAvroEnum"><span class="hs-identifier hs-type">ToAvroEnum</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679162845"><span class="hs-identifier hs-type">us</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-333"></span><span>         </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="Mu.Adapter.Avro.html#ToAvroEnum"><span class="hs-identifier hs-type">ToAvroEnum</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">'</span><span class="annot"><span class="hs-identifier hs-type">ChoiceDef</span></span><span> </span><span class="annot"><a href="#local-6989586621679162846"><span class="hs-identifier hs-type">u</span></a></span><span> </span><span class="hs-special">'</span><span class="hs-glyph">:</span><span> </span><span class="annot"><a href="#local-6989586621679162845"><span class="hs-identifier hs-type">us</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-334"></span><span>  </span><span id="local-6989586621679162843"><span class="annot"><span class="annottext">toAvroE :: Vector Text -&gt; NS Proxy ('ChoiceDef u : us) -&gt; Int
</span><a href="#local-6989586621679162843"><span class="hs-identifier hs-var hs-var hs-var hs-var">toAvroE</span></a></span></span><span> </span><span id="local-6989586621679162842"><span class="annot"><span class="annottext">s :: Vector Text
</span><a href="#local-6989586621679162842"><span class="hs-identifier hs-var">s</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Z</span></span><span> </span><span class="hs-identifier">_</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Maybe Int -&gt; Int
forall a. HasCallStack =&gt; Maybe a -&gt; a
</span><span class="hs-identifier hs-var">fromJust</span></span><span> </span><span class="annot"><span class="annottext">(Maybe Int -&gt; Int) -&gt; Maybe Int -&gt; Int
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Proxy u -&gt; Text
forall k (s :: k) (proxy :: k -&gt; *). KnownName s =&gt; proxy s -&gt; Text
</span><a href="Mu.Adapter.Avro.html#nameText"><span class="hs-identifier hs-var">nameText</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Proxy u
forall k (t :: k). Proxy t
</span><span class="hs-identifier hs-var">Proxy</span></span><span> </span><span class="hs-glyph">@</span><span class="annot"><a href="#local-6989586621679162846"><span class="hs-identifier hs-type">u</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Text -&gt; Vector Text -&gt; Maybe Int
forall a. Eq a =&gt; a -&gt; Vector a -&gt; Maybe Int
</span><span class="hs-operator hs-var">`V.elemIndex`</span></span><span> </span><span class="annot"><span class="annottext">Vector Text
</span><a href="#local-6989586621679162842"><span class="hs-identifier hs-var">s</span></a></span><span>
</span><span id="line-335"></span><span>  </span><span class="annot"><a href="Mu.Adapter.Avro.html#toAvroE"><span class="hs-identifier hs-var">toAvroE</span></a></span><span> </span><span id="local-6989586621679162840"><span class="annot"><span class="annottext">s :: Vector Text
</span><a href="#local-6989586621679162840"><span class="hs-identifier hs-var">s</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">S</span></span><span> </span><span id="local-6989586621679162839"><span class="annot"><span class="annottext">v :: NS Proxy xs
</span><a href="#local-6989586621679162839"><span class="hs-identifier hs-var">v</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Vector Text -&gt; NS Proxy xs -&gt; Int
forall k (choices :: [k]).
ToAvroEnum choices =&gt;
Vector Text -&gt; NS Proxy choices -&gt; Int
</span><a href="Mu.Adapter.Avro.html#toAvroE"><span class="hs-identifier hs-var">toAvroE</span></a></span><span> </span><span class="annot"><span class="annottext">Vector Text
</span><a href="#local-6989586621679162840"><span class="hs-identifier hs-var">s</span></a></span><span> </span><span class="annot"><span class="annottext">NS Proxy xs
</span><a href="#local-6989586621679162839"><span class="hs-identifier hs-var">v</span></a></span></span></span><span>
</span><span id="line-336"></span><span>
</span><span id="line-337"></span><span class="hs-keyword">class</span><span> </span><span id="ToAvroUnion"><span class="annot"><a href="Mu.Adapter.Avro.html#ToAvroUnion"><span class="hs-identifier hs-var">ToAvroUnion</span></a></span></span><span> </span><span id="local-6989586621679163322"><span class="annot"><a href="#local-6989586621679163322"><span class="hs-identifier hs-type">sch</span></a></span></span><span> </span><span id="local-6989586621679163321"><span class="annot"><a href="#local-6989586621679163321"><span class="hs-identifier hs-type">choices</span></a></span></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-338"></span><span>  </span><span id="toAvroU"><span class="annot"><a href="Mu.Adapter.Avro.html#toAvroU"><span class="hs-identifier hs-type">toAvroU</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">V.Vector</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">ASch.Schema</span></span><span>
</span><span id="line-339"></span><span>          </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Int</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">NS</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">FieldValue</span></span><span> </span><span class="annot"><a href="#local-6989586621679163322"><span class="hs-identifier hs-type">sch</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><a href="#local-6989586621679163321"><span class="hs-identifier hs-type">choices</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Builder</span></span><span>
</span><span id="line-340"></span><span id="local-6989586621679162838"><span class="hs-keyword">instance</span><span> </span><span class="annot"><a href="Mu.Adapter.Avro.html#ToAvroUnion"><span class="hs-identifier hs-type">ToAvroUnion</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679162838"><span class="hs-identifier hs-type">sch</span></a></span><span> </span><span class="hs-special">'</span><span class="hs-special">[</span><span class="hs-special">]</span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-341"></span><span>  </span><span id="local-6989586621679162835"><span class="annot"><span class="annottext">toAvroU :: Vector Schema -&gt; Int -&gt; NS (FieldValue sch) '[] -&gt; Builder
</span><a href="#local-6989586621679162835"><span class="hs-identifier hs-var hs-var hs-var hs-var">toAvroU</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[Char]
-&gt; Vector Schema -&gt; Int -&gt; NS (FieldValue sch) '[] -&gt; Builder
forall a. HasCallStack =&gt; [Char] -&gt; a
</span><span class="hs-identifier hs-var">error</span></span><span> </span><span class="annot"><span class="hs-string">&quot;this should never happen&quot;</span></span></span><span>
</span><span id="line-342"></span><span id="local-6989586621679162832"><span id="local-6989586621679162833"><span id="local-6989586621679162834"><span class="hs-keyword">instance</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">A.ToAvro</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">FieldValue</span></span><span> </span><span class="annot"><a href="#local-6989586621679162834"><span class="hs-identifier hs-type">sch</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679162833"><span class="hs-identifier hs-type">u</span></a></span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Mu.Adapter.Avro.html#ToAvroUnion"><span class="hs-identifier hs-type">ToAvroUnion</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679162834"><span class="hs-identifier hs-type">sch</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679162832"><span class="hs-identifier hs-type">us</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-343"></span><span>         </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="Mu.Adapter.Avro.html#ToAvroUnion"><span class="hs-identifier hs-type">ToAvroUnion</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679162834"><span class="hs-identifier hs-type">sch</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679162833"><span class="hs-identifier hs-type">u</span></a></span><span> </span><span class="hs-special">'</span><span class="hs-glyph">:</span><span> </span><span class="annot"><a href="#local-6989586621679162832"><span class="hs-identifier hs-type">us</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-344"></span><span>  </span><span id="local-6989586621679162830"><span class="annot"><span class="annottext">toAvroU :: Vector Schema -&gt; Int -&gt; NS (FieldValue sch) (u : us) -&gt; Builder
</span><a href="#local-6989586621679162830"><span class="hs-identifier hs-var hs-var hs-var hs-var">toAvroU</span></a></span></span><span> </span><span id="local-6989586621679162829"><span class="annot"><span class="annottext">allSch :: Vector Schema
</span><a href="#local-6989586621679162829"><span class="hs-identifier hs-var">allSch</span></a></span></span><span> </span><span id="local-6989586621679162828"><span class="annot"><span class="annottext">n :: Int
</span><a href="#local-6989586621679162828"><span class="hs-identifier hs-var">n</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Z</span></span><span> </span><span id="local-6989586621679162827"><span class="annot"><span class="annottext">v :: FieldValue sch x
</span><a href="#local-6989586621679162827"><span class="hs-identifier hs-var">v</span></a></span></span><span class="hs-special">)</span><span>
</span><span id="line-345"></span><span>    </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Int -&gt; Vector Schema -&gt; FieldValue sch x -&gt; Builder
forall a. ToAvro a =&gt; Int -&gt; Vector Schema -&gt; a -&gt; Builder
</span><span class="hs-identifier hs-var">putIndexedValue</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679162828"><span class="hs-identifier hs-var">n</span></a></span><span> </span><span class="annot"><span class="annottext">Vector Schema
</span><a href="#local-6989586621679162829"><span class="hs-identifier hs-var">allSch</span></a></span><span> </span><span class="annot"><span class="annottext">FieldValue sch x
</span><a href="#local-6989586621679162827"><span class="hs-identifier hs-var">v</span></a></span><span>
</span><span id="line-346"></span><span>  </span><span class="annot"><a href="Mu.Adapter.Avro.html#toAvroU"><span class="hs-identifier hs-var">toAvroU</span></a></span><span> </span><span id="local-6989586621679162826"><span class="annot"><span class="annottext">allSch :: Vector Schema
</span><a href="#local-6989586621679162826"><span class="hs-identifier hs-var">allSch</span></a></span></span><span> </span><span id="local-6989586621679162825"><span class="annot"><span class="annottext">n :: Int
</span><a href="#local-6989586621679162825"><span class="hs-identifier hs-var">n</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">S</span></span><span> </span><span id="local-6989586621679162824"><span class="annot"><span class="annottext">v :: NS (FieldValue sch) xs
</span><a href="#local-6989586621679162824"><span class="hs-identifier hs-var">v</span></a></span></span><span class="hs-special">)</span><span>
</span><span id="line-347"></span><span>    </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Vector Schema -&gt; Int -&gt; NS (FieldValue sch) xs -&gt; Builder
forall typeName fieldName (sch :: Schema typeName fieldName)
       (choices :: [FieldType typeName]).
ToAvroUnion sch choices =&gt;
Vector Schema -&gt; Int -&gt; NS (FieldValue sch) choices -&gt; Builder
</span><a href="Mu.Adapter.Avro.html#toAvroU"><span class="hs-identifier hs-var">toAvroU</span></a></span><span> </span><span class="annot"><span class="annottext">Vector Schema
</span><a href="#local-6989586621679162826"><span class="hs-identifier hs-var">allSch</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679162825"><span class="hs-identifier hs-var">n</span></a></span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Int
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">+</span></span><span class="annot"><span class="hs-number">1</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">NS (FieldValue sch) xs
</span><a href="#local-6989586621679162824"><span class="hs-identifier hs-var">v</span></a></span></span></span></span><span>
</span><span id="line-348"></span><span>
</span><span id="line-349"></span><span class="hs-keyword">class</span><span> </span><span id="ToAvroFields"><span class="annot"><a href="Mu.Adapter.Avro.html#ToAvroFields"><span class="hs-identifier hs-var">ToAvroFields</span></a></span></span><span> </span><span id="local-6989586621679163365"><span class="annot"><a href="#local-6989586621679163365"><span class="hs-identifier hs-type">sch</span></a></span></span><span> </span><span class="hs-special">(</span><span id="local-6989586621679163364"><span class="annot"><a href="#local-6989586621679163364"><span class="hs-identifier hs-type">fs</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">[</span><span class="annot"><span class="hs-identifier hs-type">FieldDef</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Symbol</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Symbol</span></span><span class="hs-special">]</span><span class="hs-special">)</span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-350"></span><span>  </span><span id="toAvroF"><span class="annot"><a href="Mu.Adapter.Avro.html#toAvroF"><span class="hs-identifier hs-type">toAvroF</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">NP</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Field</span></span><span> </span><span class="annot"><a href="#local-6989586621679163365"><span class="hs-identifier hs-type">sch</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><a href="#local-6989586621679163364"><span class="hs-identifier hs-type">fs</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">T.Text</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">A.Encoder</span></span><span class="hs-special">)</span><span class="hs-special">]</span><span>
</span><span id="line-351"></span><span id="local-6989586621679162822"><span class="hs-keyword">instance</span><span> </span><span class="annot"><a href="Mu.Adapter.Avro.html#ToAvroFields"><span class="hs-identifier hs-type">ToAvroFields</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679162822"><span class="hs-identifier hs-type">sch</span></a></span><span> </span><span class="hs-special">'</span><span class="hs-special">[</span><span class="hs-special">]</span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-352"></span><span>  </span><span id="local-6989586621679162819"><span class="annot"><span class="annottext">toAvroF :: NP (Field sch) '[] -&gt; [(Text, Encoder)]
</span><a href="#local-6989586621679162819"><span class="hs-identifier hs-var hs-var hs-var hs-var">toAvroF</span></a></span></span><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span></span><span>
</span><span id="line-353"></span><span id="local-6989586621679162815"><span id="local-6989586621679162816"><span id="local-6989586621679162817"><span id="local-6989586621679162818"><span class="hs-keyword">instance</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">KnownName</span></span><span> </span><span class="annot"><a href="#local-6989586621679162818"><span class="hs-identifier hs-type">name</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">A.ToAvro</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">FieldValue</span></span><span> </span><span class="annot"><a href="#local-6989586621679162817"><span class="hs-identifier hs-type">sch</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679162816"><span class="hs-identifier hs-type">t</span></a></span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Mu.Adapter.Avro.html#ToAvroFields"><span class="hs-identifier hs-type">ToAvroFields</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679162817"><span class="hs-identifier hs-type">sch</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679162815"><span class="hs-identifier hs-type">fs</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-354"></span><span>         </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="Mu.Adapter.Avro.html#ToAvroFields"><span class="hs-identifier hs-type">ToAvroFields</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679162817"><span class="hs-identifier hs-type">sch</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">'</span><span class="annot"><span class="hs-identifier hs-type">FieldDef</span></span><span> </span><span class="annot"><a href="#local-6989586621679162818"><span class="hs-identifier hs-type">name</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679162816"><span class="hs-identifier hs-type">t</span></a></span><span> </span><span class="hs-special">'</span><span class="hs-glyph">:</span><span> </span><span class="annot"><a href="#local-6989586621679162815"><span class="hs-identifier hs-type">fs</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-355"></span><span>  </span><span id="local-6989586621679162813"><span class="annot"><span class="annottext">toAvroF :: NP (Field sch) ('FieldDef name t : fs) -&gt; [(Text, Encoder)]
</span><a href="#local-6989586621679162813"><span class="hs-identifier hs-var hs-var hs-var hs-var">toAvroF</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Field</span></span><span> </span><span id="local-6989586621679162812"><span class="annot"><span class="annottext">v :: FieldValue sch t
</span><a href="#local-6989586621679162812"><span class="hs-identifier hs-var">v</span></a></span></span><span> </span><span class="annot"><span class="hs-operator hs-type">:*</span></span><span> </span><span id="local-6989586621679162811"><span class="annot"><span class="annottext">rest :: NP (Field sch) xs
</span><a href="#local-6989586621679162811"><span class="hs-identifier hs-var">rest</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Text
</span><a href="#local-6989586621679162810"><span class="hs-identifier hs-var">fieldName</span></a></span><span> </span><span class="annot"><span class="annottext">Text -&gt; FieldValue sch t -&gt; (Text, Encoder)
forall a. ToAvro a =&gt; Text -&gt; a -&gt; (Text, Encoder)
</span><span class="hs-operator hs-var">A..=</span></span><span> </span><span class="annot"><span class="annottext">FieldValue sch t
</span><a href="#local-6989586621679162812"><span class="hs-identifier hs-var">v</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">(Text, Encoder) -&gt; [(Text, Encoder)] -&gt; [(Text, Encoder)]
forall a. a -&gt; [a] -&gt; [a]
</span><span class="hs-glyph hs-var">:</span></span><span> </span><span class="annot"><span class="annottext">NP (Field sch) xs -&gt; [(Text, Encoder)]
forall (sch :: Schema Symbol Symbol)
       (fs :: [FieldDef Symbol Symbol]).
ToAvroFields sch fs =&gt;
NP (Field sch) fs -&gt; [(Text, Encoder)]
</span><a href="Mu.Adapter.Avro.html#toAvroF"><span class="hs-identifier hs-var">toAvroF</span></a></span><span> </span><span class="annot"><span class="annottext">NP (Field sch) xs
</span><a href="#local-6989586621679162811"><span class="hs-identifier hs-var">rest</span></a></span><span>
</span><span id="line-356"></span><span>    </span><span class="hs-keyword">where</span><span> </span><span id="local-6989586621679162810"><span class="annot"><span class="annottext">fieldName :: Text
</span><a href="#local-6989586621679162810"><span class="hs-identifier hs-var hs-var">fieldName</span></a></span></span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Proxy name -&gt; Text
forall k (s :: k) (proxy :: k -&gt; *). KnownName s =&gt; proxy s -&gt; Text
</span><a href="Mu.Adapter.Avro.html#nameText"><span class="hs-identifier hs-var">nameText</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Proxy name
forall k (t :: k). Proxy t
</span><span class="hs-identifier hs-var">Proxy</span></span><span> </span><span class="hs-glyph">@</span><span class="annot"><a href="#local-6989586621679162818"><span class="hs-identifier hs-type">name</span></a></span><span class="hs-special">)</span></span></span></span></span><span>
</span><span id="line-357"></span><span>
</span><span id="line-358"></span><span class="hs-comment">-- Conversion of symbols to other things</span><span>
</span><span id="line-359"></span><span id="local-6989586621679163502"><span id="local-6989586621679163503"><span class="annot"><a href="Mu.Adapter.Avro.html#nameText"><span class="hs-identifier hs-type">nameText</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">KnownName</span></span><span> </span><span class="annot"><a href="#local-6989586621679163503"><span class="hs-identifier hs-type">s</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679163502"><span class="hs-identifier hs-type">proxy</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679163503"><span class="hs-identifier hs-type">s</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">T.Text</span></span></span></span><span>
</span><span id="line-360"></span><span id="nameText"><span class="annot"><span class="annottext">nameText :: proxy s -&gt; Text
</span><a href="Mu.Adapter.Avro.html#nameText"><span class="hs-identifier hs-var hs-var">nameText</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[Char] -&gt; Text
</span><span class="hs-identifier hs-var">T.pack</span></span><span> </span><span class="annot"><span class="annottext">([Char] -&gt; Text) -&gt; (proxy s -&gt; [Char]) -&gt; proxy s -&gt; Text
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">proxy s -&gt; [Char]
forall k (a :: k) (proxy :: k -&gt; *).
KnownName a =&gt;
proxy a -&gt; [Char]
</span><span class="hs-identifier hs-var">nameVal</span></span><span>
</span><span id="line-361"></span><span id="local-6989586621679163610"><span id="local-6989586621679163611"><span class="annot"><a href="Mu.Adapter.Avro.html#nameTypeName"><span class="hs-identifier hs-type">nameTypeName</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">KnownName</span></span><span> </span><span class="annot"><a href="#local-6989586621679163611"><span class="hs-identifier hs-type">s</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679163610"><span class="hs-identifier hs-type">proxy</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679163611"><span class="hs-identifier hs-type">s</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">ASch.TypeName</span></span></span></span><span>
</span><span id="line-362"></span><span id="nameTypeName"><span class="annot"><span class="annottext">nameTypeName :: proxy s -&gt; TypeName
</span><a href="Mu.Adapter.Avro.html#nameTypeName"><span class="hs-identifier hs-var hs-var">nameTypeName</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Text -&gt; TypeName
</span><span class="hs-identifier hs-var">ASch.parseFullname</span></span><span> </span><span class="annot"><span class="annottext">(Text -&gt; TypeName) -&gt; (proxy s -&gt; Text) -&gt; proxy s -&gt; TypeName
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">proxy s -&gt; Text
forall k (s :: k) (proxy :: k -&gt; *). KnownName s =&gt; proxy s -&gt; Text
</span><a href="Mu.Adapter.Avro.html#nameText"><span class="hs-identifier hs-var">nameText</span></a></span><span>
</span><span id="line-363"></span></pre></body></html>