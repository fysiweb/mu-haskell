<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd"><html xmlns="http://www.w3.org/1999/xhtml"><head><link rel="stylesheet" type="text/css" href="style.css" /><script type="text/javascript" src="highlight.js"></script></head><body><pre><span class="hs-pragma">{-# language AllowAmbiguousTypes   #-}</span><span>
</span><span id="line-2"></span><span class="hs-pragma">{-# language DataKinds             #-}</span><span>
</span><span id="line-3"></span><span class="hs-pragma">{-# language FlexibleContexts      #-}</span><span>
</span><span id="line-4"></span><span class="hs-pragma">{-# language GADTs                 #-}</span><span>
</span><span id="line-5"></span><span class="hs-pragma">{-# language MultiParamTypeClasses #-}</span><span>
</span><span id="line-6"></span><span class="hs-pragma">{-# language PolyKinds             #-}</span><span>
</span><span id="line-7"></span><span class="hs-pragma">{-# language ScopedTypeVariables   #-}</span><span>
</span><span id="line-8"></span><span class="hs-pragma">{-# language TypeApplications      #-}</span><span>
</span><span id="line-9"></span><span class="hs-pragma">{-# language TypeOperators         #-}</span><span>
</span><span id="line-10"></span><span class="hs-comment">{-|
Description : Client for gRPC services using @TypeApplications@

For further information over initialization of the connection,
consult the &lt;http://hackage.haskell.org/package/http2-client-grpc http2-client-grpc docs&gt;.
-}</span><span>
</span><span id="line-16"></span><span class="hs-keyword">module</span><span> </span><span class="hs-identifier">Mu.GRpc.Client.TyApps</span><span> </span><span class="hs-special">(</span><span>
</span><span id="line-17"></span><span>  </span><span class="annot"><span class="hs-comment">-- * Initialization of the gRPC client</span></span><span>
</span><span id="line-18"></span><span>  </span><span class="annot"><span class="hs-identifier">GrpcClient</span></span><span>
</span><span id="line-19"></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier">GrpcClientConfig</span></span><span>
</span><span id="line-20"></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier">grpcClientConfigSimple</span></span><span>
</span><span id="line-21"></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Mu.GRpc.Client.Internal.html#setupGrpcClient%27"><span class="hs-identifier">setupGrpcClient'</span></a></span><span>
</span><span id="line-22"></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Mu.GRpc.Client.Internal.html#setupGrpcClientZipkin"><span class="hs-identifier">setupGrpcClientZipkin</span></a></span><span>
</span><span id="line-23"></span><span>  </span><span class="annot"><span class="hs-comment">-- * Call methods from the gRPC service</span></span><span>
</span><span id="line-24"></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Mu.GRpc.Client.TyApps.html#gRpcCall"><span class="hs-identifier">gRpcCall</span></a></span><span>
</span><span id="line-25"></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier">GRpcMessageProtocol</span></span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span>
</span><span id="line-26"></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier">CompressMode</span></span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span>
</span><span id="line-27"></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Mu.GRpc.Client.Internal.html#GRpcReply"><span class="hs-identifier">GRpcReply</span></a></span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span>
</span><span id="line-28"></span><span class="hs-special">)</span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-29"></span><span>
</span><span id="line-30"></span><span class="hs-keyword">import</span><span>           </span><span class="annot"><span class="hs-identifier">GHC.TypeLits</span></span><span>
</span><span id="line-31"></span><span class="hs-keyword">import</span><span>           </span><span class="annot"><span class="hs-identifier">Network.GRPC.Client</span></span><span>         </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">CompressMode</span></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-32"></span><span class="hs-keyword">import</span><span>           </span><span class="annot"><span class="hs-identifier">Network.GRPC.Client.Helpers</span></span><span>
</span><span id="line-33"></span><span>
</span><span id="line-34"></span><span class="hs-keyword">import</span><span>           </span><span class="annot"><span class="hs-identifier">Mu.Rpc</span></span><span>
</span><span id="line-35"></span><span class="hs-keyword">import</span><span>           </span><span class="annot"><span class="hs-identifier">Mu.Schema</span></span><span>
</span><span id="line-36"></span><span>
</span><span id="line-37"></span><span class="hs-keyword">import</span><span>           </span><span class="annot"><span class="hs-identifier">Mu.GRpc.Bridge</span></span><span>
</span><span id="line-38"></span><span class="hs-keyword">import</span><span>           </span><span class="annot"><a href="Mu.GRpc.Client.Internal.html"><span class="hs-identifier">Mu.GRpc.Client.Internal</span></a></span><span>
</span><span id="line-39"></span><span>
</span><span id="line-40"></span><span class="hs-comment">-- | Call a method from a Mu definition.</span><span>
</span><span id="line-41"></span><span class="hs-comment">--   This method is thought to be used with @TypeApplications@:</span><span>
</span><span id="line-42"></span><span class="hs-comment">--</span><span>
</span><span id="line-43"></span><span class="hs-comment">--   &gt; gRpcCall @'MsgFormat @&quot;packageName&quot; @ServiceDeclaration @&quot;method&quot;</span><span>
</span><span id="line-44"></span><span class="hs-comment">--</span><span>
</span><span id="line-45"></span><span class="hs-comment">--   The additional arguments you must provide to 'gRpcCall'</span><span>
</span><span id="line-46"></span><span class="hs-comment">--   depend on the signature of the method itself:</span><span>
</span><span id="line-47"></span><span class="hs-comment">--   * The resulting value is always wrapped in 'GRpcReply'.</span><span>
</span><span id="line-48"></span><span class="hs-comment">--   * A single input or output turns into a single value.</span><span>
</span><span id="line-49"></span><span class="hs-comment">--   * A streaming input or output turns into a Conduit.</span><span>
</span><span id="line-50"></span><span class="annot"><a href="Mu.GRpc.Client.TyApps.html#gRpcCall"><span class="hs-identifier hs-type">gRpcCall</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-keyword">forall</span><span> </span><span class="hs-special">(</span><span id="local-6989586621679145331"><span class="annot"><a href="#local-6989586621679145331"><span class="hs-identifier hs-type">pro</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">GRpcMessageProtocol</span></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span id="local-6989586621679145330"><span class="annot"><a href="#local-6989586621679145330"><span class="hs-identifier hs-type">pkg</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Package'</span></span><span class="hs-special">)</span><span>
</span><span id="line-51"></span><span>                   </span><span class="hs-special">(</span><span id="local-6989586621679145328"><span class="annot"><a href="#local-6989586621679145328"><span class="hs-identifier hs-type">srvName</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Symbol</span></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span id="local-6989586621679145327"><span class="annot"><a href="#local-6989586621679145327"><span class="hs-identifier hs-type">methodName</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Symbol</span></span><span class="hs-special">)</span><span> </span><span id="local-6989586621679145326"><span class="annot"><a href="#local-6989586621679145326"><span class="hs-identifier hs-type">h</span></a></span></span><span>
</span><span id="line-52"></span><span>                   </span><span id="local-6989586621679145325"><span class="annot"><a href="#local-6989586621679145325"><span class="hs-identifier hs-type">pkgName</span></a></span></span><span> </span><span id="local-6989586621679145324"><span class="annot"><a href="#local-6989586621679145324"><span class="hs-identifier hs-type">services</span></a></span></span><span> </span><span id="local-6989586621679145323"><span class="annot"><a href="#local-6989586621679145323"><span class="hs-identifier hs-type">methods</span></a></span></span><span class="hs-operator">.</span><span>
</span><span id="line-53"></span><span>            </span><span class="hs-special">(</span><span> </span><span class="annot"><a href="#local-6989586621679145330"><span class="hs-identifier hs-type">pkg</span></a></span><span> </span><span class="annot"><span class="hs-glyph hs-type">~</span></span><span>&#160; </span><span class="hs-special">'</span><span class="annot"><span class="hs-identifier hs-type">Package</span></span><span> </span><span class="hs-special">(</span><span class="hs-special">'</span><span class="annot"><span class="hs-identifier hs-type">Just</span></span><span> </span><span class="annot"><a href="#local-6989586621679145325"><span class="hs-identifier hs-type">pkgName</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><a href="#local-6989586621679145324"><span class="hs-identifier hs-type">services</span></a></span><span>
</span><span id="line-54"></span><span>            </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">LookupService</span></span><span> </span><span class="annot"><a href="#local-6989586621679145324"><span class="hs-identifier hs-type">services</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679145328"><span class="hs-identifier hs-type">srvName</span></a></span><span> </span><span class="annot"><span class="hs-glyph hs-type">~</span></span><span>&#160;</span><span class="hs-special">'</span><span class="annot"><span class="hs-identifier hs-type">Service</span></span><span> </span><span class="annot"><a href="#local-6989586621679145328"><span class="hs-identifier hs-type">srvName</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679145323"><span class="hs-identifier hs-type">methods</span></a></span><span>
</span><span id="line-55"></span><span>            </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Mu.GRpc.Client.Internal.html#GRpcServiceMethodCall"><span class="hs-identifier hs-type">GRpcServiceMethodCall</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679145331"><span class="hs-identifier hs-type">pro</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679145325"><span class="hs-identifier hs-type">pkgName</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679145328"><span class="hs-identifier hs-type">srvName</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">LookupMethod</span></span><span> </span><span class="annot"><a href="#local-6989586621679145323"><span class="hs-identifier hs-type">methods</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679145327"><span class="hs-identifier hs-type">methodName</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><a href="#local-6989586621679145326"><span class="hs-identifier hs-type">h</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-56"></span><span>         </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">GrpcClient</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679145326"><span class="hs-identifier hs-type">h</span></a></span><span>
</span><span id="line-57"></span><span id="gRpcCall"><span class="annot"><span class="annottext">gRpcCall :: GrpcClient -&gt; h
</span><a href="Mu.GRpc.Client.TyApps.html#gRpcCall"><span class="hs-identifier hs-var hs-var">gRpcCall</span></a></span></span><span>
</span><span id="line-58"></span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Proxy pro
-&gt; Proxy pkgName
-&gt; Proxy srvName
-&gt; Proxy (LookupMethod methods methodName)
-&gt; GrpcClient
-&gt; h
forall snm mnm anm (p :: GRpcMessageProtocol) (pkg :: snm)
       (s :: snm) (m :: Method snm mnm anm (TypeRef snm)) h.
GRpcServiceMethodCall p pkg s m h =&gt;
Proxy p -&gt; Proxy pkg -&gt; Proxy s -&gt; Proxy m -&gt; GrpcClient -&gt; h
</span><a href="Mu.GRpc.Client.Internal.html#gRpcServiceMethodCall"><span class="hs-identifier hs-var">gRpcServiceMethodCall</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Proxy pro
forall k (t :: k). Proxy t
</span><span class="hs-identifier hs-var">Proxy</span></span><span> </span><span class="hs-glyph">@</span><span class="annot"><a href="#local-6989586621679145331"><span class="hs-identifier hs-type">pro</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Proxy pkgName
forall k (t :: k). Proxy t
</span><span class="hs-identifier hs-var">Proxy</span></span><span> </span><span class="hs-glyph">@</span><span class="annot"><a href="#local-6989586621679145325"><span class="hs-identifier hs-type">pkgName</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Proxy srvName
forall k (t :: k). Proxy t
</span><span class="hs-identifier hs-var">Proxy</span></span><span> </span><span class="hs-glyph">@</span><span class="annot"><a href="#local-6989586621679145328"><span class="hs-identifier hs-type">srvName</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-59"></span><span>                          </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Proxy (LookupMethod methods methodName)
forall k (t :: k). Proxy t
</span><span class="hs-identifier hs-var">Proxy</span></span><span> </span><span class="hs-glyph">@</span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">LookupMethod</span></span><span> </span><span class="annot"><a href="#local-6989586621679145323"><span class="hs-identifier hs-type">methods</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679145327"><span class="hs-identifier hs-type">methodName</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-60"></span></pre></body></html>