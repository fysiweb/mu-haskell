<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd"><html xmlns="http://www.w3.org/1999/xhtml"><head><link rel="stylesheet" type="text/css" href="style.css" /><script type="text/javascript" src="highlight.js"></script></head><body><pre><span class="hs-pragma">{-# language FlexibleContexts #-}</span><span>
</span><span id="line-2"></span><span class="hs-pragma">{-# language TypeFamilies     #-}</span><span>
</span><span id="line-3"></span><span class="hs-pragma">{-# language TypeOperators    #-}</span><span>
</span><span id="line-4"></span><span class="hs-comment">{-|
Description : Kafka consumers as streams of Mu terms

This module allows you to receive values from
a Kafka topic, and treat then as Mu terms, or
your Haskell types if a conversion exists.

This module is a wrapper over 'Kafka.Conduit.Source'
from the (awesome) package @hw-kafka-client@.
-}</span><span>
</span><span id="line-14"></span><span class="hs-keyword">module</span><span> </span><span class="hs-identifier">Mu.Kafka.Consumer</span><span> </span><span class="hs-special">(</span><span>
</span><span id="line-15"></span><span>  </span><span class="annot"><a href="Mu.Kafka.Consumer.html#kafkaSource"><span class="hs-identifier">kafkaSource</span></a></span><span>
</span><span id="line-16"></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Mu.Kafka.Consumer.html#kafkaSourceNoClose"><span class="hs-identifier">kafkaSourceNoClose</span></a></span><span>
</span><span id="line-17"></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Mu.Kafka.Consumer.html#kafkaSourceAutoClose"><span class="hs-identifier">kafkaSourceAutoClose</span></a></span><span>
</span><span id="line-18"></span><span class="hs-special">,</span><span> </span><span class="hs-keyword">module</span><span> </span><span class="annot"><span class="hs-identifier">X</span></span><span>
</span><span id="line-19"></span><span class="hs-special">)</span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-20"></span><span>
</span><span id="line-21"></span><span class="hs-keyword">import</span><span>           </span><span class="annot"><span class="hs-identifier">Conduit</span></span><span>                      </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">mapC</span></span><span class="hs-special">)</span><span>
</span><span id="line-22"></span><span class="hs-keyword">import</span><span>           </span><span class="annot"><span class="hs-identifier">Control.Monad.IO.Class</span></span><span>
</span><span id="line-23"></span><span class="hs-keyword">import</span><span>           </span><span class="annot"><span class="hs-identifier">Control.Monad.Trans.Resource</span></span><span>
</span><span id="line-24"></span><span class="hs-keyword">import</span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="annot"><span class="hs-identifier">Data.Avro</span></span><span>                    </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">A</span></span><span>
</span><span id="line-25"></span><span class="hs-keyword">import</span><span>           </span><span class="annot"><span class="hs-identifier">Data.ByteString</span></span><span>
</span><span id="line-26"></span><span class="hs-keyword">import</span><span>           </span><span class="annot"><span class="hs-identifier">Data.Conduit</span></span><span>
</span><span id="line-27"></span><span class="hs-keyword">import</span><span>           </span><span class="annot"><span class="hs-identifier">Mu.Schema</span></span><span>
</span><span id="line-28"></span><span>
</span><span id="line-29"></span><span class="hs-keyword">import</span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="annot"><span class="hs-identifier">Kafka.Conduit.Source</span></span><span>         </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">S</span></span><span>
</span><span id="line-30"></span><span>
</span><span id="line-31"></span><span class="hs-keyword">import</span><span>           </span><span class="annot"><span class="hs-identifier">Kafka.Conduit.Combinators</span></span><span>    </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">X</span></span><span>
</span><span id="line-32"></span><span class="hs-keyword">import</span><span>           </span><span class="annot"><span class="hs-identifier">Kafka.Consumer</span></span><span>               </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">X</span></span><span>
</span><span id="line-33"></span><span>
</span><span id="line-34"></span><span class="hs-keyword">import</span><span>           </span><span class="annot"><a href="Mu.Kafka.Internal.html"><span class="hs-identifier">Mu.Kafka.Internal</span></a></span><span>
</span><span id="line-35"></span><span>
</span><span id="line-36"></span><span id="local-6989586621679143497"><span id="local-6989586621679143498"><span id="local-6989586621679143499"><span class="annot"><a href="Mu.Kafka.Consumer.html#fromCR"><span class="hs-identifier hs-type">fromCR</span></a></span><span>
</span><span id="line-37"></span><span>  </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span> </span><span class="annot"><span class="hs-identifier hs-type">FromSchema</span></span><span> </span><span class="annot"><a href="#local-6989586621679143499"><span class="hs-identifier hs-type">sch</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679143498"><span class="hs-identifier hs-type">sty</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679143497"><span class="hs-identifier hs-type">t</span></a></span><span>
</span><span id="line-38"></span><span>     </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">A.FromAvro</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">WithSchema</span></span><span> </span><span class="annot"><a href="#local-6989586621679143499"><span class="hs-identifier hs-type">sch</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679143498"><span class="hs-identifier hs-type">sty</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679143497"><span class="hs-identifier hs-type">t</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-39"></span><span>     </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">A.HasAvroSchema</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">WithSchema</span></span><span> </span><span class="annot"><a href="#local-6989586621679143499"><span class="hs-identifier hs-type">sch</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679143498"><span class="hs-identifier hs-type">sty</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679143497"><span class="hs-identifier hs-type">t</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">)</span><span>
</span><span id="line-40"></span><span>  </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Proxy</span></span><span> </span><span class="annot"><a href="#local-6989586621679143499"><span class="hs-identifier hs-type">sch</span></a></span><span>
</span><span id="line-41"></span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">ConsumerRecord</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Maybe</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">ByteString</span></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Maybe</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">ByteString</span></span><span class="hs-special">)</span><span>
</span><span id="line-42"></span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">ConsumerRecord</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Maybe</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">ByteString</span></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Maybe</span></span><span> </span><span class="annot"><a href="#local-6989586621679143497"><span class="hs-identifier hs-type">t</span></a></span><span class="hs-special">)</span></span></span></span><span>
</span><span id="line-43"></span><span id="fromCR"><span class="annot"><span class="annottext">fromCR :: Proxy sch
-&gt; ConsumerRecord (Maybe ByteString) (Maybe ByteString)
-&gt; ConsumerRecord (Maybe ByteString) (Maybe t)
</span><a href="Mu.Kafka.Consumer.html#fromCR"><span class="hs-identifier hs-var hs-var">fromCR</span></a></span></span><span> </span><span id="local-6989586621679143481"><span class="annot"><span class="annottext">proxy :: Proxy sch
</span><a href="#local-6989586621679143481"><span class="hs-identifier hs-var">proxy</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">ConsumerRecord</span></span><span> </span><span id="local-6989586621679143479"><span class="annot"><span class="annottext">t :: TopicName
</span><a href="#local-6989586621679143479"><span class="hs-identifier hs-var">t</span></a></span></span><span> </span><span id="local-6989586621679143478"><span class="annot"><span class="annottext">p :: PartitionId
</span><a href="#local-6989586621679143478"><span class="hs-identifier hs-var">p</span></a></span></span><span> </span><span id="local-6989586621679143477"><span class="annot"><span class="annottext">o :: Offset
</span><a href="#local-6989586621679143477"><span class="hs-identifier hs-var">o</span></a></span></span><span> </span><span id="local-6989586621679143476"><span class="annot"><span class="annottext">ts :: Timestamp
</span><a href="#local-6989586621679143476"><span class="hs-identifier hs-var">ts</span></a></span></span><span> </span><span id="local-6989586621679143475"><span class="annot"><span class="annottext">k :: Maybe ByteString
</span><a href="#local-6989586621679143475"><span class="hs-identifier hs-var">k</span></a></span></span><span> </span><span id="local-6989586621679143474"><span class="annot"><span class="annottext">v :: Maybe ByteString
</span><a href="#local-6989586621679143474"><span class="hs-identifier hs-var">v</span></a></span></span><span class="hs-special">)</span><span>
</span><span id="line-44"></span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">TopicName
-&gt; PartitionId
-&gt; Offset
-&gt; Timestamp
-&gt; Maybe ByteString
-&gt; Maybe t
-&gt; ConsumerRecord (Maybe ByteString) (Maybe t)
forall k v.
TopicName
-&gt; PartitionId
-&gt; Offset
-&gt; Timestamp
-&gt; k
-&gt; v
-&gt; ConsumerRecord k v
</span><span class="hs-identifier hs-var">ConsumerRecord</span></span><span> </span><span class="annot"><span class="annottext">TopicName
</span><a href="#local-6989586621679143479"><span class="hs-identifier hs-var">t</span></a></span><span> </span><span class="annot"><span class="annottext">PartitionId
</span><a href="#local-6989586621679143478"><span class="hs-identifier hs-var">p</span></a></span><span> </span><span class="annot"><span class="annottext">Offset
</span><a href="#local-6989586621679143477"><span class="hs-identifier hs-var">o</span></a></span><span> </span><span class="annot"><span class="annottext">Timestamp
</span><a href="#local-6989586621679143476"><span class="hs-identifier hs-var">ts</span></a></span><span> </span><span class="annot"><span class="annottext">Maybe ByteString
</span><a href="#local-6989586621679143475"><span class="hs-identifier hs-var">k</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Maybe ByteString
</span><a href="#local-6989586621679143474"><span class="hs-identifier hs-var">v</span></a></span><span> </span><span class="annot"><span class="annottext">Maybe ByteString -&gt; (ByteString -&gt; Maybe t) -&gt; Maybe t
forall (m :: * -&gt; *) a b. Monad m =&gt; m a -&gt; (a -&gt; m b) -&gt; m b
</span><span class="hs-operator hs-var">&gt;&gt;=</span></span><span> </span><span class="annot"><span class="annottext">Proxy sch -&gt; ByteString -&gt; Maybe t
forall (sch :: Schema * *) sty t.
(FromSchema sch sty t, FromAvro (WithSchema sch sty t),
 HasAvroSchema (WithSchema sch sty t)) =&gt;
Proxy sch -&gt; ByteString -&gt; Maybe t
</span><a href="Mu.Kafka.Internal.html#fromBS"><span class="hs-identifier hs-var">fromBS</span></a></span><span> </span><span class="annot"><span class="annottext">Proxy sch
</span><a href="#local-6989586621679143481"><span class="hs-identifier hs-var">proxy</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-45"></span><span>
</span><span id="line-46"></span><span class="hs-comment">-- | Creates a kafka producer for given properties and returns a `Source`.</span><span>
</span><span id="line-47"></span><span class="hs-comment">--</span><span>
</span><span id="line-48"></span><span class="hs-comment">-- This method of creating a `Source` represents a simple case</span><span>
</span><span id="line-49"></span><span class="hs-comment">-- and does not provide access to `KafkaProducer`. For more complex scenarious</span><span>
</span><span id="line-50"></span><span class="hs-comment">-- 'kafkaSinkNoClose' or 'kafkaSinkAutoClose' can be used.</span><span>
</span><span id="line-51"></span><span id="local-6989586621679143469"><span id="local-6989586621679143470"><span id="local-6989586621679143471"><span id="local-6989586621679143472"><span class="annot"><a href="Mu.Kafka.Consumer.html#kafkaSource"><span class="hs-identifier hs-type">kafkaSource</span></a></span><span>
</span><span id="line-52"></span><span>  </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span> </span><span class="annot"><span class="hs-identifier hs-type">MonadResource</span></span><span> </span><span class="annot"><a href="#local-6989586621679143472"><span class="hs-identifier hs-type">m</span></a></span><span>
</span><span id="line-53"></span><span>     </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">FromSchema</span></span><span> </span><span class="annot"><a href="#local-6989586621679143471"><span class="hs-identifier hs-type">sch</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679143470"><span class="hs-identifier hs-type">sty</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679143469"><span class="hs-identifier hs-type">t</span></a></span><span>
</span><span id="line-54"></span><span>     </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">A.FromAvro</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">WithSchema</span></span><span> </span><span class="annot"><a href="#local-6989586621679143471"><span class="hs-identifier hs-type">sch</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679143470"><span class="hs-identifier hs-type">sty</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679143469"><span class="hs-identifier hs-type">t</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-55"></span><span>     </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">A.HasAvroSchema</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">WithSchema</span></span><span> </span><span class="annot"><a href="#local-6989586621679143471"><span class="hs-identifier hs-type">sch</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679143470"><span class="hs-identifier hs-type">sty</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679143469"><span class="hs-identifier hs-type">t</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">)</span><span>
</span><span id="line-56"></span><span>  </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Proxy</span></span><span> </span><span class="annot"><a href="#local-6989586621679143471"><span class="hs-identifier hs-type">sch</span></a></span><span>
</span><span id="line-57"></span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">ConsumerProperties</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Subscription</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Timeout</span></span><span>
</span><span id="line-58"></span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">ConduitT</span></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Either</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">KafkaError</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">ConsumerRecord</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Maybe</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">ByteString</span></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Maybe</span></span><span> </span><span class="annot"><a href="#local-6989586621679143469"><span class="hs-identifier hs-type">t</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="annot"><a href="#local-6989586621679143472"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span></span></span></span></span><span>
</span><span id="line-59"></span><span id="kafkaSource"><span class="annot"><span class="annottext">kafkaSource :: Proxy sch
-&gt; ConsumerProperties
-&gt; Subscription
-&gt; Timeout
-&gt; ConduitT
     ()
     (Either KafkaError (ConsumerRecord (Maybe ByteString) (Maybe t)))
     m
     ()
</span><a href="Mu.Kafka.Consumer.html#kafkaSource"><span class="hs-identifier hs-var hs-var">kafkaSource</span></a></span></span><span> </span><span id="local-6989586621679143468"><span class="annot"><span class="annottext">proxy :: Proxy sch
</span><a href="#local-6989586621679143468"><span class="hs-identifier hs-var">proxy</span></a></span></span><span> </span><span id="local-6989586621679143467"><span class="annot"><span class="annottext">props :: ConsumerProperties
</span><a href="#local-6989586621679143467"><span class="hs-identifier hs-var">props</span></a></span></span><span> </span><span id="local-6989586621679143466"><span class="annot"><span class="annottext">sub :: Subscription
</span><a href="#local-6989586621679143466"><span class="hs-identifier hs-var">sub</span></a></span></span><span> </span><span id="local-6989586621679143465"><span class="annot"><span class="annottext">ts :: Timeout
</span><a href="#local-6989586621679143465"><span class="hs-identifier hs-var">ts</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-60"></span><span>  </span><span class="annot"><span class="annottext">ConsumerProperties
-&gt; Subscription
-&gt; Timeout
-&gt; ConduitT
     ()
     (Either
        KafkaError (ConsumerRecord (Maybe ByteString) (Maybe ByteString)))
     m
     ()
forall (m :: * -&gt; *).
MonadResource m =&gt;
ConsumerProperties
-&gt; Subscription
-&gt; Timeout
-&gt; ConduitT
     ()
     (Either
        KafkaError (ConsumerRecord (Maybe ByteString) (Maybe ByteString)))
     m
     ()
</span><span class="hs-identifier hs-var">S.kafkaSource</span></span><span> </span><span class="annot"><span class="annottext">ConsumerProperties
</span><a href="#local-6989586621679143467"><span class="hs-identifier hs-var">props</span></a></span><span> </span><span class="annot"><span class="annottext">Subscription
</span><a href="#local-6989586621679143466"><span class="hs-identifier hs-var">sub</span></a></span><span> </span><span class="annot"><span class="annottext">Timeout
</span><a href="#local-6989586621679143465"><span class="hs-identifier hs-var">ts</span></a></span><span> </span><span class="annot"><span class="annottext">ConduitT
  ()
  (Either
     KafkaError (ConsumerRecord (Maybe ByteString) (Maybe ByteString)))
  m
  ()
-&gt; ConduitM
     (Either
        KafkaError (ConsumerRecord (Maybe ByteString) (Maybe ByteString)))
     (Either KafkaError (ConsumerRecord (Maybe ByteString) (Maybe t)))
     m
     ()
-&gt; ConduitT
     ()
     (Either KafkaError (ConsumerRecord (Maybe ByteString) (Maybe t)))
     m
     ()
forall (m :: * -&gt; *) a b c r.
Monad m =&gt;
ConduitM a b m () -&gt; ConduitM b c m r -&gt; ConduitM a c m r
</span><span class="hs-operator hs-var">.|</span></span><span>&#160;</span><span class="annot"><span class="annottext">(Either
   KafkaError (ConsumerRecord (Maybe ByteString) (Maybe ByteString))
 -&gt; Either KafkaError (ConsumerRecord (Maybe ByteString) (Maybe t)))
-&gt; ConduitM
     (Either
        KafkaError (ConsumerRecord (Maybe ByteString) (Maybe ByteString)))
     (Either KafkaError (ConsumerRecord (Maybe ByteString) (Maybe t)))
     m
     ()
forall (m :: * -&gt; *) a b. Monad m =&gt; (a -&gt; b) -&gt; ConduitT a b m ()
</span><span class="hs-identifier hs-var">mapC</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(ConsumerRecord (Maybe ByteString) (Maybe ByteString)
 -&gt; ConsumerRecord (Maybe ByteString) (Maybe t))
-&gt; Either
     KafkaError (ConsumerRecord (Maybe ByteString) (Maybe ByteString))
-&gt; Either KafkaError (ConsumerRecord (Maybe ByteString) (Maybe t))
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-identifier hs-var">fmap</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Proxy sch
-&gt; ConsumerRecord (Maybe ByteString) (Maybe ByteString)
-&gt; ConsumerRecord (Maybe ByteString) (Maybe t)
forall (sch :: Schema * *) sty t.
(FromSchema sch sty t, FromAvro (WithSchema sch sty t),
 HasAvroSchema (WithSchema sch sty t)) =&gt;
Proxy sch
-&gt; ConsumerRecord (Maybe ByteString) (Maybe ByteString)
-&gt; ConsumerRecord (Maybe ByteString) (Maybe t)
</span><a href="Mu.Kafka.Consumer.html#fromCR"><span class="hs-identifier hs-var">fromCR</span></a></span><span> </span><span class="annot"><span class="annottext">Proxy sch
</span><a href="#local-6989586621679143468"><span class="hs-identifier hs-var">proxy</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-61"></span><span>
</span><span id="line-62"></span><span class="hs-comment">-- | Create a `Source` for a given `KafkaConsumer`.</span><span>
</span><span id="line-63"></span><span class="hs-comment">-- The consumer will NOT be closed automatically when the `Source` is closed.</span><span>
</span><span id="line-64"></span><span id="local-6989586621679143459"><span id="local-6989586621679143460"><span id="local-6989586621679143461"><span id="local-6989586621679143462"><span class="annot"><a href="Mu.Kafka.Consumer.html#kafkaSourceNoClose"><span class="hs-identifier hs-type">kafkaSourceNoClose</span></a></span><span>
</span><span id="line-65"></span><span>  </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span> </span><span class="annot"><span class="hs-identifier hs-type">MonadIO</span></span><span> </span><span class="annot"><a href="#local-6989586621679143462"><span class="hs-identifier hs-type">m</span></a></span><span>
</span><span id="line-66"></span><span>     </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">FromSchema</span></span><span> </span><span class="annot"><a href="#local-6989586621679143461"><span class="hs-identifier hs-type">sch</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679143460"><span class="hs-identifier hs-type">sty</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679143459"><span class="hs-identifier hs-type">t</span></a></span><span>
</span><span id="line-67"></span><span>     </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">A.FromAvro</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">WithSchema</span></span><span> </span><span class="annot"><a href="#local-6989586621679143461"><span class="hs-identifier hs-type">sch</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679143460"><span class="hs-identifier hs-type">sty</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679143459"><span class="hs-identifier hs-type">t</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-68"></span><span>     </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">A.HasAvroSchema</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">WithSchema</span></span><span> </span><span class="annot"><a href="#local-6989586621679143461"><span class="hs-identifier hs-type">sch</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679143460"><span class="hs-identifier hs-type">sty</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679143459"><span class="hs-identifier hs-type">t</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">)</span><span>
</span><span id="line-69"></span><span>  </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Proxy</span></span><span> </span><span class="annot"><a href="#local-6989586621679143461"><span class="hs-identifier hs-type">sch</span></a></span><span>
</span><span id="line-70"></span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">KafkaConsumer</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Timeout</span></span><span>
</span><span id="line-71"></span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">ConduitT</span></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Either</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">KafkaError</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">ConsumerRecord</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Maybe</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">ByteString</span></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Maybe</span></span><span> </span><span class="annot"><a href="#local-6989586621679143459"><span class="hs-identifier hs-type">t</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="annot"><a href="#local-6989586621679143462"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span></span></span></span></span><span>
</span><span id="line-72"></span><span id="kafkaSourceNoClose"><span class="annot"><span class="annottext">kafkaSourceNoClose :: Proxy sch
-&gt; KafkaConsumer
-&gt; Timeout
-&gt; ConduitT
     ()
     (Either KafkaError (ConsumerRecord (Maybe ByteString) (Maybe t)))
     m
     ()
</span><a href="Mu.Kafka.Consumer.html#kafkaSourceNoClose"><span class="hs-identifier hs-var hs-var">kafkaSourceNoClose</span></a></span></span><span> </span><span id="local-6989586621679143458"><span class="annot"><span class="annottext">proxy :: Proxy sch
</span><a href="#local-6989586621679143458"><span class="hs-identifier hs-var">proxy</span></a></span></span><span> </span><span id="local-6989586621679143457"><span class="annot"><span class="annottext">c :: KafkaConsumer
</span><a href="#local-6989586621679143457"><span class="hs-identifier hs-var">c</span></a></span></span><span> </span><span id="local-6989586621679143456"><span class="annot"><span class="annottext">t :: Timeout
</span><a href="#local-6989586621679143456"><span class="hs-identifier hs-var">t</span></a></span></span><span>
</span><span id="line-73"></span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">KafkaConsumer
-&gt; Timeout
-&gt; ConduitT
     ()
     (Either
        KafkaError (ConsumerRecord (Maybe ByteString) (Maybe ByteString)))
     m
     ()
forall (m :: * -&gt; *).
MonadIO m =&gt;
KafkaConsumer
-&gt; Timeout
-&gt; ConduitT
     ()
     (Either
        KafkaError (ConsumerRecord (Maybe ByteString) (Maybe ByteString)))
     m
     ()
</span><span class="hs-identifier hs-var">S.kafkaSourceNoClose</span></span><span> </span><span class="annot"><span class="annottext">KafkaConsumer
</span><a href="#local-6989586621679143457"><span class="hs-identifier hs-var">c</span></a></span><span> </span><span class="annot"><span class="annottext">Timeout
</span><a href="#local-6989586621679143456"><span class="hs-identifier hs-var">t</span></a></span><span> </span><span class="annot"><span class="annottext">ConduitT
  ()
  (Either
     KafkaError (ConsumerRecord (Maybe ByteString) (Maybe ByteString)))
  m
  ()
-&gt; ConduitM
     (Either
        KafkaError (ConsumerRecord (Maybe ByteString) (Maybe ByteString)))
     (Either KafkaError (ConsumerRecord (Maybe ByteString) (Maybe t)))
     m
     ()
-&gt; ConduitT
     ()
     (Either KafkaError (ConsumerRecord (Maybe ByteString) (Maybe t)))
     m
     ()
forall (m :: * -&gt; *) a b c r.
Monad m =&gt;
ConduitM a b m () -&gt; ConduitM b c m r -&gt; ConduitM a c m r
</span><span class="hs-operator hs-var">.|</span></span><span> </span><span class="annot"><span class="annottext">(Either
   KafkaError (ConsumerRecord (Maybe ByteString) (Maybe ByteString))
 -&gt; Either KafkaError (ConsumerRecord (Maybe ByteString) (Maybe t)))
-&gt; ConduitM
     (Either
        KafkaError (ConsumerRecord (Maybe ByteString) (Maybe ByteString)))
     (Either KafkaError (ConsumerRecord (Maybe ByteString) (Maybe t)))
     m
     ()
forall (m :: * -&gt; *) a b. Monad m =&gt; (a -&gt; b) -&gt; ConduitT a b m ()
</span><span class="hs-identifier hs-var">mapC</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(ConsumerRecord (Maybe ByteString) (Maybe ByteString)
 -&gt; ConsumerRecord (Maybe ByteString) (Maybe t))
-&gt; Either
     KafkaError (ConsumerRecord (Maybe ByteString) (Maybe ByteString))
-&gt; Either KafkaError (ConsumerRecord (Maybe ByteString) (Maybe t))
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-identifier hs-var">fmap</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Proxy sch
-&gt; ConsumerRecord (Maybe ByteString) (Maybe ByteString)
-&gt; ConsumerRecord (Maybe ByteString) (Maybe t)
forall (sch :: Schema * *) sty t.
(FromSchema sch sty t, FromAvro (WithSchema sch sty t),
 HasAvroSchema (WithSchema sch sty t)) =&gt;
Proxy sch
-&gt; ConsumerRecord (Maybe ByteString) (Maybe ByteString)
-&gt; ConsumerRecord (Maybe ByteString) (Maybe t)
</span><a href="Mu.Kafka.Consumer.html#fromCR"><span class="hs-identifier hs-var">fromCR</span></a></span><span> </span><span class="annot"><span class="annottext">Proxy sch
</span><a href="#local-6989586621679143458"><span class="hs-identifier hs-var">proxy</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-74"></span><span>
</span><span id="line-75"></span><span>
</span><span id="line-76"></span><span class="hs-comment">-- | Create a `Source` for a given `KafkaConsumer`.</span><span>
</span><span id="line-77"></span><span class="hs-comment">-- The consumer will be closed automatically when the `Source` is closed.</span><span>
</span><span id="line-78"></span><span id="local-6989586621679143451"><span id="local-6989586621679143452"><span id="local-6989586621679143453"><span id="local-6989586621679143454"><span class="annot"><a href="Mu.Kafka.Consumer.html#kafkaSourceAutoClose"><span class="hs-identifier hs-type">kafkaSourceAutoClose</span></a></span><span>
</span><span id="line-79"></span><span>  </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span> </span><span class="annot"><span class="hs-identifier hs-type">MonadResource</span></span><span> </span><span class="annot"><a href="#local-6989586621679143454"><span class="hs-identifier hs-type">m</span></a></span><span>
</span><span id="line-80"></span><span>     </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">FromSchema</span></span><span> </span><span class="annot"><a href="#local-6989586621679143453"><span class="hs-identifier hs-type">sch</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679143452"><span class="hs-identifier hs-type">sty</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679143451"><span class="hs-identifier hs-type">t</span></a></span><span>
</span><span id="line-81"></span><span>     </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">A.FromAvro</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">WithSchema</span></span><span> </span><span class="annot"><a href="#local-6989586621679143453"><span class="hs-identifier hs-type">sch</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679143452"><span class="hs-identifier hs-type">sty</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679143451"><span class="hs-identifier hs-type">t</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-82"></span><span>     </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">A.HasAvroSchema</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">WithSchema</span></span><span> </span><span class="annot"><a href="#local-6989586621679143453"><span class="hs-identifier hs-type">sch</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679143452"><span class="hs-identifier hs-type">sty</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679143451"><span class="hs-identifier hs-type">t</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">)</span><span>
</span><span id="line-83"></span><span>  </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Proxy</span></span><span> </span><span class="annot"><a href="#local-6989586621679143453"><span class="hs-identifier hs-type">sch</span></a></span><span>
</span><span id="line-84"></span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">KafkaConsumer</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Timeout</span></span><span>
</span><span id="line-85"></span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">ConduitT</span></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Either</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">KafkaError</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">ConsumerRecord</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Maybe</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">ByteString</span></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Maybe</span></span><span> </span><span class="annot"><a href="#local-6989586621679143451"><span class="hs-identifier hs-type">t</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="annot"><a href="#local-6989586621679143454"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span></span></span></span></span><span>
</span><span id="line-86"></span><span id="kafkaSourceAutoClose"><span class="annot"><span class="annottext">kafkaSourceAutoClose :: Proxy sch
-&gt; KafkaConsumer
-&gt; Timeout
-&gt; ConduitT
     ()
     (Either KafkaError (ConsumerRecord (Maybe ByteString) (Maybe t)))
     m
     ()
</span><a href="Mu.Kafka.Consumer.html#kafkaSourceAutoClose"><span class="hs-identifier hs-var hs-var">kafkaSourceAutoClose</span></a></span></span><span> </span><span id="local-6989586621679143450"><span class="annot"><span class="annottext">proxy :: Proxy sch
</span><a href="#local-6989586621679143450"><span class="hs-identifier hs-var">proxy</span></a></span></span><span> </span><span id="local-6989586621679143449"><span class="annot"><span class="annottext">c :: KafkaConsumer
</span><a href="#local-6989586621679143449"><span class="hs-identifier hs-var">c</span></a></span></span><span> </span><span id="local-6989586621679143448"><span class="annot"><span class="annottext">t :: Timeout
</span><a href="#local-6989586621679143448"><span class="hs-identifier hs-var">t</span></a></span></span><span>
</span><span id="line-87"></span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">KafkaConsumer
-&gt; Timeout
-&gt; ConduitT
     ()
     (Either
        KafkaError (ConsumerRecord (Maybe ByteString) (Maybe ByteString)))
     m
     ()
forall (m :: * -&gt; *).
MonadResource m =&gt;
KafkaConsumer
-&gt; Timeout
-&gt; ConduitT
     ()
     (Either
        KafkaError (ConsumerRecord (Maybe ByteString) (Maybe ByteString)))
     m
     ()
</span><span class="hs-identifier hs-var">S.kafkaSourceAutoClose</span></span><span> </span><span class="annot"><span class="annottext">KafkaConsumer
</span><a href="#local-6989586621679143449"><span class="hs-identifier hs-var">c</span></a></span><span> </span><span class="annot"><span class="annottext">Timeout
</span><a href="#local-6989586621679143448"><span class="hs-identifier hs-var">t</span></a></span><span> </span><span class="annot"><span class="annottext">ConduitT
  ()
  (Either
     KafkaError (ConsumerRecord (Maybe ByteString) (Maybe ByteString)))
  m
  ()
-&gt; ConduitM
     (Either
        KafkaError (ConsumerRecord (Maybe ByteString) (Maybe ByteString)))
     (Either KafkaError (ConsumerRecord (Maybe ByteString) (Maybe t)))
     m
     ()
-&gt; ConduitT
     ()
     (Either KafkaError (ConsumerRecord (Maybe ByteString) (Maybe t)))
     m
     ()
forall (m :: * -&gt; *) a b c r.
Monad m =&gt;
ConduitM a b m () -&gt; ConduitM b c m r -&gt; ConduitM a c m r
</span><span class="hs-operator hs-var">.|</span></span><span> </span><span class="annot"><span class="annottext">(Either
   KafkaError (ConsumerRecord (Maybe ByteString) (Maybe ByteString))
 -&gt; Either KafkaError (ConsumerRecord (Maybe ByteString) (Maybe t)))
-&gt; ConduitM
     (Either
        KafkaError (ConsumerRecord (Maybe ByteString) (Maybe ByteString)))
     (Either KafkaError (ConsumerRecord (Maybe ByteString) (Maybe t)))
     m
     ()
forall (m :: * -&gt; *) a b. Monad m =&gt; (a -&gt; b) -&gt; ConduitT a b m ()
</span><span class="hs-identifier hs-var">mapC</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(ConsumerRecord (Maybe ByteString) (Maybe ByteString)
 -&gt; ConsumerRecord (Maybe ByteString) (Maybe t))
-&gt; Either
     KafkaError (ConsumerRecord (Maybe ByteString) (Maybe ByteString))
-&gt; Either KafkaError (ConsumerRecord (Maybe ByteString) (Maybe t))
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-identifier hs-var">fmap</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Proxy sch
-&gt; ConsumerRecord (Maybe ByteString) (Maybe ByteString)
-&gt; ConsumerRecord (Maybe ByteString) (Maybe t)
forall (sch :: Schema * *) sty t.
(FromSchema sch sty t, FromAvro (WithSchema sch sty t),
 HasAvroSchema (WithSchema sch sty t)) =&gt;
Proxy sch
-&gt; ConsumerRecord (Maybe ByteString) (Maybe ByteString)
-&gt; ConsumerRecord (Maybe ByteString) (Maybe t)
</span><a href="Mu.Kafka.Consumer.html#fromCR"><span class="hs-identifier hs-var">fromCR</span></a></span><span> </span><span class="annot"><span class="annottext">Proxy sch
</span><a href="#local-6989586621679143450"><span class="hs-identifier hs-var">proxy</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-88"></span></pre></body></html>